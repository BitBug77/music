INFO 2025-04-11 19:48:23,830 autoreload 22572 24572 Watching for file changes with StatReloader
INFO 2025-04-11 19:48:34,321 autoreload 22572 24572 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 19:48:35,432 autoreload 27964 27932 Watching for file changes with StatReloader
INFO 2025-04-11 19:50:06,471 autoreload 27964 27932 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-11 19:50:07,617 autoreload 13640 19676 Watching for file changes with StatReloader
INFO 2025-04-11 19:50:40,828 autoreload 13640 19676 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-11 19:50:41,861 autoreload 28400 12688 Watching for file changes with StatReloader
INFO 2025-04-11 19:51:08,550 autoreload 28400 12688 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-11 19:51:09,733 autoreload 23992 5176 Watching for file changes with StatReloader
INFO 2025-04-11 20:02:28,483 autoreload 23992 5176 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-11 20:02:30,155 autoreload 1696 27880 Watching for file changes with StatReloader
INFO 2025-04-11 20:02:54,965 autoreload 1696 27880 C:\projects\music\server\songs\app\models.py changed, reloading.
INFO 2025-04-11 20:02:56,125 autoreload 14408 1260 Watching for file changes with StatReloader
INFO 2025-04-11 20:03:47,269 autoreload 14408 1260 C:\projects\music\server\songs\app\algorithms.py changed, reloading.
INFO 2025-04-11 20:03:48,240 autoreload 27224 6308 Watching for file changes with StatReloader
INFO 2025-04-11 20:41:13,910 autoreload 23572 12908 Watching for file changes with StatReloader
ERROR 2025-04-11 20:42:17,261 exception 23572 384 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:42:17,348 log 23572 384 Bad Request: /login/
WARNING 2025-04-11 20:42:17,349 basehttp 23572 384 "OPTIONS /login/ HTTP/1.1" 400 143
ERROR 2025-04-11 20:42:48,937 exception 23572 17812 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:42:48,941 log 23572 17812 Bad Request: /signup/
WARNING 2025-04-11 20:42:48,942 basehttp 23572 17812 "OPTIONS /signup/ HTTP/1.1" 400 143
ERROR 2025-04-11 20:43:04,371 exception 23572 12724 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:43:04,372 log 23572 12724 Bad Request: /signup/
WARNING 2025-04-11 20:43:04,374 basehttp 23572 12724 "OPTIONS /signup/ HTTP/1.1" 400 143
INFO 2025-04-11 20:54:00,349 autoreload 16248 4376 Watching for file changes with StatReloader
ERROR 2025-04-11 20:54:22,678 exception 16248 25284 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:54:22,686 log 16248 25284 Bad Request: /signup/
WARNING 2025-04-11 20:54:22,687 basehttp 16248 25284 "OPTIONS /signup/ HTTP/1.1" 400 143
ERROR 2025-04-11 20:54:52,819 exception 16248 10500 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:54:52,822 log 16248 10500 Bad Request: /signup/
WARNING 2025-04-11 20:54:52,823 basehttp 16248 10500 "OPTIONS /signup/ HTTP/1.1" 400 143
ERROR 2025-04-11 20:56:35,299 exception 16248 22720 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:56:35,310 log 16248 22720 Bad Request: /signup/
WARNING 2025-04-11 20:56:35,310 basehttp 16248 22720 "POST /signup/ HTTP/1.1" 400 143
INFO 2025-04-11 20:57:19,943 autoreload 16248 4376 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-11 20:57:21,903 autoreload 15024 9176 Watching for file changes with StatReloader
ERROR 2025-04-11 20:58:31,969 exception 15024 27488 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 20:58:31,974 log 15024 27488 Bad Request: /signup/
WARNING 2025-04-11 20:58:31,975 basehttp 15024 27488 "POST /signup/ HTTP/1.1" 400 143
INFO 2025-04-11 21:01:49,447 autoreload 15024 9176 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:01:50,724 autoreload 27360 4664 Watching for file changes with StatReloader
ERROR 2025-04-11 21:02:04,501 exception 27360 22100 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 21:02:04,504 log 27360 22100 Bad Request: /signup/
WARNING 2025-04-11 21:02:04,504 basehttp 27360 22100 "POST /signup/ HTTP/1.1" 400 143
ERROR 2025-04-11 21:03:54,787 exception 27360 14308 Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\middleware\security.py", line 28, in process_request
    host = self.redirect_host or request.get_host()
                                 ~~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
WARNING 2025-04-11 21:03:54,789 log 27360 14308 Bad Request: /signup/
WARNING 2025-04-11 21:03:54,790 basehttp 27360 14308 "POST /signup/ HTTP/1.1" 400 143
INFO 2025-04-11 21:05:50,201 autoreload 27360 4664 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:05:51,223 autoreload 7820 2420 Watching for file changes with StatReloader
INFO 2025-04-11 21:06:03,042 autoreload 724 6252 Watching for file changes with StatReloader
INFO 2025-04-11 21:06:09,712 basehttp 724 12012 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:06:09,727 basehttp 724 21900 code 400, message Bad HTTP/0.9 request type ('\x16\x03\x01\x00å\x01\x00\x00á\x03\x03Nºè\x80\x15:\xad;ê\x9f\x83~ö¾à<Î(\x92Ðk.%IôÌñ^\x84\x84')
ERROR 2025-04-11 21:06:09,728 basehttp 724 21900 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:06:11,878 basehttp 724 14748 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:06:11,881 basehttp 724 464 code 400, message Bad request version ('À\x13À')
ERROR 2025-04-11 21:06:11,881 basehttp 724 464 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:06:23,589 basehttp 724 23232 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:06:23,593 basehttp 724 18796 code 400, message Bad request version ('À\x13À')
ERROR 2025-04-11 21:06:23,593 basehttp 724 18796 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:09:09,787 basehttp 724 21252 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:09:09,789 basehttp 724 15872 code 400, message Bad request version ('À\x13À')
ERROR 2025-04-11 21:09:09,790 basehttp 724 15872 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:12:46,986 basehttp 724 13920 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:12:46,989 basehttp 724 28272 code 400, message Bad request version ('À\x13À')
ERROR 2025-04-11 21:12:46,989 basehttp 724 28272 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:13:52,247 basehttp 724 20864 "POST /signup/ HTTP/1.1" 301 0
INFO 2025-04-11 21:13:52,251 basehttp 724 11720 code 400, message Bad request version ('À\x13À')
ERROR 2025-04-11 21:13:52,251 basehttp 724 11720 You're accessing the development server over HTTPS, but it only supports HTTP.
INFO 2025-04-11 21:18:13,698 autoreload 724 6252 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:18:15,103 autoreload 18732 25604 Watching for file changes with StatReloader
INFO 2025-04-11 21:18:39,784 autoreload 11408 1616 Watching for file changes with StatReloader
INFO 2025-04-11 21:19:44,006 autoreload 11408 1616 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:19:45,073 autoreload 9672 28052 Watching for file changes with StatReloader
WARNING 2025-04-11 21:20:22,650 log 9672 18948 Unauthorized: /signup/
WARNING 2025-04-11 21:20:22,652 basehttp 9672 18948 "POST /signup/ HTTP/1.1" 401 58
INFO 2025-04-11 21:22:49,198 autoreload 9672 28052 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-11 21:22:50,558 autoreload 24632 12680 Watching for file changes with StatReloader
INFO 2025-04-11 21:22:59,472 basehttp 24632 6972 "POST /signup/ HTTP/1.1" 201 550
WARNING 2025-04-11 21:23:28,210 log 24632 6972 Unauthorized: /login/
WARNING 2025-04-11 21:23:28,210 basehttp 24632 6972 "POST /login/ HTTP/1.1" 401 58
WARNING 2025-04-11 21:23:45,709 log 24632 6972 Unauthorized: /login/
WARNING 2025-04-11 21:23:45,710 basehttp 24632 6972 "POST /login/ HTTP/1.1" 401 58
INFO 2025-04-11 21:24:12,429 basehttp 24632 6972 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-11 21:25:04,054 basehttp 24632 27124 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:25:42,287 basehttp 24632 17532 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:34:48,346 autoreload 10664 27044 Watching for file changes with StatReloader
INFO 2025-04-11 21:35:28,480 basehttp 10664 25188 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:38:11,000 autoreload 10664 27044 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-11 21:38:12,211 autoreload 212 21584 Watching for file changes with StatReloader
INFO 2025-04-11 21:38:34,923 basehttp 212 23064 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:41:48,880 autoreload 212 21584 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-11 21:41:50,330 autoreload 1908 10040 Watching for file changes with StatReloader
INFO 2025-04-11 21:42:03,042 autoreload 17204 28228 Watching for file changes with StatReloader
INFO 2025-04-11 21:42:54,350 basehttp 17204 27600 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:45:44,869 autoreload 17204 28228 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:45:46,495 autoreload 25924 19288 Watching for file changes with StatReloader
INFO 2025-04-11 21:47:11,879 basehttp 25924 3684 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-11 21:52:02,563 autoreload 25924 19288 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-11 21:52:04,108 autoreload 20920 19784 Watching for file changes with StatReloader
INFO 2025-04-11 21:52:50,626 basehttp 20920 15956 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-13 13:52:42,709 autoreload 1364 5248 Watching for file changes with StatReloader
INFO 2025-04-13 13:53:50,539 basehttp 1364 17712 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:51,865 basehttp 1364 11068 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 13:53:52,396 basehttp 1364 17712 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,404 basehttp 1364 9912 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,405 basehttp 1364 14296 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,405 basehttp 1364 5560 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,405 basehttp 1364 15476 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,406 basehttp 1364 17712 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,406 basehttp 1364 11912 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,408 basehttp 1364 9912 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,422 basehttp 1364 11912 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 13:53:52,422 basehttp 1364 5560 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,422 basehttp 1364 14296 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,427 basehttp 1364 11912 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 13:53:52,432 basehttp 1364 11912 "OPTIONS /accounts/login/?next=/playlists/ HTTP/1.1" 200 0
INFO 2025-04-13 13:53:52,432 basehttp 1364 5560 "OPTIONS /accounts/login/?next=/playlists/ HTTP/1.1" 200 0
WARNING 2025-04-13 13:53:52,436 log 1364 5560 Not Found: /accounts/login/
WARNING 2025-04-13 13:53:52,436 basehttp 1364 5560 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 13:53:52,437 log 1364 5560 Not Found: /accounts/login/
WARNING 2025-04-13 13:53:52,438 basehttp 1364 5560 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 13:53:53,106 spotify_utils 1364 17712 Attempting to get Spotify token
INFO 2025-04-13 13:53:53,228 basehttp 1364 15476 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:53:53,307 basehttp 1364 9912 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 13:53:53,383 spotify_utils 1364 17712 Auth response status: 400
ERROR 2025-04-13 13:53:53,384 spotify_utils 1364 17712 Auth error response: 400
ERROR 2025-04-13 13:53:53,386 log 1364 17712 Internal Server Error: /popularity/
ERROR 2025-04-13 13:53:53,387 basehttp 1364 17712 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:53:53,955 basehttp 1364 15476 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:53:54,028 spotify_utils 1364 17712 Attempting to get Spotify token
INFO 2025-04-13 13:53:54,267 basehttp 1364 9912 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 13:53:54,450 spotify_utils 1364 17712 Auth response status: 400
ERROR 2025-04-13 13:53:54,451 spotify_utils 1364 17712 Auth error response: 400
ERROR 2025-04-13 13:53:54,451 log 1364 17712 Internal Server Error: /popularity/
ERROR 2025-04-13 13:53:54,451 basehttp 1364 17712 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:53:55,089 spotify_utils 1364 17712 Attempting to get Spotify token
INFO 2025-04-13 13:53:55,321 spotify_utils 1364 17712 Auth response status: 400
ERROR 2025-04-13 13:53:55,322 spotify_utils 1364 17712 Auth error response: 400
ERROR 2025-04-13 13:53:55,325 log 1364 17712 Internal Server Error: /popularity/
ERROR 2025-04-13 13:53:55,327 basehttp 1364 17712 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:53:56,100 spotify_utils 1364 17712 Attempting to get Spotify token
INFO 2025-04-13 13:53:56,364 spotify_utils 1364 17712 Auth response status: 400
ERROR 2025-04-13 13:53:56,364 spotify_utils 1364 17712 Auth error response: 400
ERROR 2025-04-13 13:53:56,364 log 1364 17712 Internal Server Error: /popularity/
ERROR 2025-04-13 13:53:56,365 basehttp 1364 17712 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:54:53,610 basehttp 1364 9312 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:55:53,079 basehttp 1364 13700 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:56:22,293 spotify_utils 1364 13648 Attempting to get Spotify token
INFO 2025-04-13 13:56:22,614 spotify_utils 1364 13648 Auth response status: 400
ERROR 2025-04-13 13:56:22,614 spotify_utils 1364 13648 Auth error response: 400
ERROR 2025-04-13 13:56:22,616 log 1364 13648 Internal Server Error: /popularity/
ERROR 2025-04-13 13:56:22,617 basehttp 1364 13648 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:56:53,719 basehttp 1364 17672 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:57:39,417 autoreload 1364 5248 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-13 13:57:41,536 autoreload 19580 11572 Watching for file changes with StatReloader
INFO 2025-04-13 13:58:28,043 autoreload 19580 11572 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-13 13:58:29,233 autoreload 9092 9672 Watching for file changes with StatReloader
INFO 2025-04-13 13:58:36,454 spotify_utils 9092 1072 Attempting to get Spotify token
INFO 2025-04-13 13:58:36,702 spotify_utils 9092 1072 Auth response status: 400
ERROR 2025-04-13 13:58:36,702 spotify_utils 9092 1072 Auth error response: 400
ERROR 2025-04-13 13:58:36,703 log 9092 1072 Internal Server Error: /popularity/
ERROR 2025-04-13 13:58:36,704 basehttp 9092 1072 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 13:59:15,156 basehttp 9092 17548 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 13:59:53,632 basehttp 9092 17548 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:01:12,289 autoreload 9092 9672 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-13 14:01:13,690 autoreload 6152 19204 Watching for file changes with StatReloader
ERROR 2025-04-13 14:01:22,920 log 6152 18612 Internal Server Error: /popularity/
ERROR 2025-04-13 14:01:22,921 basehttp 6152 18612 "GET /popularity/ HTTP/1.1" 500 61
ERROR 2025-04-13 14:01:25,544 log 6152 18612 Internal Server Error: /popularity/
ERROR 2025-04-13 14:01:25,545 basehttp 6152 18612 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 14:01:49,669 basehttp 6152 1580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:02:45,112 autoreload 15416 9352 Watching for file changes with StatReloader
INFO 2025-04-13 14:02:49,679 basehttp 15416 2608 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 14:02:57,969 log 15416 20196 Internal Server Error: /popularity/
ERROR 2025-04-13 14:02:57,970 basehttp 15416 20196 "GET /popularity/ HTTP/1.1" 500 61
ERROR 2025-04-13 14:03:01,155 log 15416 20196 Internal Server Error: /popularity/
ERROR 2025-04-13 14:03:01,156 basehttp 15416 20196 "GET /popularity/ HTTP/1.1" 500 61
ERROR 2025-04-13 14:03:29,155 log 15416 20196 Internal Server Error: /popularity/
ERROR 2025-04-13 14:03:29,156 basehttp 15416 20196 "GET /popularity/ HTTP/1.1" 500 61
INFO 2025-04-13 14:03:36,667 autoreload 13816 20436 Watching for file changes with StatReloader
INFO 2025-04-13 14:03:45,961 basehttp 13816 16196 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:03:50,239 basehttp 13816 13536 "GET /popularity/ HTTP/1.1" 200 6763
INFO 2025-04-13 14:03:53,659 basehttp 13816 16196 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:03:57,671 basehttp 13816 18916 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:03:57,694 log 13816 18916 Not Found: /accounts/login/
WARNING 2025-04-13 14:03:57,695 basehttp 13816 18916 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:03:58,341 basehttp 13816 16196 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:03:58,458 basehttp 13816 6120 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:03:59,108 basehttp 13816 11668 "GET /popularity/ HTTP/1.1" 200 9904
INFO 2025-04-13 14:04:00,582 basehttp 13816 11668 "GET /popularity/ HTTP/1.1" 200 6539
INFO 2025-04-13 14:04:26,301 basehttp 13816 10648 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,305 basehttp 13816 7580 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,305 basehttp 13816 10648 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,309 basehttp 13816 9504 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,310 basehttp 13816 10648 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,310 basehttp 13816 7580 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,310 basehttp 13816 964 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,315 basehttp 13816 7952 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,316 basehttp 13816 10648 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,316 basehttp 13816 964 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,316 basehttp 13816 7580 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,316 basehttp 13816 9504 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:04:26,319 log 13816 10648 Not Found: /accounts/login/
INFO 2025-04-13 14:04:26,326 basehttp 13816 964 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,326 basehttp 13816 7580 "GET /history/most-played/ HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,326 basehttp 13816 9504 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
WARNING 2025-04-13 14:04:26,327 basehttp 13816 10648 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:04:26,331 basehttp 13816 964 "OPTIONS /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 200 0
INFO 2025-04-13 14:04:26,331 basehttp 13816 9504 "GET /history/most-played/ HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,331 basehttp 13816 10648 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
INFO 2025-04-13 14:04:26,332 basehttp 13816 7580 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
WARNING 2025-04-13 14:04:26,334 log 13816 964 Not Found: /accounts/login/
INFO 2025-04-13 14:04:26,335 basehttp 13816 9504 "OPTIONS /accounts/login/?next=/history/most-played/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:04:26,338 log 13816 10648 Not Found: /accounts/login/
INFO 2025-04-13 14:04:26,341 basehttp 13816 7580 "OPTIONS /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 200 0
WARNING 2025-04-13 14:04:26,342 basehttp 13816 964 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:04:26,342 basehttp 13816 9504 "OPTIONS /accounts/login/?next=/history/most-played/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:04:26,342 basehttp 13816 10648 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:26,344 log 13816 9504 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:26,345 log 13816 964 Not Found: /accounts/login/
INFO 2025-04-13 14:04:26,345 basehttp 13816 7580 "OPTIONS /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 200 0
WARNING 2025-04-13 14:04:26,346 basehttp 13816 9504 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:26,346 basehttp 13816 964 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:26,347 log 13816 7580 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:26,349 log 13816 9504 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:26,350 log 13816 964 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:26,351 basehttp 13816 7580 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:26,355 basehttp 13816 9504 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:26,355 basehttp 13816 964 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
INFO 2025-04-13 14:04:27,040 basehttp 13816 11668 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 14:04:27,303 views 13816 7952 Error in MatrixFactorizationRecommendationView: `k` must be an integer satisfying `0 < k < min(A.shape)`.
Traceback (most recent call last):
  File "C:\projects\music\server\songs\app\views.py", line 3232, in get
    songs = calculate_svd_recommendations(user, limit)
  File "C:\projects\music\server\songs\app\algorithms.py", line 529, in calculate_svd_recommendations
    u, sigma, vt = svds(matrix, k=k)
                   ~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\_lib\_util.py", line 440, in wrapper
    return fun(*args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 433, in svds
    args = _iv(A, k, ncv, tol, which, v0, maxiter, return_singular_vectors,
               solver, rng)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 44, in _iv
    raise ValueError(message)
ValueError: `k` must be an integer satisfying `0 < k < min(A.shape)`.
ERROR 2025-04-13 14:04:27,327 log 13816 7952 Internal Server Error: /api/recommendations/matrix/
ERROR 2025-04-13 14:04:27,328 basehttp 13816 7952 "GET /api/recommendations/matrix/ HTTP/1.1" 500 59
INFO 2025-04-13 14:04:27,744 basehttp 13816 11668 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 14:04:28,254 views 13816 7952 Error in MatrixFactorizationRecommendationView: `k` must be an integer satisfying `0 < k < min(A.shape)`.
Traceback (most recent call last):
  File "C:\projects\music\server\songs\app\views.py", line 3232, in get
    songs = calculate_svd_recommendations(user, limit)
  File "C:\projects\music\server\songs\app\algorithms.py", line 529, in calculate_svd_recommendations
    u, sigma, vt = svds(matrix, k=k)
                   ~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\_lib\_util.py", line 440, in wrapper
    return fun(*args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 433, in svds
    args = _iv(A, k, ncv, tol, which, v0, maxiter, return_singular_vectors,
               solver, rng)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 44, in _iv
    raise ValueError(message)
ValueError: `k` must be an integer satisfying `0 < k < min(A.shape)`.
ERROR 2025-04-13 14:04:28,258 log 13816 7952 Internal Server Error: /api/recommendations/matrix/
ERROR 2025-04-13 14:04:28,259 basehttp 13816 7952 "GET /api/recommendations/matrix/ HTTP/1.1" 500 59
ERROR 2025-04-13 14:04:29,274 views 13816 7952 Error in MatrixFactorizationRecommendationView: `k` must be an integer satisfying `0 < k < min(A.shape)`.
Traceback (most recent call last):
  File "C:\projects\music\server\songs\app\views.py", line 3232, in get
    songs = calculate_svd_recommendations(user, limit)
  File "C:\projects\music\server\songs\app\algorithms.py", line 529, in calculate_svd_recommendations
    u, sigma, vt = svds(matrix, k=k)
                   ~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\_lib\_util.py", line 440, in wrapper
    return fun(*args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 433, in svds
    args = _iv(A, k, ncv, tol, which, v0, maxiter, return_singular_vectors,
               solver, rng)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 44, in _iv
    raise ValueError(message)
ValueError: `k` must be an integer satisfying `0 < k < min(A.shape)`.
ERROR 2025-04-13 14:04:29,279 log 13816 7952 Internal Server Error: /api/recommendations/matrix/
ERROR 2025-04-13 14:04:29,280 basehttp 13816 7952 "GET /api/recommendations/matrix/ HTTP/1.1" 500 59
ERROR 2025-04-13 14:04:30,220 views 13816 7952 Error in MatrixFactorizationRecommendationView: `k` must be an integer satisfying `0 < k < min(A.shape)`.
Traceback (most recent call last):
  File "C:\projects\music\server\songs\app\views.py", line 3232, in get
    songs = calculate_svd_recommendations(user, limit)
  File "C:\projects\music\server\songs\app\algorithms.py", line 529, in calculate_svd_recommendations
    u, sigma, vt = svds(matrix, k=k)
                   ~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\_lib\_util.py", line 440, in wrapper
    return fun(*args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 433, in svds
    args = _iv(A, k, ncv, tol, which, v0, maxiter, return_singular_vectors,
               solver, rng)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 44, in _iv
    raise ValueError(message)
ValueError: `k` must be an integer satisfying `0 < k < min(A.shape)`.
ERROR 2025-04-13 14:04:30,223 log 13816 7952 Internal Server Error: /api/recommendations/matrix/
ERROR 2025-04-13 14:04:30,224 basehttp 13816 7952 "GET /api/recommendations/matrix/ HTTP/1.1" 500 59
INFO 2025-04-13 14:04:35,575 basehttp 13816 964 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:04:35,581 log 13816 7580 Not Found: /accounts/login/
INFO 2025-04-13 14:04:35,582 basehttp 13816 964 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:04:35,582 basehttp 13816 7580 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:35,584 log 13816 7580 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:35,585 basehttp 13816 7580 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:04:36,243 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:04:36,336 basehttp 13816 9504 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:04:36,787 basehttp 13816 11668 "GET /popularity/ HTTP/1.1" 200 13718
INFO 2025-04-13 14:04:36,936 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:04:37,123 basehttp 13816 9504 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:04:38,184 basehttp 13816 7580 "GET /popularity/ HTTP/1.1" 200 9321
INFO 2025-04-13 14:04:39,672 basehttp 13816 9504 "GET /popularity/ HTTP/1.1" 200 14009
INFO 2025-04-13 14:04:41,141 basehttp 13816 9504 "GET /popularity/ HTTP/1.1" 200 6841
INFO 2025-04-13 14:04:55,405 basehttp 13816 9504 "OPTIONS /liked-songs/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:55,405 basehttp 13816 7580 "OPTIONS /liked-songs/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:55,410 basehttp 13816 9504 "GET /liked-songs/ HTTP/1.1" 302 0
INFO 2025-04-13 14:04:55,415 basehttp 13816 7580 "OPTIONS /accounts/login/?next=/liked-songs/ HTTP/1.1" 200 0
INFO 2025-04-13 14:04:55,416 basehttp 13816 9504 "GET /liked-songs/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:04:55,419 log 13816 7580 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:55,419 basehttp 13816 7580 "GET /accounts/login/?next=/liked-songs/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:04:55,422 log 13816 7580 Not Found: /accounts/login/
WARNING 2025-04-13 14:04:55,422 basehttp 13816 7580 "GET /accounts/login/?next=/liked-songs/ HTTP/1.1" 404 179
INFO 2025-04-13 14:04:56,077 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:04:56,751 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:05:03,434 basehttp 13816 7580 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:05:03,442 log 13816 9504 Not Found: /accounts/login/
INFO 2025-04-13 14:05:03,443 basehttp 13816 7580 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:05:03,444 basehttp 13816 9504 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:05:03,451 log 13816 9504 Not Found: /accounts/login/
WARNING 2025-04-13 14:05:03,453 basehttp 13816 9504 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:05:04,134 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:05:04,860 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:05:06,079 basehttp 13816 9504 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:05:06,083 log 13816 9504 Not Found: /accounts/login/
WARNING 2025-04-13 14:05:06,087 basehttp 13816 9504 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:05:06,767 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:06:07,658 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 14:06:27,286 views 13816 20428 Error in MatrixFactorizationRecommendationView: `k` must be an integer satisfying `0 < k < min(A.shape)`.
Traceback (most recent call last):
  File "C:\projects\music\server\songs\app\views.py", line 3232, in get
    songs = calculate_svd_recommendations(user, limit)
  File "C:\projects\music\server\songs\app\algorithms.py", line 529, in calculate_svd_recommendations
    u, sigma, vt = svds(matrix, k=k)
                   ~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\_lib\_util.py", line 440, in wrapper
    return fun(*args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 433, in svds
    args = _iv(A, k, ncv, tol, which, v0, maxiter, return_singular_vectors,
               solver, rng)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\scipy\sparse\linalg\_eigen\_svds.py", line 44, in _iv
    raise ValueError(message)
ValueError: `k` must be an integer satisfying `0 < k < min(A.shape)`.
ERROR 2025-04-13 14:06:27,288 log 13816 20428 Internal Server Error: /api/recommendations/matrix/
ERROR 2025-04-13 14:06:27,288 basehttp 13816 20428 "GET /api/recommendations/matrix/ HTTP/1.1" 500 59
INFO 2025-04-13 14:07:07,669 basehttp 13816 7952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:08:07,647 basehttp 13816 11912 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 14:09:06,968 log 13816 19728 Unauthorized: /notifications/
WARNING 2025-04-13 14:09:06,969 basehttp 13816 19728 "GET /notifications/ HTTP/1.1" 401 172
INFO 2025-04-13 14:10:07,816 autoreload 13816 20436 C:\projects\music\server\songs\app\algorithms.py changed, reloading.
INFO 2025-04-13 14:10:09,471 autoreload 18376 11808 Watching for file changes with StatReloader
WARNING 2025-04-13 14:10:15,687 log 18376 18756 Unauthorized: /api/recommendations/matrix/
WARNING 2025-04-13 14:10:15,688 basehttp 18376 18756 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:10:40,018 log 18376 18756 Unauthorized: /login/
WARNING 2025-04-13 14:10:40,019 basehttp 18376 18756 "POST /login/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:10:48,977 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:10:48,979 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:11:33,825 log 18376 18756 Unauthorized: /login/
WARNING 2025-04-13 14:11:33,826 basehttp 18376 18756 "POST /login/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:11:48,973 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:11:48,973 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:12:15,457 log 18376 18756 Unauthorized: /login/
WARNING 2025-04-13 14:12:15,457 basehttp 18376 18756 "POST /login/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:12:48,971 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:12:48,972 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:13:48,967 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:13:48,967 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:13:51,300 log 18376 19728 Unauthorized: /login/
WARNING 2025-04-13 14:13:51,301 basehttp 18376 19728 "POST /login/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:14:48,958 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:14:48,959 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:15:41,263 log 18376 12156 Unauthorized: /signup/
WARNING 2025-04-13 14:15:41,263 basehttp 18376 12156 "POST /signup/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:15:45,616 log 18376 12156 Unauthorized: /signup/
WARNING 2025-04-13 14:15:45,617 basehttp 18376 12156 "POST /signup/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:15:48,973 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:15:48,974 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:16:48,954 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:16:48,954 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
INFO 2025-04-13 14:17:12,687 basehttp 18376 18760 "POST /signup/ HTTP/1.1" 201 550
WARNING 2025-04-13 14:17:20,583 log 18376 18760 Bad Request: /signup/
WARNING 2025-04-13 14:17:20,584 basehttp 18376 18760 "POST /signup/ HTTP/1.1" 400 56
INFO 2025-04-13 14:17:39,075 basehttp 18376 18760 "POST /login/ HTTP/1.1" 200 538
WARNING 2025-04-13 14:17:48,966 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:17:48,967 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
INFO 2025-04-13 14:17:55,034 basehttp 18376 18760 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
WARNING 2025-04-13 14:18:06,646 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:18:06,647 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:08,809 log 18376 2112 Unauthorized: /notifications/
WARNING 2025-04-13 14:18:08,813 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:08,823 log 18376 2112 Unauthorized: /notifications/
INFO 2025-04-13 14:18:08,828 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,832 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 401 172
INFO 2025-04-13 14:18:08,837 basehttp 18376 18972 "GET /history/most-played/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,843 log 18376 10716 Unauthorized: /api/recommendations/matrix/
INFO 2025-04-13 14:18:08,843 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,844 log 18376 2112 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:08,850 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:18:08,851 basehttp 18376 18972 "GET /history/most-played/ HTTP/1.1" 302 0
INFO 2025-04-13 14:18:08,852 basehttp 18376 8116 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,852 basehttp 18376 10716 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:08,852 basehttp 18376 2112 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,855 basehttp 18376 16880 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
INFO 2025-04-13 14:18:08,855 basehttp 18376 9372 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,857 log 18376 18972 Unauthorized: /api/recommendations/matrix/
WARNING 2025-04-13 14:18:08,862 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:08,862 log 18376 2112 Not Found: /accounts/login/
INFO 2025-04-13 14:18:08,862 basehttp 18376 8116 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,864 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:18:08,869 basehttp 18376 9372 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:08,870 basehttp 18376 18972 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:08,871 basehttp 18376 10716 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,875 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:08,876 basehttp 18376 2112 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,877 log 18376 9372 Unauthorized: /api/recommendations/matrix/
WARNING 2025-04-13 14:18:08,878 basehttp 18376 16880 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,879 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:08,880 basehttp 18376 8116 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,881 basehttp 18376 9372 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:08,884 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:08,884 basehttp 18376 10716 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,889 log 18376 9372 Unauthorized: /api/recommendations/matrix/
WARNING 2025-04-13 14:18:08,890 basehttp 18376 8116 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:08,890 basehttp 18376 9372 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:12,846 log 18376 9372 Unauthorized: /notifications/
WARNING 2025-04-13 14:18:12,847 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:12,859 log 18376 9372 Unauthorized: /api/recommendations/matrix/
INFO 2025-04-13 14:18:12,868 basehttp 18376 8116 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:18:12,869 basehttp 18376 10716 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
INFO 2025-04-13 14:18:12,869 basehttp 18376 2112 "GET /history/most-played/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:12,869 basehttp 18376 9372 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
INFO 2025-04-13 14:18:12,869 basehttp 18376 16880 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:12,875 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:12,877 log 18376 2112 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:12,880 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:12,886 log 18376 9372 Unauthorized: /api/recommendations/matrix/
WARNING 2025-04-13 14:18:12,888 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:12,889 basehttp 18376 8116 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:12,890 basehttp 18376 2112 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:12,894 basehttp 18376 10716 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:12,903 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:12,907 basehttp 18376 9372 "GET /api/recommendations/matrix/ HTTP/1.1" 401 172
INFO 2025-04-13 14:18:21,552 basehttp 18376 9372 "OPTIONS /logout/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:18:21,558 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:21,559 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:23,941 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:23,942 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:25,271 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:25,272 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:26,330 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:26,332 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:26,861 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:26,862 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:27,235 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:27,236 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:27,417 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:27,418 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:27,638 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:27,639 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:28,624 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:28,625 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:28,814 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:28,815 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:29,014 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:29,015 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:33,545 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:33,545 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:34,214 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:34,215 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:34,400 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:34,401 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:34,597 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:34,599 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:34,819 log 18376 9372 Unauthorized: /logout/
WARNING 2025-04-13 14:18:34,821 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 401 172
WARNING 2025-04-13 14:18:46,455 log 18376 8132 Unauthorized: /login/
WARNING 2025-04-13 14:18:46,455 basehttp 18376 8132 "POST /login/ HTTP/1.1" 401 53
WARNING 2025-04-13 14:18:50,596 log 18376 8132 Unauthorized: /login/
WARNING 2025-04-13 14:18:50,596 basehttp 18376 8132 "POST /login/ HTTP/1.1" 401 53
INFO 2025-04-13 14:18:59,533 basehttp 18376 8132 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:18:59,691 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:18:59,694 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:18:59,697 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:59,698 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:18:59,700 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:18:59,702 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:01,407 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:01,485 basehttp 18376 10716 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:02,092 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:02,190 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 6638
INFO 2025-04-13 14:19:02,246 basehttp 18376 10716 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:03,821 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 13801
INFO 2025-04-13 14:19:05,787 basehttp 18376 9372 "POST /logout/ HTTP/1.1" 200 59
INFO 2025-04-13 14:19:06,026 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 6832
INFO 2025-04-13 14:19:07,520 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 13979
INFO 2025-04-13 14:19:09,012 basehttp 18376 8132 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:19:09,116 basehttp 18376 9372 "OPTIONS /profile/ HTTP/1.1" 200 0
INFO 2025-04-13 14:19:09,132 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:09,133 basehttp 18376 9372 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:09,137 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:09,137 basehttp 18376 18972 "OPTIONS /accounts/login/?next=/profile/ HTTP/1.1" 200 0
INFO 2025-04-13 14:19:09,137 basehttp 18376 16880 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:09,139 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:09,140 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:09,141 basehttp 18376 9372 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:09,141 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:09,144 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:09,147 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:09,147 basehttp 18376 9372 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:09,147 basehttp 18376 18972 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:10,222 basehttp 18376 10716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:10,316 basehttp 18376 8116 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:10,940 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 14185
INFO 2025-04-13 14:19:11,007 basehttp 18376 10716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:11,211 basehttp 18376 8116 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:12,477 basehttp 18376 18972 "GET /popularity/ HTTP/1.1" 200 13759
INFO 2025-04-13 14:19:12,626 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,635 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,641 basehttp 18376 16880 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,643 basehttp 18376 18972 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,645 basehttp 18376 9372 "GET /history/most-played/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:12,646 log 18376 18972 Not Found: /accounts/login/
INFO 2025-04-13 14:19:12,648 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,648 basehttp 18376 16880 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:12,648 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,651 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:19:12,651 basehttp 18376 9372 "GET /history/recent/?limit=4 HTTP/1.1" 302 0
INFO 2025-04-13 14:19:12,652 basehttp 18376 18972 "GET /recommendations/friends/?limit=16 HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:12,654 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,655 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,657 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,660 basehttp 18376 9372 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,662 log 18376 9372 Not Found: /accounts/login/
INFO 2025-04-13 14:19:12,662 basehttp 18376 16880 "GET /history/most-played/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:12,662 basehttp 18376 18972 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,662 basehttp 18376 9372 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,663 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,665 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,666 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,666 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,667 basehttp 18376 18972 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,667 basehttp 18376 9372 "GET /accounts/login/?next=/history/recent/%3Flimit%3D4 HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,669 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,670 basehttp 18376 16880 "GET /accounts/login/?next=/recommendations/friends/%3Flimit%3D16 HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:12,671 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:12,672 basehttp 18376 18972 "GET /accounts/login/?next=/history/most-played/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:14,876 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:15,105 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 6920
INFO 2025-04-13 14:19:15,493 basehttp 18376 10716 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
INFO 2025-04-13 14:19:15,968 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:16,674 basehttp 18376 8116 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 14:19:16,787 basehttp 18376 18972 "GET /popularity/ HTTP/1.1" 200 10243
INFO 2025-04-13 14:19:17,966 basehttp 18376 2112 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
INFO 2025-04-13 14:19:19,055 basehttp 18376 18972 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5931
INFO 2025-04-13 14:19:28,567 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:28,570 log 18376 9372 Not Found: /accounts/login/
INFO 2025-04-13 14:19:28,570 basehttp 18376 10716 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:28,571 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:28,571 basehttp 18376 9372 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:28,575 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:28,576 log 18376 10716 Not Found: /accounts/login/
INFO 2025-04-13 14:19:28,576 basehttp 18376 18972 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:28,577 basehttp 18376 10716 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:28,577 basehttp 18376 9372 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:28,584 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:28,584 basehttp 18376 9372 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:29,279 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:29,362 basehttp 18376 16880 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:29,747 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 6713
INFO 2025-04-13 14:19:29,811 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:29,818 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:29,819 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:30,078 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:30,324 basehttp 18376 16880 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:30,824 basehttp 18376 2112 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:31,351 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 7097
INFO 2025-04-13 14:19:32,861 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 13753
INFO 2025-04-13 14:19:33,509 basehttp 18376 2112 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:33,514 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:33,517 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:33,517 basehttp 18376 2112 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:33,521 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:33,523 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:34,221 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 13915
INFO 2025-04-13 14:19:34,291 basehttp 18376 16880 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:35,370 basehttp 18376 16880 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:38,002 basehttp 18376 16880 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:38,015 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:38,018 log 18376 18972 Not Found: /accounts/login/
INFO 2025-04-13 14:19:38,019 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:38,019 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:38,023 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:38,025 log 18376 18972 Not Found: /accounts/login/
INFO 2025-04-13 14:19:38,026 basehttp 18376 16880 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:38,026 basehttp 18376 10716 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:38,027 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:38,030 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:38,030 basehttp 18376 18972 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:38,826 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:38,889 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:39,260 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:39,266 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:39,267 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:39,512 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 6851
INFO 2025-04-13 14:19:39,595 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:39,707 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:40,770 basehttp 18376 18972 "GET /popularity/ HTTP/1.1" 200 7070
INFO 2025-04-13 14:19:41,632 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:41,637 log 18376 8116 Not Found: /accounts/login/
INFO 2025-04-13 14:19:41,640 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:41,640 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:41,643 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:41,644 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:42,636 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:43,017 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 6856
INFO 2025-04-13 14:19:43,374 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:44,393 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 13611
INFO 2025-04-13 14:19:47,202 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:47,215 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:19:47,217 basehttp 18376 2112 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:47,217 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:47,217 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:47,220 log 18376 10716 Not Found: /accounts/login/
INFO 2025-04-13 14:19:47,221 basehttp 18376 2112 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:47,224 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:47,226 basehttp 18376 10716 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:47,231 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:47,231 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:47,231 basehttp 18376 10716 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:47,941 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:48,030 basehttp 18376 18972 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:48,407 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 8199
INFO 2025-04-13 14:19:48,430 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:48,435 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:48,436 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:48,696 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:48,836 basehttp 18376 18972 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:19:49,793 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 13863
INFO 2025-04-13 14:19:52,099 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 6541
INFO 2025-04-13 14:19:53,341 basehttp 18376 18972 "GET /popularity/ HTTP/1.1" 200 7052
INFO 2025-04-13 14:19:54,823 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:54,827 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:54,828 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:54,829 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:54,833 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:54,834 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:54,845 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:19:54,849 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:19:54,854 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:54,855 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:19:54,857 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:19:54,858 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:19:55,524 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:19:56,239 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:20:00,997 basehttp 18376 18972 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:01,006 log 18376 2112 Not Found: /accounts/login/
INFO 2025-04-13 14:20:01,009 basehttp 18376 8116 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:01,010 basehttp 18376 2112 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:01,014 basehttp 18376 16880 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:01,016 log 18376 2112 Not Found: /accounts/login/
INFO 2025-04-13 14:20:01,016 basehttp 18376 8116 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:01,017 basehttp 18376 2112 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:20:01,021 log 18376 2112 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:01,023 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:01,024 basehttp 18376 2112 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:20:01,024 basehttp 18376 8116 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:01,720 basehttp 18376 10716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:20:01,797 basehttp 18376 18972 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:20:02,421 basehttp 18376 10716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:20:02,447 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 13774
INFO 2025-04-13 14:20:02,560 basehttp 18376 18972 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:20:03,607 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 6846
INFO 2025-04-13 14:20:05,497 basehttp 18376 18972 "GET /popularity/ HTTP/1.1" 200 13708
INFO 2025-04-13 14:20:07,120 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 13884
INFO 2025-04-13 14:20:14,513 basehttp 18376 10716 "POST /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:14,534 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:14,534 basehttp 18376 10716 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:29,604 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:29,608 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:29,608 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:30,170 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:30,174 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:30,175 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:31,057 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:31,060 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:31,061 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:31,468 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:20:31,470 log 18376 10716 Not Found: /accounts/login/
WARNING 2025-04-13 14:20:31,471 basehttp 18376 10716 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:20:33,750 basehttp 18376 10716 "POST /logout/ HTTP/1.1" 200 59
INFO 2025-04-13 14:22:45,345 basehttp 18376 8132 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:22:45,432 basehttp 18376 10716 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:22:45,442 basehttp 18376 18972 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:22:45,450 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:22:45,453 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:22:45,454 basehttp 18376 18972 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:22:45,454 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:22:45,455 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:22:45,459 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:22:45,460 basehttp 18376 8116 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:22:45,460 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:22:45,463 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:22:45,463 basehttp 18376 8116 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:22:46,135 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:22:46,189 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:22:46,892 basehttp 18376 10716 "GET /popularity/ HTTP/1.1" 200 6841
INFO 2025-04-13 14:22:46,990 basehttp 18376 9372 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:22:47,148 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:22:48,443 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 13762
INFO 2025-04-13 14:22:50,272 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 6881
INFO 2025-04-13 14:22:51,522 basehttp 18376 2112 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:22:51,525 log 18376 2112 Not Found: /accounts/login/
WARNING 2025-04-13 14:22:51,526 basehttp 18376 2112 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:22:51,575 basehttp 18376 8116 "GET /popularity/ HTTP/1.1" 200 13745
INFO 2025-04-13 14:22:53,739 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:22:53,756 log 18376 8116 Not Found: /accounts/login/
WARNING 2025-04-13 14:22:53,757 basehttp 18376 8116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:22:56,970 basehttp 18376 8116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:22:59,110 basehttp 18376 8116 "OPTIONS /search-songs/?q=h HTTP/1.1" 200 0
INFO 2025-04-13 14:22:59,508 basehttp 18376 2112 "OPTIONS /search-songs/?q=he HTTP/1.1" 200 0
INFO 2025-04-13 14:23:00,110 basehttp 18376 8116 "GET /search-songs/?q=h HTTP/1.1" 200 2007
INFO 2025-04-13 14:23:00,529 basehttp 18376 2112 "GET /search-songs/?q=he HTTP/1.1" 200 1725
INFO 2025-04-13 14:23:04,063 basehttp 18376 2112 "OPTIONS /log-interaction/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:04,069 log 18376 2112 Not Found: /log-interaction/
WARNING 2025-04-13 14:23:04,070 basehttp 18376 2112 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:05,567 log 18376 16880 Not Found: /songs/3USxtqRwSYz57Ewm6wWRMp/comments
INFO 2025-04-13 14:23:05,569 basehttp 18376 2112 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:05,569 basehttp 18376 9372 "OPTIONS /api/recommendations/similar/?spotify_id=3USxtqRwSYz57Ewm6wWRMp HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:05,574 basehttp 18376 16880 "GET /songs/3USxtqRwSYz57Ewm6wWRMp/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:23:05,574 basehttp 18376 10716 "GET /song/3USxtqRwSYz57Ewm6wWRMp HTTP/1.1" 301 0
INFO 2025-04-13 14:23:05,575 basehttp 18376 18972 "OPTIONS /api/recommendations/similar/?spotify_id=3USxtqRwSYz57Ewm6wWRMp HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:05,579 log 18376 16880 Not Found: /songs/3USxtqRwSYz57Ewm6wWRMp/comments
INFO 2025-04-13 14:23:05,583 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:05,584 log 18376 18972 Not Found: /accounts/login/
INFO 2025-04-13 14:23:05,585 basehttp 18376 2112 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:05,589 basehttp 18376 16880 "GET /songs/3USxtqRwSYz57Ewm6wWRMp/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:05,590 log 18376 2112 Not Found: /accounts/login/
INFO 2025-04-13 14:23:05,590 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:05,591 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:05,591 basehttp 18376 2112 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:05,593 log 18376 18972 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:05,594 log 18376 2112 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:05,595 basehttp 18376 2112 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:05,595 basehttp 18376 18972 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:05,847 basehttp 18376 3624 "GET /song/3USxtqRwSYz57Ewm6wWRMp/ HTTP/1.1" 200 353
INFO 2025-04-13 14:23:05,851 basehttp 18376 18972 "OPTIONS /songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 200 0
INFO 2025-04-13 14:23:05,853 basehttp 18376 18412 "POST /songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:05,856 basehttp 18376 18972 "OPTIONS /accounts/login/?next=/songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:05,857 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:05,858 basehttp 18376 18412 "GET /accounts/login/?next=/songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:06,125 basehttp 18376 3624 "GET /song/3USxtqRwSYz57Ewm6wWRMp/ HTTP/1.1" 200 353
INFO 2025-04-13 14:23:06,133 basehttp 18376 18412 "POST /songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:06,141 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:06,142 basehttp 18376 18412 "GET /accounts/login/?next=/songs/3USxtqRwSYz57Ewm6wWRMp/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:06,237 basehttp 18376 8116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:23:06,256 spotify_utils 18376 8132 Getting track for ID: 3USxtqRwSYz57Ewm6wWRMp
INFO 2025-04-13 14:23:06,732 basehttp 18376 3624 "OPTIONS /songs/3USxtqRwSYz57Ewm6wWRMp/play/ HTTP/1.1" 200 0
INFO 2025-04-13 14:23:06,735 basehttp 18376 18412 "POST /songs/3USxtqRwSYz57Ewm6wWRMp/play/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:06,737 basehttp 18376 3624 "OPTIONS /accounts/login/?next=/songs/3USxtqRwSYz57Ewm6wWRMp/play/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:06,740 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:06,740 basehttp 18376 18412 "GET /accounts/login/?next=/songs/3USxtqRwSYz57Ewm6wWRMp/play/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:06,767 spotify_utils 18376 8132 Successfully retrieved track: Heat Waves by Glass Animals
INFO 2025-04-13 14:23:06,919 basehttp 18376 8116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:23:09,879 basehttp 18376 8132 "GET /api/recommendations/similar/?spotify_id=3USxtqRwSYz57Ewm6wWRMp HTTP/1.1" 200 3043
INFO 2025-04-13 14:23:11,979 basehttp 18376 8132 "GET /api/recommendations/similar/?spotify_id=3USxtqRwSYz57Ewm6wWRMp HTTP/1.1" 200 3043
INFO 2025-04-13 14:23:16,749 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:16,764 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:23:16,765 basehttp 18376 9372 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:16,765 basehttp 18376 18972 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:16,771 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:16,773 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:16,776 log 18376 16880 Not Found: /accounts/login/
INFO 2025-04-13 14:23:16,777 basehttp 18376 18972 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:16,778 basehttp 18376 9372 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:16,779 basehttp 18376 16880 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:16,783 log 18376 9372 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:16,784 basehttp 18376 9372 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:17,471 basehttp 18376 8116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:23:17,551 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:23:17,961 basehttp 18376 3624 "GET /popularity/ HTTP/1.1" 200 13913
INFO 2025-04-13 14:23:18,208 basehttp 18376 8116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:23:18,351 basehttp 18376 2112 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:23:19,512 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 6756
INFO 2025-04-13 14:23:21,309 basehttp 18376 2112 "GET /popularity/ HTTP/1.1" 200 7208
INFO 2025-04-13 14:23:22,741 basehttp 18376 9372 "GET /popularity/ HTTP/1.1" 200 13908
WARNING 2025-04-13 14:23:55,889 log 18376 16880 Not Found: /songs/4oQ9SXKfTmAubnM06JMP5Z/comments
INFO 2025-04-13 14:23:55,894 basehttp 18376 9372 "OPTIONS /api/recommendations/similar/?spotify_id=4oQ9SXKfTmAubnM06JMP5Z HTTP/1.1" 200 0
INFO 2025-04-13 14:23:55,895 basehttp 18376 3624 "OPTIONS /api/recommendations/similar/?spotify_id=4oQ9SXKfTmAubnM06JMP5Z HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:55,895 basehttp 18376 16880 "GET /songs/4oQ9SXKfTmAubnM06JMP5Z/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:23:55,898 basehttp 18376 9372 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:55,904 log 18376 3624 Not Found: /accounts/login/
INFO 2025-04-13 14:23:55,904 basehttp 18376 2112 "GET /song/4oQ9SXKfTmAubnM06JMP5Z HTTP/1.1" 301 0
INFO 2025-04-13 14:23:55,904 basehttp 18376 8116 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:55,905 basehttp 18376 16880 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:55,912 log 18376 9372 Not Found: /songs/4oQ9SXKfTmAubnM06JMP5Z/comments
WARNING 2025-04-13 14:23:55,917 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:55,917 basehttp 18376 3624 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:55,919 basehttp 18376 8116 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:55,919 basehttp 18376 9372 "GET /songs/4oQ9SXKfTmAubnM06JMP5Z/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:55,919 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:55,921 log 18376 3624 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:55,926 log 18376 16880 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:55,926 basehttp 18376 3624 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:23:55,928 basehttp 18376 16880 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:56,208 basehttp 18376 7632 "GET /song/4oQ9SXKfTmAubnM06JMP5Z/ HTTP/1.1" 200 355
INFO 2025-04-13 14:23:56,212 basehttp 18376 16880 "OPTIONS /songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 200 0
INFO 2025-04-13 14:23:56,215 basehttp 18376 18412 "POST /songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:56,218 basehttp 18376 16880 "OPTIONS /accounts/login/?next=/songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:56,220 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:56,221 basehttp 18376 18412 "GET /accounts/login/?next=/songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:56,467 basehttp 18376 7632 "GET /song/4oQ9SXKfTmAubnM06JMP5Z/ HTTP/1.1" 200 355
INFO 2025-04-13 14:23:56,471 basehttp 18376 18412 "POST /songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:23:56,474 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:56,474 basehttp 18376 18412 "GET /accounts/login/?next=/songs/4oQ9SXKfTmAubnM06JMP5Z/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:56,569 spotify_utils 18376 8132 Getting track for ID: 4oQ9SXKfTmAubnM06JMP5Z
INFO 2025-04-13 14:23:56,575 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:23:56,898 basehttp 18376 7632 "OPTIONS /songs/4oQ9SXKfTmAubnM06JMP5Z/play/ HTTP/1.1" 200 0
INFO 2025-04-13 14:23:56,901 basehttp 18376 18412 "POST /songs/4oQ9SXKfTmAubnM06JMP5Z/play/ HTTP/1.1" 302 0
INFO 2025-04-13 14:23:56,903 basehttp 18376 7632 "OPTIONS /accounts/login/?next=/songs/4oQ9SXKfTmAubnM06JMP5Z/play/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:23:56,904 log 18376 18412 Not Found: /accounts/login/
WARNING 2025-04-13 14:23:56,904 basehttp 18376 18412 "GET /accounts/login/?next=/songs/4oQ9SXKfTmAubnM06JMP5Z/play/ HTTP/1.1" 404 179
INFO 2025-04-13 14:23:57,117 spotify_utils 18376 8132 Successfully retrieved track: We Don't Dance by Stickz, M24
INFO 2025-04-13 14:23:57,257 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:24:00,150 basehttp 18376 8132 "GET /api/recommendations/similar/?spotify_id=4oQ9SXKfTmAubnM06JMP5Z HTTP/1.1" 200 2889
INFO 2025-04-13 14:24:00,964 spotify_utils 18376 8132 Getting track for ID: 4oQ9SXKfTmAubnM06JMP5Z
INFO 2025-04-13 14:24:01,502 spotify_utils 18376 8132 Successfully retrieved track: We Don't Dance by Stickz, M24
INFO 2025-04-13 14:24:02,846 basehttp 18376 8132 "GET /api/recommendations/similar/?spotify_id=4oQ9SXKfTmAubnM06JMP5Z HTTP/1.1" 200 2889
INFO 2025-04-13 14:24:52,825 basehttp 18376 18616 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:24:52,832 log 18376 18616 Not Found: /accounts/login/
WARNING 2025-04-13 14:24:52,833 basehttp 18376 18616 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:24:56,631 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:25:56,779 basehttp 18376 18972 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:26:08,652 autoreload 18376 11808 C:\projects\music\server\songs\songs\settings.py changed, reloading.
INFO 2025-04-13 14:26:10,656 autoreload 20444 600 Watching for file changes with StatReloader
INFO 2025-04-13 14:26:31,651 basehttp 20444 19384 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:26:31,655 basehttp 20444 19384 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:26:31,655 basehttp 20444 12172 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:26:31,659 log 20444 11296 Not Found: /accounts/login/
WARNING 2025-04-13 14:26:31,659 log 20444 19384 Not Found: /accounts/login/
INFO 2025-04-13 14:26:31,659 basehttp 20444 12172 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:26:31,660 basehttp 20444 11296 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:26:31,660 basehttp 20444 19384 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:26:31,664 log 20444 11296 Not Found: /accounts/login/
WARNING 2025-04-13 14:26:31,665 log 20444 19384 Not Found: /accounts/login/
WARNING 2025-04-13 14:26:31,671 basehttp 20444 11296 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:26:31,671 basehttp 20444 19384 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:26:32,363 basehttp 20444 3280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:26:32,458 basehttp 20444 12284 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:26:33,040 basehttp 20444 3280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:26:33,221 basehttp 20444 12284 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
ERROR 2025-04-13 14:26:37,814 log 20444 15128 Bad Gateway: /popularity/
ERROR 2025-04-13 14:26:37,816 basehttp 20444 15128 "GET /popularity/ HTTP/1.1" 502 55
INFO 2025-04-13 14:26:39,266 basehttp 20444 15128 "GET /popularity/ HTTP/1.1" 200 13704
INFO 2025-04-13 14:26:40,753 basehttp 20444 12284 "GET /popularity/ HTTP/1.1" 200 13972
INFO 2025-04-13 14:26:42,305 basehttp 20444 15128 "GET /popularity/ HTTP/1.1" 200 13559
INFO 2025-04-13 14:27:21,223 basehttp 20444 19968 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:21,226 log 20444 19968 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:21,231 basehttp 20444 19968 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:21,235 basehttp 20444 13860 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:21,249 log 20444 13860 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:21,251 basehttp 20444 13860 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:22,002 basehttp 20444 18716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:27:22,084 basehttp 20444 15204 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:27:22,667 basehttp 20444 12520 "GET /popularity/ HTTP/1.1" 200 6968
INFO 2025-04-13 14:27:24,111 basehttp 20444 15204 "GET /popularity/ HTTP/1.1" 200 6871
INFO 2025-04-13 14:27:32,674 basehttp 20444 16592 "OPTIONS /search-songs/?q=ho HTTP/1.1" 200 0
INFO 2025-04-13 14:27:33,223 basehttp 20444 10448 "GET /search-songs/?q=h HTTP/1.1" 200 2007
INFO 2025-04-13 14:27:33,649 basehttp 20444 16592 "GET /search-songs/?q=ho HTTP/1.1" 200 2031
WARNING 2025-04-13 14:27:34,521 log 20444 16592 Not Found: /log-interaction/
WARNING 2025-04-13 14:27:34,522 basehttp 20444 16592 "POST /log-interaction/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:34,694 basehttp 20444 16592 "GET /song/0KSOLEBixnBYIKNHF1VbzF HTTP/1.1" 301 0
INFO 2025-04-13 14:27:34,696 basehttp 20444 10448 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:27:34,699 basehttp 20444 4728 "OPTIONS /api/recommendations/similar/?spotify_id=0KSOLEBixnBYIKNHF1VbzF HTTP/1.1" 200 0
WARNING 2025-04-13 14:27:34,700 log 20444 16612 Not Found: /songs/0KSOLEBixnBYIKNHF1VbzF/comments
INFO 2025-04-13 14:27:34,703 basehttp 20444 10448 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:34,706 log 20444 10448 Not Found: /accounts/login/
INFO 2025-04-13 14:27:34,707 basehttp 20444 17992 "OPTIONS /api/recommendations/similar/?spotify_id=0KSOLEBixnBYIKNHF1VbzF HTTP/1.1" 200 0
WARNING 2025-04-13 14:27:34,709 basehttp 20444 16612 "GET /songs/0KSOLEBixnBYIKNHF1VbzF/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:27:34,709 basehttp 20444 10448 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:27:34,710 log 20444 16612 Not Found: /songs/0KSOLEBixnBYIKNHF1VbzF/comments
INFO 2025-04-13 14:27:34,712 basehttp 20444 13428 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:34,713 log 20444 10448 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:34,714 log 20444 17992 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:34,715 basehttp 20444 16612 "GET /songs/0KSOLEBixnBYIKNHF1VbzF/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:27:34,717 basehttp 20444 10448 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:27:34,717 basehttp 20444 17992 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:34,718 basehttp 20444 13428 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:34,724 log 20444 17992 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:34,725 basehttp 20444 17992 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:34,955 basehttp 20444 4728 "GET /song/0KSOLEBixnBYIKNHF1VbzF/ HTTP/1.1" 200 384
INFO 2025-04-13 14:27:34,959 basehttp 20444 17992 "OPTIONS /songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 200 0
INFO 2025-04-13 14:27:34,961 basehttp 20444 13704 "POST /songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 302 0
INFO 2025-04-13 14:27:34,963 basehttp 20444 17992 "OPTIONS /accounts/login/?next=/songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:27:34,965 log 20444 13704 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:34,965 basehttp 20444 13704 "GET /accounts/login/?next=/songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:35,258 basehttp 20444 4728 "GET /song/0KSOLEBixnBYIKNHF1VbzF/ HTTP/1.1" 200 384
INFO 2025-04-13 14:27:35,261 basehttp 20444 13704 "POST /songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:27:35,264 log 20444 13704 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:35,264 basehttp 20444 13704 "GET /accounts/login/?next=/songs/0KSOLEBixnBYIKNHF1VbzF/view/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:35,407 spotify_utils 20444 15760 Getting track for ID: 0KSOLEBixnBYIKNHF1VbzF
INFO 2025-04-13 14:27:35,408 basehttp 20444 7768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:27:35,945 spotify_utils 20444 15760 Successfully retrieved track: Hona Tha Pyar by Atif Aslam, Hadiqa Kiani
INFO 2025-04-13 14:27:36,020 basehttp 20444 4728 "OPTIONS /songs/0KSOLEBixnBYIKNHF1VbzF/play/ HTTP/1.1" 200 0
INFO 2025-04-13 14:27:36,022 basehttp 20444 13704 "POST /songs/0KSOLEBixnBYIKNHF1VbzF/play/ HTTP/1.1" 302 0
INFO 2025-04-13 14:27:36,025 basehttp 20444 4728 "OPTIONS /accounts/login/?next=/songs/0KSOLEBixnBYIKNHF1VbzF/play/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:27:36,117 log 20444 13704 Not Found: /accounts/login/
WARNING 2025-04-13 14:27:36,117 basehttp 20444 13704 "GET /accounts/login/?next=/songs/0KSOLEBixnBYIKNHF1VbzF/play/ HTTP/1.1" 404 179
INFO 2025-04-13 14:27:36,277 basehttp 20444 7768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:27:39,561 basehttp 20444 15760 "GET /api/recommendations/similar/?spotify_id=0KSOLEBixnBYIKNHF1VbzF HTTP/1.1" 200 3330
INFO 2025-04-13 14:27:40,389 spotify_utils 20444 15760 Getting track for ID: 0KSOLEBixnBYIKNHF1VbzF
INFO 2025-04-13 14:27:41,009 spotify_utils 20444 15760 Successfully retrieved track: Hona Tha Pyar by Atif Aslam, Hadiqa Kiani
INFO 2025-04-13 14:27:42,474 basehttp 20444 15760 "GET /api/recommendations/similar/?spotify_id=0KSOLEBixnBYIKNHF1VbzF HTTP/1.1" 200 3330
INFO 2025-04-13 14:28:35,544 basehttp 20444 7768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:29:35,453 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:30:35,404 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:04,012 basehttp 20444 14092 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:04,033 basehttp 20444 18608 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:04,037 log 20444 18608 Not Found: /accounts/login/
INFO 2025-04-13 14:31:04,040 basehttp 20444 15088 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:04,041 basehttp 20444 18608 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:04,045 log 20444 15088 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:04,047 log 20444 18608 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:04,055 basehttp 20444 15088 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:04,058 basehttp 20444 18608 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:04,063 basehttp 20444 19116 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:04,067 log 20444 19116 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:04,068 basehttp 20444 19116 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:04,759 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:04,879 basehttp 20444 13736 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:05,378 basehttp 20444 20416 "GET /popularity/ HTTP/1.1" 200 13883
INFO 2025-04-13 14:31:05,526 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:05,669 basehttp 20444 13736 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:06,738 basehttp 20444 20416 "GET /popularity/ HTTP/1.1" 200 13941
INFO 2025-04-13 14:31:08,082 basehttp 20444 20416 "GET /popularity/ HTTP/1.1" 200 13947
INFO 2025-04-13 14:31:08,217 basehttp 20444 20152 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:31:08,331 basehttp 20444 19116 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:08,332 basehttp 20444 20416 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:08,342 basehttp 20444 19116 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:08,342 basehttp 20444 20416 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:08,345 log 20444 19116 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:08,346 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:08,347 basehttp 20444 19116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:08,347 basehttp 20444 20416 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:08,350 log 20444 19116 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:08,351 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:08,352 basehttp 20444 19116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:08,352 basehttp 20444 20416 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:09,038 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:09,323 basehttp 20444 13736 "GET /popularity/ HTTP/1.1" 200 8780
INFO 2025-04-13 14:31:09,815 basehttp 20444 18608 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:11,747 basehttp 20444 14092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:12,088 basehttp 20444 18608 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:12,667 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 6660
INFO 2025-04-13 14:31:14,810 basehttp 20444 18608 "GET /popularity/ HTTP/1.1" 200 13656
INFO 2025-04-13 14:31:18,409 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 13881
INFO 2025-04-13 14:31:20,167 basehttp 20444 18608 "GET /popularity/ HTTP/1.1" 200 13871
INFO 2025-04-13 14:31:25,043 basehttp 20444 18608 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:25,055 log 20444 20416 Not Found: /accounts/login/
INFO 2025-04-13 14:31:25,057 basehttp 20444 14092 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:25,057 basehttp 20444 20416 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:25,071 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:25,072 basehttp 20444 20416 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:26,421 basehttp 20444 18608 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:26,509 basehttp 20444 13736 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:27,070 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 13759
INFO 2025-04-13 14:31:29,518 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 13810
INFO 2025-04-13 14:31:40,743 basehttp 20444 19116 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:40,746 basehttp 20444 19116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:40,749 log 20444 19116 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:40,749 basehttp 20444 19116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:40,754 log 20444 19116 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:40,754 basehttp 20444 19116 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:40,775 basehttp 20444 19116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:40,801 log 20444 18608 Not Found: /accounts/login/
INFO 2025-04-13 14:31:40,808 basehttp 20444 19116 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:40,809 basehttp 20444 18608 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:40,828 log 20444 18608 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:40,829 basehttp 20444 18608 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:41,610 basehttp 20444 13736 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:42,458 basehttp 20444 13736 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:46,602 basehttp 20444 13736 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:46,613 basehttp 20444 13736 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:46,614 basehttp 20444 14092 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:31:46,617 basehttp 20444 13736 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:31:46,623 log 20444 13736 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:46,625 log 20444 14092 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:46,626 basehttp 20444 13736 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:46,630 basehttp 20444 14092 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:46,646 log 20444 13736 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:46,658 log 20444 14092 Not Found: /accounts/login/
WARNING 2025-04-13 14:31:46,658 basehttp 20444 13736 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:31:46,660 basehttp 20444 14092 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:31:47,534 basehttp 20444 18608 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:47,687 basehttp 20444 20416 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:48,205 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 6890
INFO 2025-04-13 14:31:48,434 basehttp 20444 18608 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:31:48,665 basehttp 20444 20416 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:31:49,724 basehttp 20444 14092 "GET /popularity/ HTTP/1.1" 200 6717
INFO 2025-04-13 14:31:51,332 basehttp 20444 20416 "GET /popularity/ HTTP/1.1" 200 6851
INFO 2025-04-13 14:31:54,190 basehttp 20444 14092 "POST /logout/ HTTP/1.1" 200 59
INFO 2025-04-13 14:31:55,069 basehttp 20444 20416 "POST /logout/ HTTP/1.1" 200 59
INFO 2025-04-13 14:31:56,179 basehttp 20444 18608 "GET /popularity/ HTTP/1.1" 200 13810
INFO 2025-04-13 14:32:00,848 basehttp 20444 20152 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:32:00,959 basehttp 20444 18608 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:32:00,976 basehttp 20444 14092 "GET /playlists/ HTTP/1.1" 302 0
INFO 2025-04-13 14:32:00,977 basehttp 20444 13736 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:00,978 log 20444 15088 Not Found: /accounts/login/
INFO 2025-04-13 14:32:00,980 basehttp 20444 14092 "GET /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:00,983 log 20444 13736 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:00,983 basehttp 20444 15088 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:32:00,983 basehttp 20444 13736 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:32:00,991 log 20444 15088 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:00,992 log 20444 13736 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:00,992 basehttp 20444 15088 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:32:00,994 basehttp 20444 13736 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:32:02,281 basehttp 20444 20416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:32:02,408 basehttp 20444 19116 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:32:03,009 basehttp 20444 18608 "GET /popularity/ HTTP/1.1" 200 6860
INFO 2025-04-13 14:32:03,043 basehttp 20444 20416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:32:03,299 basehttp 20444 19116 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:32:04,378 basehttp 20444 13736 "GET /popularity/ HTTP/1.1" 200 13844
INFO 2025-04-13 14:32:04,839 basehttp 20444 13736 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:04,842 log 20444 20416 Not Found: /accounts/login/
INFO 2025-04-13 14:32:04,843 basehttp 20444 13736 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:04,843 basehttp 20444 20416 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:32:04,846 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:04,847 basehttp 20444 20416 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:32:04,858 basehttp 20444 20416 "GET /profile/ HTTP/1.1" 302 0
INFO 2025-04-13 14:32:04,866 basehttp 20444 20416 "GET /profile/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:04,872 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:04,873 basehttp 20444 20416 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
WARNING 2025-04-13 14:32:04,876 log 20444 20416 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:04,877 basehttp 20444 20416 "GET /accounts/login/?next=/profile/ HTTP/1.1" 404 179
INFO 2025-04-13 14:32:05,733 basehttp 20444 13736 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:32:05,775 basehttp 20444 19116 "GET /popularity/ HTTP/1.1" 200 6413
INFO 2025-04-13 14:32:07,141 basehttp 20444 13736 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:32:07,816 basehttp 20444 20416 "GET /popularity/ HTTP/1.1" 200 10036
INFO 2025-04-13 14:32:38,481 basehttp 20444 11960 "POST /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:38,484 log 20444 11960 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:38,484 basehttp 20444 11960 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:32:41,741 basehttp 20444 11960 "POST /playlists/ HTTP/1.1" 302 0
WARNING 2025-04-13 14:32:41,743 log 20444 11960 Not Found: /accounts/login/
WARNING 2025-04-13 14:32:41,743 basehttp 20444 11960 "GET /accounts/login/?next=/playlists/ HTTP/1.1" 404 179
INFO 2025-04-13 14:33:05,683 basehttp 20444 20416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:34:05,665 basehttp 20444 5004 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:35:05,672 basehttp 20444 5004 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:35:45,114 autoreload 20444 600 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:35:46,785 autoreload 16880 14128 Watching for file changes with StatReloader
INFO 2025-04-13 14:35:54,461 autoreload 16880 14128 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:35:55,550 autoreload 16660 10000 Watching for file changes with StatReloader
INFO 2025-04-13 14:36:05,666 basehttp 16660 19384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:37:10,092 autoreload 16660 10000 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:37:11,166 autoreload 12992 18972 Watching for file changes with StatReloader
INFO 2025-04-13 14:37:21,838 basehttp 12992 18284 "POST /playlists/ HTTP/1.1" 201 174
INFO 2025-04-13 14:37:49,651 basehttp 12992 16600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:37:52,995 autoreload 12992 18972 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:37:54,070 autoreload 17308 7544 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:02,472 autoreload 17308 7544 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:03,622 autoreload 7912 7764 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:13,279 autoreload 7912 7764 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:14,318 autoreload 15740 15684 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:21,610 autoreload 15740 15684 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:22,727 autoreload 17308 9804 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:29,054 autoreload 17308 9804 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:30,248 autoreload 6384 16780 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:34,845 autoreload 6384 16780 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:36,092 autoreload 9236 14296 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:40,188 autoreload 9236 14296 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:41,462 autoreload 11700 7420 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:47,654 autoreload 11700 7420 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:48,741 autoreload 14896 11420 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:52,922 autoreload 14896 11420 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:38:54,038 autoreload 18264 12596 Watching for file changes with StatReloader
INFO 2025-04-13 14:38:59,285 autoreload 18264 12596 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:39:00,459 autoreload 16124 2024 Watching for file changes with StatReloader
INFO 2025-04-13 14:39:05,793 autoreload 16124 2024 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:39:06,907 autoreload 18456 13836 Watching for file changes with StatReloader
INFO 2025-04-13 14:39:49,782 basehttp 18456 6096 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:40:49,648 basehttp 18456 6096 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:41:11,457 autoreload 18456 13836 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:41:12,668 autoreload 100 19476 Watching for file changes with StatReloader
INFO 2025-04-13 14:41:49,692 basehttp 100 20156 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:42:21,371 autoreload 100 19476 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:42:22,468 autoreload 10068 1684 Watching for file changes with StatReloader
INFO 2025-04-13 14:42:49,698 basehttp 10068 14188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:43:49,642 basehttp 10068 14188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:44:51,295 basehttp 10068 14188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:45:49,765 basehttp 10068 14188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:46:49,685 basehttp 10068 14188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:47:19,723 autoreload 10068 1684 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:47:20,742 autoreload 17516 16660 Watching for file changes with StatReloader
INFO 2025-04-13 14:47:27,803 basehttp 17516 20288 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:05,643 basehttp 17516 20288 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:31,394 spotify_utils 17516 9968 Getting track for ID: 5CQ30WqJwcep0pYcV4AMNc
ERROR 2025-04-13 14:48:37,017 spotify_utils 17516 9968 Spotify API error: 502 - {"error": {"status": 502, "message": "" } }
WARNING 2025-04-13 14:48:37,020 log 17516 9968 Not Found: /playlists/1/songs/
WARNING 2025-04-13 14:48:37,020 basehttp 17516 9968 "POST /playlists/1/songs/ HTTP/1.1" 404 59
INFO 2025-04-13 14:48:45,415 basehttp 17516 20288 "GET /profile/ HTTP/1.1" 200 350
INFO 2025-04-13 14:48:45,434 basehttp 17516 18476 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:45,520 basehttp 17516 2140 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:48:45,601 basehttp 17516 14176 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:48:45,980 basehttp 17516 15496 "GET /popularity/ HTTP/1.1" 200 13912
INFO 2025-04-13 14:48:46,133 basehttp 17516 20288 "GET /profile/ HTTP/1.1" 200 350
INFO 2025-04-13 14:48:46,140 basehttp 17516 18476 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:46,337 basehttp 17516 2140 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:48:46,485 basehttp 17516 14176 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:48:47,391 basehttp 17516 15496 "GET /popularity/ HTTP/1.1" 200 13696
INFO 2025-04-13 14:48:48,573 basehttp 17516 10128 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 14:48:48,788 basehttp 17516 14176 "GET /popularity/ HTTP/1.1" 200 13824
INFO 2025-04-13 14:48:49,664 basehttp 17516 14176 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:49,738 basehttp 17516 18476 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:48:49,816 basehttp 17516 2140 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:48:50,060 basehttp 17516 15496 "GET /popularity/ HTTP/1.1" 200 13899
INFO 2025-04-13 14:48:50,596 basehttp 17516 14176 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:48:50,683 basehttp 17516 18476 "GET /api/recommendations/trending/ HTTP/1.1" 200 2658
INFO 2025-04-13 14:48:50,828 basehttp 17516 2140 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:48:51,422 basehttp 17516 20288 "GET /popularity/ HTTP/1.1" 200 12218
INFO 2025-04-13 14:48:52,728 basehttp 17516 2140 "GET /popularity/ HTTP/1.1" 200 13708
INFO 2025-04-13 14:48:54,096 basehttp 17516 2140 "GET /popularity/ HTTP/1.1" 200 13669
INFO 2025-04-13 14:48:55,397 basehttp 17516 2140 "GET /popularity/ HTTP/1.1" 200 13793
INFO 2025-04-13 14:49:00,558 basehttp 17516 9044 "GET /song/2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 301 0
INFO 2025-04-13 14:49:00,565 basehttp 17516 10368 "OPTIONS /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 0
WARNING 2025-04-13 14:49:00,574 log 17516 6120 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:49:00,578 basehttp 17516 6120 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:49:00,582 log 17516 6120 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:49:00,589 basehttp 17516 6120 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:49:00,589 basehttp 17516 11600 "OPTIONS /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 0
INFO 2025-04-13 14:49:00,845 basehttp 17516 10368 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:49:00,851 basehttp 17516 6120 "OPTIONS /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 200 0
INFO 2025-04-13 14:49:01,092 basehttp 17516 10368 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:49:01,271 spotify_utils 17516 10136 Getting track for ID: 2aTvlIMGoo2L9x5YzJNjj5
INFO 2025-04-13 14:49:01,271 basehttp 17516 2140 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:01,425 basehttp 17516 6116 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:49:01,525 spotify_utils 17516 3140 Getting track for ID: 2aTvlIMGoo2L9x5YzJNjj5
INFO 2025-04-13 14:49:01,771 spotify_utils 17516 12092 Getting track for ID: 2aTvlIMGoo2L9x5YzJNjj5
INFO 2025-04-13 14:49:01,824 spotify_utils 17516 10136 Successfully retrieved track: La Gent Que Estimo by Oques Grasses, Rita Payés
INFO 2025-04-13 14:49:01,929 basehttp 17516 2140 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:02,029 spotify_utils 17516 3140 Successfully retrieved track: La Gent Que Estimo by Oques Grasses, Rita Payés
INFO 2025-04-13 14:49:02,284 spotify_utils 17516 12092 Successfully retrieved track: La Gent Que Estimo by Oques Grasses, Rita Payés
INFO 2025-04-13 14:49:02,304 basehttp 17516 6116 "GET /playlists/ HTTP/1.1" 200 148
INFO 2025-04-13 14:49:02,330 basehttp 17516 3140 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 200 54
INFO 2025-04-13 14:49:02,337 basehttp 17516 6116 "OPTIONS /songs/2aTvlIMGoo2L9x5YzJNjj5/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:49:02,341 log 17516 3140 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/status/
WARNING 2025-04-13 14:49:02,342 basehttp 17516 3140 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/status/ HTTP/1.1" 404 179
ERROR 2025-04-13 14:49:02,365 log 17516 12092 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 996, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 14:49:02,804 basehttp 17516 12092 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 14:49:03,270 basehttp 17516 10136 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 14:49:03,454 basehttp 17516 6116 "OPTIONS /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 200 0
INFO 2025-04-13 14:49:04,254 basehttp 17516 12092 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 200 60
INFO 2025-04-13 14:49:05,388 basehttp 17516 10136 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 14:49:21,080 spotify_utils 17516 9968 Getting track for ID: 2aTvlIMGoo2L9x5YzJNjj5
INFO 2025-04-13 14:49:21,632 spotify_utils 17516 9968 Successfully retrieved track: La Gent Que Estimo by Oques Grasses, Rita Payés
INFO 2025-04-13 14:49:22,293 basehttp 17516 9968 "POST /playlists/1/songs/ HTTP/1.1" 200 287
INFO 2025-04-13 14:49:33,544 basehttp 17516 3024 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:33,607 basehttp 17516 18008 "GET /api/recommendations/trending/ HTTP/1.1" 200 2971
INFO 2025-04-13 14:49:33,688 basehttp 17516 18896 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:49:33,998 basehttp 17516 1892 "GET /popularity/ HTTP/1.1" 200 8271
INFO 2025-04-13 14:49:34,243 basehttp 17516 3024 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:34,333 basehttp 17516 18008 "GET /api/recommendations/trending/ HTTP/1.1" 200 2971
INFO 2025-04-13 14:49:34,512 basehttp 17516 18896 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:49:35,462 basehttp 17516 1892 "GET /popularity/ HTTP/1.1" 200 6798
INFO 2025-04-13 14:49:36,883 basehttp 17516 18896 "GET /popularity/ HTTP/1.1" 200 6883
INFO 2025-04-13 14:49:38,413 basehttp 17516 1892 "GET /popularity/ HTTP/1.1" 200 13793
INFO 2025-04-13 14:49:41,702 basehttp 17516 1892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:41,841 basehttp 17516 18896 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:49:41,849 basehttp 17516 18008 "OPTIONS /playlists/1/songs/ HTTP/1.1" 200 0
INFO 2025-04-13 14:49:42,400 basehttp 17516 1892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:42,612 basehttp 17516 18008 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 14:49:42,675 basehttp 17516 18896 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:49:43,496 basehttp 17516 18896 "GET /playlists/1/songs/ HTTP/1.1" 200 294
WARNING 2025-04-13 14:49:51,048 log 17516 18008 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:49:51,058 basehttp 17516 18008 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:49:51,061 log 17516 18008 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:49:51,062 basehttp 17516 18008 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:49:51,332 basehttp 17516 3024 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:49:51,582 basehttp 17516 3024 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:49:51,723 basehttp 17516 18896 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:51,856 basehttp 17516 1892 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 14:49:52,086 log 17516 3100 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1007, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 14:49:52,291 basehttp 17516 3100 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 14:49:52,343 log 17516 7744 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1007, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 14:49:52,368 basehttp 17516 7744 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 14:49:52,433 basehttp 17516 18896 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:49:52,740 basehttp 17516 1892 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:49:53,045 basehttp 17516 13936 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
ERROR 2025-04-13 14:49:53,712 log 17516 7744 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 946, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.
ERROR 2025-04-13 14:49:53,719 basehttp 17516 7744 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 500 145
INFO 2025-04-13 14:49:55,296 basehttp 17516 13936 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 14:49:55,369 basehttp 17516 1892 "OPTIONS /songs/2aTvlIMGoo2L9x5YzJNjj5/like/ HTTP/1.1" 200 0
INFO 2025-04-13 14:49:56,346 basehttp 17516 13936 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/like/ HTTP/1.1" 200 59
INFO 2025-04-13 14:50:01,679 basehttp 17516 18896 "GET /liked-songs/ HTTP/1.1" 200 413
INFO 2025-04-13 14:50:01,682 basehttp 17516 1892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:50:02,369 basehttp 17516 18896 "GET /liked-songs/ HTTP/1.1" 200 413
INFO 2025-04-13 14:50:02,371 basehttp 17516 1892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:51:02,840 basehttp 17516 1892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:51:50,063 autoreload 17516 16660 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:51:51,493 autoreload 8308 19056 Watching for file changes with StatReloader
INFO 2025-04-13 14:52:02,773 basehttp 8308 12992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:09,494 basehttp 8308 6152 "OPTIONS /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 0
WARNING 2025-04-13 14:52:09,497 log 8308 7916 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
INFO 2025-04-13 14:52:09,497 basehttp 8308 8992 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 301 0
WARNING 2025-04-13 14:52:09,506 basehttp 8308 7916 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:52:09,506 basehttp 8308 1072 "OPTIONS /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 0
WARNING 2025-04-13 14:52:09,514 log 8308 13368 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 14:52:09,515 basehttp 8308 13368 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:52:10,118 basehttp 8308 6152 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 14:52:10,121 basehttp 8308 13368 "OPTIONS /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 200 0
INFO 2025-04-13 14:52:10,246 basehttp 8308 12992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:10,324 spotify_utils 8308 11600 Getting track for ID: 6KTv0Z8BmVqM7DPxbGzpVC
INFO 2025-04-13 14:52:10,406 basehttp 8308 6152 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 14:52:10,490 basehttp 8308 18248 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:52:10,857 spotify_utils 8308 12172 Getting track for ID: 6KTv0Z8BmVqM7DPxbGzpVC
INFO 2025-04-13 14:52:10,929 spotify_utils 8308 11600 Successfully retrieved track: Rock And Roll All Nite by KISS
INFO 2025-04-13 14:52:11,135 spotify_utils 8308 19672 Getting track for ID: 6KTv0Z8BmVqM7DPxbGzpVC
INFO 2025-04-13 14:52:11,287 basehttp 8308 12992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:11,346 basehttp 8308 18248 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 14:52:11,412 spotify_utils 8308 12172 Successfully retrieved track: Rock And Roll All Nite by KISS
INFO 2025-04-13 14:52:11,698 basehttp 8308 12172 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 200 54
INFO 2025-04-13 14:52:11,700 basehttp 8308 18248 "OPTIONS /songs/6KTv0Z8BmVqM7DPxbGzpVC/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 14:52:11,709 log 8308 12172 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/status/
WARNING 2025-04-13 14:52:11,709 basehttp 8308 12172 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/status/ HTTP/1.1" 404 179
INFO 2025-04-13 14:52:11,756 spotify_utils 8308 19672 Successfully retrieved track: Rock And Roll All Nite by KISS
ERROR 2025-04-13 14:52:11,829 log 8308 19672 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 996, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 14:52:11,851 basehttp 8308 19672 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
INFO 2025-04-13 14:52:12,732 basehttp 8308 18248 "OPTIONS /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/ HTTP/1.1" 200 0
INFO 2025-04-13 14:52:13,567 basehttp 8308 19672 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/ HTTP/1.1" 200 60
INFO 2025-04-13 14:52:13,723 basehttp 8308 11600 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
INFO 2025-04-13 14:52:15,104 basehttp 8308 18248 "OPTIONS /songs/6KTv0Z8BmVqM7DPxbGzpVC/like/ HTTP/1.1" 200 0
INFO 2025-04-13 14:52:16,106 basehttp 8308 11600 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
INFO 2025-04-13 14:52:16,140 basehttp 8308 19672 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/like/ HTTP/1.1" 200 59
INFO 2025-04-13 14:52:18,030 basehttp 8308 19672 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/like/ HTTP/1.1" 200 58
INFO 2025-04-13 14:52:20,932 basehttp 8308 18248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:21,008 basehttp 8308 12992 "GET /liked-songs/ HTTP/1.1" 200 824
INFO 2025-04-13 14:52:21,731 basehttp 8308 18248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:21,815 basehttp 8308 12992 "GET /liked-songs/ HTTP/1.1" 200 824
WARNING 2025-04-13 14:52:39,491 log 8308 13368 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:52:39,494 basehttp 8308 13368 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
WARNING 2025-04-13 14:52:39,497 log 8308 13368 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:52:39,498 basehttp 8308 13368 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:52:39,752 basehttp 8308 6152 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:52:39,997 basehttp 8308 6152 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:52:40,204 basehttp 8308 12992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:40,369 basehttp 8308 18248 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 14:52:40,510 log 8308 11600 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1007, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 14:52:40,517 basehttp 8308 11600 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 14:52:40,805 log 8308 12172 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1007, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 14:52:40,822 basehttp 8308 12172 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 14:52:40,936 basehttp 8308 12992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:52:41,301 basehttp 8308 18248 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 14:52:41,698 log 8308 12172 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 946, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.
ERROR 2025-04-13 14:52:41,711 basehttp 8308 12172 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 500 145
INFO 2025-04-13 14:52:41,863 basehttp 8308 19672 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 14:52:43,916 basehttp 8308 19672 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 14:53:41,073 basehttp 8308 18248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:54:40,677 basehttp 8308 18248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:55:40,745 basehttp 8308 18248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:55:43,183 autoreload 8308 19056 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:55:44,258 autoreload 10644 19592 Watching for file changes with StatReloader
INFO 2025-04-13 14:56:09,923 autoreload 10644 19592 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:56:10,922 autoreload 19544 12456 Watching for file changes with StatReloader
INFO 2025-04-13 14:56:40,705 basehttp 19544 17412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:56:53,330 autoreload 19544 12456 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 14:56:54,295 autoreload 10772 14100 Watching for file changes with StatReloader
WARNING 2025-04-13 14:57:05,917 log 10772 14280 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 14:57:05,920 basehttp 10772 14280 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
INFO 2025-04-13 14:57:06,476 basehttp 10772 11612 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 14:57:06,673 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:57:06,838 basehttp 10772 5524 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 14:57:07,290 log 10772 17300 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 14:57:07,300 basehttp 10772 17300 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 14:57:08,158 basehttp 10772 20476 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
ERROR 2025-04-13 14:57:08,730 log 10772 17300 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.
ERROR 2025-04-13 14:57:08,735 basehttp 10772 17300 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 500 145
INFO 2025-04-13 14:57:10,900 basehttp 10772 17300 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/like/ HTTP/1.1" 200 77
INFO 2025-04-13 14:57:16,474 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:57:16,522 basehttp 10772 6936 "GET /liked-songs/ HTTP/1.1" 200 444
INFO 2025-04-13 14:57:17,194 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:57:17,311 basehttp 10772 6936 "GET /liked-songs/ HTTP/1.1" 200 444
WARNING 2025-04-13 14:57:47,989 log 10772 708 Method Not Allowed: /liked-songs/
WARNING 2025-04-13 14:57:47,990 basehttp 10772 708 "POST /liked-songs/ HTTP/1.1" 405 41
INFO 2025-04-13 14:57:54,654 basehttp 10772 708 "GET /liked-songs/ HTTP/1.1" 200 444
INFO 2025-04-13 14:58:17,266 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 14:59:17,386 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 14:59:27,297 log 10772 1484 Method Not Allowed: /songs/2aTvlIMGoo2L9x5YzJNjj5/like/
WARNING 2025-04-13 14:59:27,298 basehttp 10772 1484 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/like/ HTTP/1.1" 405 40
INFO 2025-04-13 14:59:34,915 basehttp 10772 1484 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:00:18,376 basehttp 10772 1484 "GET /liked-songs/ HTTP/1.1" 200 824
INFO 2025-04-13 15:00:20,226 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:28,967 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:29,068 basehttp 10772 5524 "GET /liked-songs/ HTTP/1.1" 200 824
WARNING 2025-04-13 15:00:33,273 log 10772 6936 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 15:00:33,281 basehttp 10772 6936 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:00:33,283 log 10772 6936 Not Found: /songs/2aTvlIMGoo2L9x5YzJNjj5/comments
WARNING 2025-04-13 15:00:33,284 basehttp 10772 6936 "GET /songs/2aTvlIMGoo2L9x5YzJNjj5/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:00:34,707 basehttp 10772 14280 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 15:00:35,667 basehttp 10772 14280 "GET /song/2aTvlIMGoo2L9x5YzJNjj5/ HTTP/1.1" 200 370
INFO 2025-04-13 15:00:36,713 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:36,919 basehttp 10772 11612 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 15:00:37,104 log 10772 20476 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
ERROR 2025-04-13 15:00:37,115 basehttp 10772 20476 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:00:37,795 log 10772 12160 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, view) already exists.
INFO 2025-04-13 15:00:37,796 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 15:00:37,801 basehttp 10772 12160 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:00:38,785 basehttp 10772 11612 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 15:00:39,170 log 10772 20476 Internal Server Error: /songs/2aTvlIMGoo2L9x5YzJNjj5/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 112, play) already exists.
ERROR 2025-04-13 15:00:39,187 basehttp 10772 20476 "POST /songs/2aTvlIMGoo2L9x5YzJNjj5/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:00:39,261 basehttp 10772 17300 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 15:00:39,555 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:39,827 basehttp 10772 11612 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:40,537 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:40,697 basehttp 10772 14280 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:00:41,153 basehttp 10772 11612 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:43,587 basehttp 10772 11612 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:00:43,587 basehttp 10772 17300 "GET /api/recommendations/similar/?spotify_id=2aTvlIMGoo2L9x5YzJNjj5 HTTP/1.1" 200 2889
INFO 2025-04-13 15:00:43,970 basehttp 10772 14280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:44,060 basehttp 10772 6936 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:44,895 basehttp 10772 14280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:44,922 basehttp 10772 5524 "GET /popularity/ HTTP/1.1" 200 13694
INFO 2025-04-13 15:00:44,989 basehttp 10772 20136 "GET /api/recommendations/trending/ HTTP/1.1" 200 3315
INFO 2025-04-13 15:00:45,194 basehttp 10772 6936 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:46,214 basehttp 10772 20136 "GET /api/recommendations/trending/ HTTP/1.1" 200 3315
INFO 2025-04-13 15:00:46,637 basehttp 10772 14280 "GET /popularity/ HTTP/1.1" 200 10032
INFO 2025-04-13 15:00:49,319 basehttp 10772 14280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:49,834 basehttp 10772 20136 "GET /popularity/ HTTP/1.1" 200 13969
INFO 2025-04-13 15:00:50,125 basehttp 10772 6936 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:50,377 basehttp 10772 14280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:51,482 basehttp 10772 5524 "GET /popularity/ HTTP/1.1" 200 6869
INFO 2025-04-13 15:00:52,097 basehttp 10772 20136 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:00:52,177 basehttp 10772 6936 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:00:53,085 basehttp 10772 6936 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:00:59,762 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:00:59,932 basehttp 10772 20136 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:01:00,820 basehttp 10772 20136 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:01:05,908 basehttp 10772 20136 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:01:06,025 basehttp 10772 6936 "GET /liked-songs/ HTTP/1.1" 200 824
INFO 2025-04-13 15:01:07,153 basehttp 10772 20136 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:01:08,295 basehttp 10772 6936 "GET /liked-songs/ HTTP/1.1" 200 824
WARNING 2025-04-13 15:01:29,884 log 10772 20136 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:01:29,888 basehttp 10772 20136 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:01:29,894 log 10772 20136 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:01:29,904 basehttp 10772 20136 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:01:30,193 basehttp 10772 14280 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:01:30,473 basehttp 10772 14280 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:01:30,601 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:01:30,863 basehttp 10772 5524 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 15:01:31,048 log 10772 20476 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
ERROR 2025-04-13 15:01:31,062 basehttp 10772 20476 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:01:31,380 log 10772 12160 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
ERROR 2025-04-13 15:01:31,392 basehttp 10772 12160 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:01:31,800 basehttp 10772 6936 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:01:31,805 basehttp 10772 5524 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:01:32,041 basehttp 10772 17300 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
ERROR 2025-04-13 15:01:32,812 log 10772 12160 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.
ERROR 2025-04-13 15:01:32,834 basehttp 10772 12160 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:01:34,250 basehttp 10772 17300 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
INFO 2025-04-13 15:02:30,572 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:03:31,099 basehttp 10772 5524 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:03:44,058 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:03:44,230 basehttp 10772 692 "GET /liked-songs/ HTTP/1.1" 200 824
INFO 2025-04-13 15:03:45,118 basehttp 10772 692 "GET /liked-songs/ HTTP/1.1" 200 824
INFO 2025-04-13 15:03:45,130 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 15:03:52,291 log 10772 692 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:03:52,294 basehttp 10772 692 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:03:52,300 log 10772 692 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:03:52,304 basehttp 10772 692 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:03:52,672 basehttp 10772 8580 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:03:52,966 basehttp 10772 8580 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:03:53,014 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:03:53,226 basehttp 10772 16152 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 15:03:53,456 log 10772 10128 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
ERROR 2025-04-13 15:03:53,464 basehttp 10772 10128 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:03:53,881 log 10772 10900 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
INFO 2025-04-13 15:03:53,885 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 15:03:53,903 basehttp 10772 10900 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:03:54,392 basehttp 10772 16152 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:03:54,982 basehttp 10772 17468 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
ERROR 2025-04-13 15:03:55,151 log 10772 10900 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.
ERROR 2025-04-13 15:03:55,160 basehttp 10772 10900 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:03:57,798 basehttp 10772 17468 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
INFO 2025-04-13 15:03:58,464 basehttp 10772 10900 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/like/ HTTP/1.1" 200 77
INFO 2025-04-13 15:03:59,976 basehttp 10772 16152 "OPTIONS /songs/6KTv0Z8BmVqM7DPxbGzpVC/save/ HTTP/1.1" 200 0
INFO 2025-04-13 15:04:00,928 basehttp 10772 10900 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/save/ HTTP/1.1" 200 74
INFO 2025-04-13 15:04:11,147 basehttp 10772 16152 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:04:11,258 basehttp 10772 19720 "GET /liked-songs/ HTTP/1.1" 200 413
INFO 2025-04-13 15:04:11,936 basehttp 10772 16152 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:04:12,095 basehttp 10772 19720 "GET /liked-songs/ HTTP/1.1" 200 413
WARNING 2025-04-13 15:04:13,001 log 10772 16152 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:04:13,008 basehttp 10772 16152 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:04:13,011 log 10772 16152 Not Found: /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments
WARNING 2025-04-13 15:04:13,012 basehttp 10772 16152 "GET /songs/6KTv0Z8BmVqM7DPxbGzpVC/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:04:13,316 basehttp 10772 692 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:04:13,587 basehttp 10772 692 "GET /song/6KTv0Z8BmVqM7DPxbGzpVC/ HTTP/1.1" 200 362
INFO 2025-04-13 15:04:13,686 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:04:13,917 basehttp 10772 8580 "GET /playlists/ HTTP/1.1" 200 210
ERROR 2025-04-13 15:04:14,163 log 10772 17468 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
ERROR 2025-04-13 15:04:14,173 basehttp 10772 17468 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:04:14,512 log 10772 10128 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, view) already exists.
INFO 2025-04-13 15:04:14,516 basehttp 10772 19720 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 15:04:14,529 basehttp 10772 10128 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:04:14,896 basehttp 10772 8580 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:04:15,221 basehttp 10772 10900 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
ERROR 2025-04-13 15:04:15,980 log 10772 10128 Internal Server Error: /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 113, play) already exists.
ERROR 2025-04-13 15:04:15,987 basehttp 10772 10128 "POST /songs/6KTv0Z8BmVqM7DPxbGzpVC/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:04:17,419 basehttp 10772 10900 "GET /api/recommendations/similar/?spotify_id=6KTv0Z8BmVqM7DPxbGzpVC HTTP/1.1" 200 2909
INFO 2025-04-13 15:05:13,796 basehttp 10772 8580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:06:14,014 basehttp 10772 8580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:07:14,003 basehttp 10772 8580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:08:13,700 basehttp 10772 8580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:09:13,733 basehttp 10772 8580 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:23:27,671 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:23:34,537 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 15:23:34,567 log 10772 18836 Not Found: /recommendations/friends/
WARNING 2025-04-13 15:23:34,568 basehttp 10772 18836 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 15:23:34,606 basehttp 10772 14196 "GET /history/recent/?limit=4 HTTP/1.1" 200 824
INFO 2025-04-13 15:23:34,675 basehttp 10772 6448 "GET /history/most-played/ HTTP/1.1" 200 854
INFO 2025-04-13 15:23:34,709 basehttp 10772 12656 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:23:35,008 basehttp 10772 17308 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 15:23:35,240 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 15:23:35,246 log 10772 18836 Not Found: /recommendations/friends/
WARNING 2025-04-13 15:23:35,247 basehttp 10772 18836 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 15:23:35,288 basehttp 10772 14196 "GET /history/recent/?limit=4 HTTP/1.1" 200 824
INFO 2025-04-13 15:23:35,421 basehttp 10772 6448 "GET /history/most-played/ HTTP/1.1" 200 854
INFO 2025-04-13 15:23:35,533 basehttp 10772 12656 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:23:36,072 basehttp 10772 17308 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5992
INFO 2025-04-13 15:23:37,129 basehttp 10772 17308 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5931
INFO 2025-04-13 15:23:38,248 basehttp 10772 12656 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6051
INFO 2025-04-13 15:24:01,949 basehttp 10772 12656 "OPTIONS /search-songs/?q=k HTTP/1.1" 200 0
INFO 2025-04-13 15:24:02,269 basehttp 10772 17308 "OPTIONS /search-songs/?q=ki HTTP/1.1" 200 0
INFO 2025-04-13 15:24:02,632 basehttp 10772 6448 "OPTIONS /search-songs/?q=kis HTTP/1.1" 200 0
INFO 2025-04-13 15:24:02,888 basehttp 10772 14196 "OPTIONS /search-songs/?q=kiss HTTP/1.1" 200 0
INFO 2025-04-13 15:24:02,959 basehttp 10772 12656 "GET /search-songs/?q=k HTTP/1.1" 200 1955
INFO 2025-04-13 15:24:03,058 basehttp 10772 12656 "OPTIONS /search-songs/?q=kiss%20 HTTP/1.1" 200 0
INFO 2025-04-13 15:24:03,256 basehttp 10772 17308 "GET /search-songs/?q=ki HTTP/1.1" 200 1975
INFO 2025-04-13 15:24:03,385 basehttp 10772 17308 "OPTIONS /search-songs/?q=kiss%20m HTTP/1.1" 200 0
INFO 2025-04-13 15:24:03,615 basehttp 10772 6448 "GET /search-songs/?q=kis HTTP/1.1" 200 2043
INFO 2025-04-13 15:24:03,943 basehttp 10772 14196 "GET /search-songs/?q=kiss HTTP/1.1" 200 2025
INFO 2025-04-13 15:24:04,130 basehttp 10772 12656 "GET /search-songs/?q=kiss%20 HTTP/1.1" 200 2025
INFO 2025-04-13 15:24:04,453 basehttp 10772 17308 "GET /search-songs/?q=kiss%20m HTTP/1.1" 200 2056
WARNING 2025-04-13 15:24:04,854 log 10772 17308 Not Found: /log-interaction/
WARNING 2025-04-13 15:24:04,855 basehttp 10772 17308 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-13 15:24:04,985 log 10772 6448 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
INFO 2025-04-13 15:24:04,986 basehttp 10772 12656 "OPTIONS /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 0
INFO 2025-04-13 15:24:04,989 basehttp 10772 14196 "GET /song/754kgU5rWscRTfvlsuEwFp HTTP/1.1" 301 0
INFO 2025-04-13 15:24:04,989 basehttp 10772 18836 "OPTIONS /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 0
WARNING 2025-04-13 15:24:04,994 basehttp 10772 6448 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:24:05,000 log 10772 6448 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
WARNING 2025-04-13 15:24:05,002 basehttp 10772 6448 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:24:05,276 basehttp 10772 18836 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 15:24:05,279 basehttp 10772 6448 "OPTIONS /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 200 0
INFO 2025-04-13 15:24:05,533 basehttp 10772 18836 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 15:24:05,710 spotify_utils 10772 16508 Getting track for ID: 754kgU5rWscRTfvlsuEwFp
INFO 2025-04-13 15:24:05,710 basehttp 10772 17308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:24:05,878 basehttp 10772 18884 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:24:06,002 spotify_utils 10772 18948 Getting track for ID: 754kgU5rWscRTfvlsuEwFp
INFO 2025-04-13 15:24:06,238 spotify_utils 10772 18352 Getting track for ID: 754kgU5rWscRTfvlsuEwFp
INFO 2025-04-13 15:24:06,298 spotify_utils 10772 16508 Successfully retrieved track: Kiss Me by Sixpence None The Richer
INFO 2025-04-13 15:24:06,395 basehttp 10772 17308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:24:06,511 spotify_utils 10772 18948 Successfully retrieved track: Kiss Me by Sixpence None The Richer
INFO 2025-04-13 15:24:06,735 basehttp 10772 18884 "GET /playlists/ HTTP/1.1" 200 210
INFO 2025-04-13 15:24:06,830 basehttp 10772 18948 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 200 54
INFO 2025-04-13 15:24:06,835 basehttp 10772 18884 "OPTIONS /songs/754kgU5rWscRTfvlsuEwFp/status/ HTTP/1.1" 200 0
INFO 2025-04-13 15:24:06,835 spotify_utils 10772 18352 Successfully retrieved track: Kiss Me by Sixpence None The Richer
WARNING 2025-04-13 15:24:06,837 log 10772 18948 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/status/
WARNING 2025-04-13 15:24:06,839 basehttp 10772 18948 "GET /songs/754kgU5rWscRTfvlsuEwFp/status/ HTTP/1.1" 404 179
ERROR 2025-04-13 15:24:06,912 log 10772 18352 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 15:24:06,917 basehttp 10772 18352 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:24:07,516 basehttp 10772 18884 "OPTIONS /songs/754kgU5rWscRTfvlsuEwFp/play/ HTTP/1.1" 200 0
INFO 2025-04-13 15:24:08,295 basehttp 10772 18352 "POST /songs/754kgU5rWscRTfvlsuEwFp/play/ HTTP/1.1" 200 60
INFO 2025-04-13 15:24:09,249 basehttp 10772 16508 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3236
INFO 2025-04-13 15:24:11,236 basehttp 10772 16508 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3236
INFO 2025-04-13 15:24:12,977 basehttp 10772 18884 "OPTIONS /songs/754kgU5rWscRTfvlsuEwFp/like/ HTTP/1.1" 200 0
INFO 2025-04-13 15:24:14,093 basehttp 10772 16508 "POST /songs/754kgU5rWscRTfvlsuEwFp/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:25:05,702 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:26:06,718 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:27:06,730 basehttp 10772 18884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:28:04,374 basehttp 10772 22016 "OPTIONS /songs/754kgU5rWscRTfvlsuEwFp/save/ HTTP/1.1" 200 0
INFO 2025-04-13 15:28:05,263 basehttp 10772 22020 "POST /songs/754kgU5rWscRTfvlsuEwFp/save/ HTTP/1.1" 200 74
INFO 2025-04-13 15:28:05,662 basehttp 10772 22016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:28:21,898 basehttp 10772 22016 "POST /playlists/ HTTP/1.1" 201 158
INFO 2025-04-13 15:28:24,552 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 308
INFO 2025-04-13 15:28:24,560 basehttp 10772 22016 "OPTIONS /playlists/2/songs/ HTTP/1.1" 200 0
INFO 2025-04-13 15:28:26,100 spotify_utils 10772 22016 Getting track for ID: 43z6scIZU2QcEieMQFAJRG
INFO 2025-04-13 15:28:26,973 spotify_utils 10772 22016 Successfully retrieved track: There She Goes by Sixpence None The Richer
INFO 2025-04-13 15:28:27,713 basehttp 10772 22016 "POST /playlists/2/songs/ HTTP/1.1" 200 287
INFO 2025-04-13 15:28:40,497 basehttp 10772 21896 "OPTIONS /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 0
INFO 2025-04-13 15:28:40,503 basehttp 10772 10416 "GET /song/43z6scIZU2QcEieMQFAJRG HTTP/1.1" 301 0
WARNING 2025-04-13 15:28:40,506 log 10772 21520 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/comments
WARNING 2025-04-13 15:28:40,509 basehttp 10772 21520 "GET /songs/43z6scIZU2QcEieMQFAJRG/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:28:40,931 basehttp 10772 21896 "GET /song/43z6scIZU2QcEieMQFAJRG/ HTTP/1.1" 200 383
INFO 2025-04-13 15:28:40,935 basehttp 10772 21896 "OPTIONS /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 200 0
INFO 2025-04-13 15:28:42,166 basehttp 10772 22016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:28:42,704 basehttp 10772 21532 "POST /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 200 54
INFO 2025-04-13 15:28:42,710 basehttp 10772 22016 "OPTIONS /songs/43z6scIZU2QcEieMQFAJRG/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 15:28:42,718 log 10772 21532 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/status/
WARNING 2025-04-13 15:28:42,721 basehttp 10772 21532 "GET /songs/43z6scIZU2QcEieMQFAJRG/status/ HTTP/1.1" 404 179
INFO 2025-04-13 15:28:42,790 basehttp 10772 21536 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:28:43,820 basehttp 10772 21536 "OPTIONS /songs/43z6scIZU2QcEieMQFAJRG/play/ HTTP/1.1" 200 0
INFO 2025-04-13 15:28:43,924 basehttp 10772 22020 "GET /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 3234
INFO 2025-04-13 15:28:44,696 basehttp 10772 21532 "POST /songs/43z6scIZU2QcEieMQFAJRG/play/ HTTP/1.1" 200 60
INFO 2025-04-13 15:28:56,325 basehttp 10772 21536 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:28:56,814 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:28:57,640 basehttp 10772 21536 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:28:58,649 basehttp 10772 21896 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:28:58,955 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:28:59,694 basehttp 10772 21896 "GET /playlists/2/songs/ HTTP/1.1" 200 278
INFO 2025-04-13 15:28:59,869 basehttp 10772 22016 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:29:00,702 basehttp 10772 22016 "GET /playlists/2/songs/ HTTP/1.1" 200 278
WARNING 2025-04-13 15:29:02,391 log 10772 21896 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/comments
WARNING 2025-04-13 15:29:02,393 basehttp 10772 21896 "GET /songs/43z6scIZU2QcEieMQFAJRG/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:29:02,399 log 10772 21896 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/comments
WARNING 2025-04-13 15:29:02,400 basehttp 10772 21896 "GET /songs/43z6scIZU2QcEieMQFAJRG/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:29:02,753 basehttp 10772 21520 "GET /song/43z6scIZU2QcEieMQFAJRG/ HTTP/1.1" 200 383
INFO 2025-04-13 15:29:03,598 basehttp 10772 21520 "GET /song/43z6scIZU2QcEieMQFAJRG/ HTTP/1.1" 200 383
INFO 2025-04-13 15:29:03,998 basehttp 10772 22016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:29:04,845 basehttp 10772 21536 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:29:04,921 log 10772 22020 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.
ERROR 2025-04-13 15:29:04,936 basehttp 10772 22020 "POST /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:29:05,198 log 10772 20436 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.
ERROR 2025-04-13 15:29:05,212 basehttp 10772 20436 "POST /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:29:05,357 basehttp 10772 22016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:29:05,927 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 3234
INFO 2025-04-13 15:29:05,956 basehttp 10772 21536 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:29:06,402 log 10772 20436 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, play) already exists.
ERROR 2025-04-13 15:29:06,413 basehttp 10772 20436 "POST /songs/43z6scIZU2QcEieMQFAJRG/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:29:08,033 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 3234
INFO 2025-04-13 15:29:16,320 spotify_utils 10772 21536 Getting track for ID: 754kgU5rWscRTfvlsuEwFp
INFO 2025-04-13 15:29:16,908 spotify_utils 10772 21536 Successfully retrieved track: Kiss Me by Sixpence None The Richer
INFO 2025-04-13 15:29:18,411 basehttp 10772 21536 "POST /playlists/2/songs/ HTTP/1.1" 200 280
INFO 2025-04-13 15:29:57,632 basehttp 10772 21536 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:29:58,666 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:29:59,859 basehttp 10772 21536 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:30:00,545 basehttp 10772 21520 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:30:00,696 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:30:01,344 basehttp 10772 21520 "GET /playlists/2/songs/ HTTP/1.1" 200 496
INFO 2025-04-13 15:30:01,493 basehttp 10772 22016 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:30:02,293 basehttp 10772 22016 "GET /playlists/2/songs/ HTTP/1.1" 200 496
INFO 2025-04-13 15:30:15,587 basehttp 10772 22016 "OPTIONS /search-songs/?q=a HTTP/1.1" 200 0
INFO 2025-04-13 15:30:17,367 basehttp 10772 21520 "OPTIONS /search-songs/?q=an HTTP/1.1" 200 0
INFO 2025-04-13 15:30:17,916 basehttp 10772 22016 "GET /search-songs/?q=a HTTP/1.1" 200 1723
INFO 2025-04-13 15:30:19,247 basehttp 10772 21520 "GET /search-songs/?q=an HTTP/1.1" 200 1729
WARNING 2025-04-13 15:30:25,261 log 10772 21520 Not Found: /log-interaction/
WARNING 2025-04-13 15:30:25,264 basehttp 10772 21520 "POST /log-interaction/ HTTP/1.1" 404 179
INFO 2025-04-13 15:30:25,524 basehttp 10772 22016 "OPTIONS /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 0
WARNING 2025-04-13 15:30:25,531 log 10772 21896 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
INFO 2025-04-13 15:30:25,542 basehttp 10772 21536 "GET /song/0eCajpR75pDW0r64U6hP2x HTTP/1.1" 301 0
INFO 2025-04-13 15:30:25,543 basehttp 10772 22016 "OPTIONS /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 0
WARNING 2025-04-13 15:30:25,544 basehttp 10772 21896 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:30:25,552 log 10772 21896 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:30:25,553 basehttp 10772 21896 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:30:26,312 basehttp 10772 22016 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:30:26,321 basehttp 10772 21896 "OPTIONS /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 200 0
INFO 2025-04-13 15:30:26,989 basehttp 10772 22016 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:30:27,071 basehttp 10772 21520 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:30:27,211 spotify_utils 10772 21532 Getting track for ID: 0eCajpR75pDW0r64U6hP2x
INFO 2025-04-13 15:30:27,331 spotify_utils 10772 20436 Getting track for ID: 0eCajpR75pDW0r64U6hP2x
INFO 2025-04-13 15:30:27,520 basehttp 10772 18080 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:30:27,702 spotify_utils 10772 22020 Getting track for ID: 0eCajpR75pDW0r64U6hP2x
INFO 2025-04-13 15:30:27,724 spotify_utils 10772 21532 Successfully retrieved track: Jo Tum Mere Ho by Anuv Jain
INFO 2025-04-13 15:30:27,785 basehttp 10772 21520 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:30:27,904 spotify_utils 10772 20436 Successfully retrieved track: Jo Tum Mere Ho by Anuv Jain
INFO 2025-04-13 15:30:28,133 basehttp 10772 20436 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 200 54
INFO 2025-04-13 15:30:28,139 basehttp 10772 21520 "OPTIONS /songs/0eCajpR75pDW0r64U6hP2x/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 15:30:28,143 log 10772 20436 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/status/
WARNING 2025-04-13 15:30:28,144 basehttp 10772 20436 "GET /songs/0eCajpR75pDW0r64U6hP2x/status/ HTTP/1.1" 404 179
INFO 2025-04-13 15:30:28,250 spotify_utils 10772 22020 Successfully retrieved track: Jo Tum Mere Ho by Anuv Jain
ERROR 2025-04-13 15:30:28,328 log 10772 22020 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 15:30:28,336 basehttp 10772 22020 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:30:28,552 basehttp 10772 18080 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:30:28,754 basehttp 10772 18080 "OPTIONS /songs/0eCajpR75pDW0r64U6hP2x/play/ HTTP/1.1" 200 0
INFO 2025-04-13 15:30:29,592 basehttp 10772 22020 "POST /songs/0eCajpR75pDW0r64U6hP2x/play/ HTTP/1.1" 200 60
INFO 2025-04-13 15:30:30,447 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
INFO 2025-04-13 15:30:32,842 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
INFO 2025-04-13 15:30:35,594 basehttp 10772 18080 "OPTIONS /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 0
INFO 2025-04-13 15:30:37,872 basehttp 10772 21532 "POST /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:30:44,432 basehttp 10772 18080 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:30:44,746 basehttp 10772 21520 "GET /liked-songs/ HTTP/1.1" 200 1177
INFO 2025-04-13 15:30:45,536 basehttp 10772 18080 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:30:45,702 basehttp 10772 21520 "GET /liked-songs/ HTTP/1.1" 200 1177
INFO 2025-04-13 15:30:55,970 basehttp 10772 3024 "GET /liked-songs/ HTTP/1.1" 200 1177
WARNING 2025-04-13 15:31:06,426 log 10772 18080 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:31:06,428 basehttp 10772 18080 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:31:06,432 log 10772 18080 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:31:06,434 basehttp 10772 18080 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:31:07,267 basehttp 10772 21896 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:31:07,579 basehttp 10772 21896 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:31:08,093 basehttp 10772 21520 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:31:08,709 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:31:08,787 log 10772 22020 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.
ERROR 2025-04-13 15:31:08,803 basehttp 10772 22020 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:31:09,016 log 10772 20436 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.
ERROR 2025-04-13 15:31:09,039 basehttp 10772 20436 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:31:09,165 basehttp 10772 21520 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:31:09,811 basehttp 10772 22016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:31:09,875 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
ERROR 2025-04-13 15:31:10,073 log 10772 20436 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.
ERROR 2025-04-13 15:31:10,088 basehttp 10772 20436 "POST /songs/0eCajpR75pDW0r64U6hP2x/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:31:12,114 basehttp 10772 21532 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
INFO 2025-04-13 15:31:24,967 basehttp 10772 22016 "OPTIONS /songs/0eCajpR75pDW0r64U6hP2x/save/ HTTP/1.1" 200 0
INFO 2025-04-13 15:31:27,346 basehttp 10772 21532 "POST /songs/0eCajpR75pDW0r64U6hP2x/save/ HTTP/1.1" 200 74
INFO 2025-04-13 15:32:08,812 basehttp 10772 16432 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:33:08,598 basehttp 10772 17320 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:34:08,712 basehttp 10772 22412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:35:08,618 basehttp 10772 22428 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:35:37,016 autoreload 10772 14100 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 15:35:39,867 autoreload 2112 15668 Watching for file changes with StatReloader
INFO 2025-04-13 15:35:52,652 basehttp 2112 21144 "POST /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 77
WARNING 2025-04-13 15:35:54,122 log 2112 20728 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:35:54,127 basehttp 2112 20728 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:35:54,723 basehttp 2112 19484 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:35:54,822 basehttp 2112 10000 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:35:55,138 basehttp 2112 14196 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:35:55,501 log 2112 596 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.
ERROR 2025-04-13 15:35:55,541 basehttp 2112 596 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:35:56,132 basehttp 2112 21144 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
ERROR 2025-04-13 15:35:57,120 log 2112 21144 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.
ERROR 2025-04-13 15:35:57,135 basehttp 2112 21144 "POST /songs/0eCajpR75pDW0r64U6hP2x/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:35:59,047 basehttp 2112 21144 "POST /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:36:04,638 basehttp 2112 20900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:36:04,942 basehttp 2112 15940 "GET /liked-songs/ HTTP/1.1" 200 1177
INFO 2025-04-13 15:36:06,272 basehttp 2112 20900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:36:06,429 basehttp 2112 15940 "GET /liked-songs/ HTTP/1.1" 200 1177
INFO 2025-04-13 15:37:04,545 basehttp 2112 15940 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:38:05,897 basehttp 2112 21108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:39:04,240 basehttp 2112 16908 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:40:04,969 basehttp 2112 21188 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:42:27,241 basehttp 2112 13944 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:43:10,112 basehttp 2112 19288 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:44:05,016 basehttp 2112 16040 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:45:04,686 basehttp 2112 16040 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:46:03,700 basehttp 2112 16040 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:47:50,571 basehttp 2112 16040 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:48:06,713 basehttp 2112 16040 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:49:03,400 basehttp 2112 20596 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:50:03,707 basehttp 2112 21000 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:51:42,917 basehttp 2112 20716 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 15:51:43,768 log 2112 12088 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:51:43,769 basehttp 2112 12088 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:51:43,771 log 2112 12088 Not Found: /songs/0eCajpR75pDW0r64U6hP2x/comments
WARNING 2025-04-13 15:51:43,784 basehttp 2112 12088 "GET /songs/0eCajpR75pDW0r64U6hP2x/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:51:44,271 basehttp 2112 3712 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:51:44,763 basehttp 2112 3712 "GET /song/0eCajpR75pDW0r64U6hP2x/ HTTP/1.1" 200 358
INFO 2025-04-13 15:51:45,103 basehttp 2112 20716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:51:45,810 basehttp 2112 20696 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:51:45,981 log 2112 3600 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.
ERROR 2025-04-13 15:51:46,029 basehttp 2112 3600 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:51:46,242 log 2112 5736 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, view) already exists.
ERROR 2025-04-13 15:51:46,258 basehttp 2112 5736 "POST /songs/0eCajpR75pDW0r64U6hP2x/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:51:46,328 basehttp 2112 20716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:51:46,990 basehttp 2112 20696 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:51:47,101 basehttp 2112 3856 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
ERROR 2025-04-13 15:51:48,217 log 2112 5736 Internal Server Error: /songs/0eCajpR75pDW0r64U6hP2x/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 133, play) already exists.
ERROR 2025-04-13 15:51:48,234 basehttp 2112 5736 "POST /songs/0eCajpR75pDW0r64U6hP2x/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:51:49,291 basehttp 2112 3856 "GET /api/recommendations/similar/?spotify_id=0eCajpR75pDW0r64U6hP2x HTTP/1.1" 200 2881
WARNING 2025-04-13 15:52:03,708 log 2112 20856 Not Found: /like/0eCajpR75pDW0r64U6hP2x/songs/
WARNING 2025-04-13 15:52:03,709 basehttp 2112 20856 "POST /like/0eCajpR75pDW0r64U6hP2x/songs/ HTTP/1.1" 404 179
INFO 2025-04-13 15:52:40,528 basehttp 2112 20856 "POST /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 77
INFO 2025-04-13 15:52:44,971 basehttp 2112 18020 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:52:51,008 basehttp 2112 20856 "POST /songs/0eCajpR75pDW0r64U6hP2x/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:53:04,745 basehttp 2112 16108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:53:05,349 basehttp 2112 6460 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:53:06,359 basehttp 2112 18868 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:53:06,773 basehttp 2112 16108 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:53:07,015 basehttp 2112 6460 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:53:07,589 basehttp 2112 16108 "GET /playlists/2/songs/ HTTP/1.1" 200 496
INFO 2025-04-13 15:53:07,832 basehttp 2112 6460 "GET /playlists/1/songs/ HTTP/1.1" 200 294
INFO 2025-04-13 15:53:08,623 basehttp 2112 6460 "GET /playlists/2/songs/ HTTP/1.1" 200 496
WARNING 2025-04-13 15:53:10,197 log 2112 16108 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
WARNING 2025-04-13 15:53:10,200 basehttp 2112 16108 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
WARNING 2025-04-13 15:53:10,217 log 2112 6780 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
WARNING 2025-04-13 15:53:10,219 basehttp 2112 6780 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:53:10,575 basehttp 2112 16108 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 15:53:11,095 basehttp 2112 16108 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 15:53:11,698 basehttp 2112 6460 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 15:53:12,109 log 2112 20932 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.
INFO 2025-04-13 15:53:12,140 basehttp 2112 18868 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 15:53:12,147 basehttp 2112 20932 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 15:53:12,468 log 2112 1920 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.
ERROR 2025-04-13 15:53:12,479 basehttp 2112 1920 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 15:53:12,644 basehttp 2112 6460 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:53:13,235 basehttp 2112 16108 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:53:13,244 basehttp 2112 10880 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3234
ERROR 2025-04-13 15:53:14,049 log 2112 1920 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.
ERROR 2025-04-13 15:53:14,057 basehttp 2112 1920 "POST /songs/754kgU5rWscRTfvlsuEwFp/play/ HTTP/1.1" 500 145
INFO 2025-04-13 15:53:15,340 basehttp 2112 10880 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3234
WARNING 2025-04-13 15:53:21,533 log 2112 6780 Not Found: /songs/7JFGm7ptMSB9q8BZMDUEpT/comments
INFO 2025-04-13 15:53:21,542 basehttp 2112 6460 "GET /song/7JFGm7ptMSB9q8BZMDUEpT HTTP/1.1" 301 0
INFO 2025-04-13 15:53:21,542 basehttp 2112 18868 "OPTIONS /api/recommendations/similar/?spotify_id=7JFGm7ptMSB9q8BZMDUEpT HTTP/1.1" 200 0
WARNING 2025-04-13 15:53:21,543 basehttp 2112 6780 "GET /songs/7JFGm7ptMSB9q8BZMDUEpT/comments HTTP/1.1" 404 179
INFO 2025-04-13 15:53:21,804 basehttp 2112 18868 "GET /song/7JFGm7ptMSB9q8BZMDUEpT/ HTTP/1.1" 200 379
INFO 2025-04-13 15:53:21,807 basehttp 2112 18868 "OPTIONS /songs/7JFGm7ptMSB9q8BZMDUEpT/view/ HTTP/1.1" 200 0
INFO 2025-04-13 15:53:22,212 basehttp 2112 16108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:53:22,538 basehttp 2112 600 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 15:53:22,573 basehttp 2112 1920 "POST /songs/7JFGm7ptMSB9q8BZMDUEpT/view/ HTTP/1.1" 200 54
INFO 2025-04-13 15:53:22,578 basehttp 2112 600 "OPTIONS /songs/7JFGm7ptMSB9q8BZMDUEpT/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 15:53:22,583 log 2112 1920 Not Found: /songs/7JFGm7ptMSB9q8BZMDUEpT/status/
WARNING 2025-04-13 15:53:22,584 basehttp 2112 1920 "GET /songs/7JFGm7ptMSB9q8BZMDUEpT/status/ HTTP/1.1" 404 179
INFO 2025-04-13 15:53:23,069 basehttp 2112 600 "OPTIONS /songs/7JFGm7ptMSB9q8BZMDUEpT/play/ HTTP/1.1" 200 0
INFO 2025-04-13 15:53:23,552 basehttp 2112 10880 "GET /api/recommendations/similar/?spotify_id=7JFGm7ptMSB9q8BZMDUEpT HTTP/1.1" 200 3234
INFO 2025-04-13 15:53:23,845 basehttp 2112 1920 "POST /songs/7JFGm7ptMSB9q8BZMDUEpT/play/ HTTP/1.1" 200 60
INFO 2025-04-13 15:53:39,249 basehttp 2112 20856 "POST /songs/7JFGm7ptMSB9q8BZMDUEpT/like/ HTTP/1.1" 200 74
INFO 2025-04-13 15:54:21,962 basehttp 2112 600 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 15:54:22,677 basehttp 2112 600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:55:23,249 basehttp 2112 600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:56:22,695 basehttp 2112 600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:57:22,699 basehttp 2112 600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:58:50,638 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 15:59:50,647 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:00:50,682 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:01:32,837 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:01:33,885 basehttp 2112 12092 "OPTIONS /playlists/ HTTP/1.1" 200 0
WARNING 2025-04-13 16:01:33,904 log 2112 19700 Not Found: /songs/7JFGm7ptMSB9q8BZMDUEpT/comments
WARNING 2025-04-13 16:01:33,907 basehttp 2112 19700 "GET /songs/7JFGm7ptMSB9q8BZMDUEpT/comments HTTP/1.1" 404 179
INFO 2025-04-13 16:01:34,863 basehttp 2112 17220 "GET /song/7JFGm7ptMSB9q8BZMDUEpT/ HTTP/1.1" 200 379
INFO 2025-04-13 16:01:35,809 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:01:36,263 basehttp 2112 12092 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 16:01:36,409 log 2112 18084 Internal Server Error: /songs/7JFGm7ptMSB9q8BZMDUEpT/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 127, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 127, view) already exists.
ERROR 2025-04-13 16:01:36,425 basehttp 2112 18084 "POST /songs/7JFGm7ptMSB9q8BZMDUEpT/view/ HTTP/1.1" 500 145
INFO 2025-04-13 16:01:37,334 basehttp 2112 3604 "GET /api/recommendations/similar/?spotify_id=7JFGm7ptMSB9q8BZMDUEpT HTTP/1.1" 200 3234
ERROR 2025-04-13 16:01:38,107 log 2112 3604 Internal Server Error: /songs/7JFGm7ptMSB9q8BZMDUEpT/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 127, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 127, play) already exists.
ERROR 2025-04-13 16:01:38,124 basehttp 2112 3604 "POST /songs/7JFGm7ptMSB9q8BZMDUEpT/play/ HTTP/1.1" 500 145
WARNING 2025-04-13 16:01:56,646 log 2112 15468 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
WARNING 2025-04-13 16:01:56,654 basehttp 2112 15468 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
INFO 2025-04-13 16:01:57,315 basehttp 2112 19700 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 16:01:58,252 basehttp 2112 12092 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 16:01:58,636 log 2112 18084 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.
INFO 2025-04-13 16:01:58,657 basehttp 2112 17220 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 16:01:58,661 basehttp 2112 18084 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 16:01:59,698 basehttp 2112 3604 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3234
ERROR 2025-04-13 16:02:00,089 log 2112 18084 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.
ERROR 2025-04-13 16:02:00,102 basehttp 2112 18084 "POST /songs/754kgU5rWscRTfvlsuEwFp/play/ HTTP/1.1" 500 145
WARNING 2025-04-13 16:02:05,424 log 2112 12092 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/comments
WARNING 2025-04-13 16:02:05,425 basehttp 2112 12092 "GET /songs/43z6scIZU2QcEieMQFAJRG/comments HTTP/1.1" 404 179
WARNING 2025-04-13 16:02:05,434 log 2112 12092 Not Found: /songs/43z6scIZU2QcEieMQFAJRG/comments
WARNING 2025-04-13 16:02:05,438 basehttp 2112 12092 "GET /songs/43z6scIZU2QcEieMQFAJRG/comments HTTP/1.1" 404 179
INFO 2025-04-13 16:02:06,019 basehttp 2112 15468 "GET /song/43z6scIZU2QcEieMQFAJRG/ HTTP/1.1" 200 383
INFO 2025-04-13 16:02:06,428 basehttp 2112 15468 "GET /song/43z6scIZU2QcEieMQFAJRG/ HTTP/1.1" 200 383
ERROR 2025-04-13 16:02:08,176 log 2112 3604 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.
INFO 2025-04-13 16:02:08,181 basehttp 2112 17220 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 16:02:08,198 basehttp 2112 3604 "POST /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 500 145
INFO 2025-04-13 16:02:08,360 basehttp 2112 19700 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 16:02:08,509 log 2112 9344 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, view) already exists.
ERROR 2025-04-13 16:02:08,523 basehttp 2112 9344 "POST /songs/43z6scIZU2QcEieMQFAJRG/view/ HTTP/1.1" 500 145
INFO 2025-04-13 16:02:08,976 basehttp 2112 17220 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:02:09,283 basehttp 2112 18084 "GET /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 3234
INFO 2025-04-13 16:02:09,352 basehttp 2112 19700 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 16:02:09,727 log 2112 9344 Internal Server Error: /songs/43z6scIZU2QcEieMQFAJRG/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 124, play) already exists.
ERROR 2025-04-13 16:02:09,740 basehttp 2112 9344 "POST /songs/43z6scIZU2QcEieMQFAJRG/play/ HTTP/1.1" 500 145
INFO 2025-04-13 16:02:11,261 basehttp 2112 18084 "GET /api/recommendations/similar/?spotify_id=43z6scIZU2QcEieMQFAJRG HTTP/1.1" 200 3234
WARNING 2025-04-13 16:02:13,474 log 2112 17220 Not Found: /songs/754kgU5rWscRTfvlsuEwFp/comments
WARNING 2025-04-13 16:02:13,481 basehttp 2112 17220 "GET /songs/754kgU5rWscRTfvlsuEwFp/comments HTTP/1.1" 404 179
INFO 2025-04-13 16:02:13,744 basehttp 2112 12092 "GET /song/754kgU5rWscRTfvlsuEwFp/ HTTP/1.1" 200 376
INFO 2025-04-13 16:02:14,157 basehttp 2112 19700 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:02:14,453 basehttp 2112 15468 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 16:02:14,515 log 2112 9344 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, view) already exists.
ERROR 2025-04-13 16:02:14,527 basehttp 2112 9344 "POST /songs/754kgU5rWscRTfvlsuEwFp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 16:02:15,489 basehttp 2112 18084 "GET /api/recommendations/similar/?spotify_id=754kgU5rWscRTfvlsuEwFp HTTP/1.1" 200 3234
ERROR 2025-04-13 16:02:15,843 log 2112 9344 Internal Server Error: /songs/754kgU5rWscRTfvlsuEwFp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 123, play) already exists.
ERROR 2025-04-13 16:02:15,861 basehttp 2112 9344 "POST /songs/754kgU5rWscRTfvlsuEwFp/play/ HTTP/1.1" 500 145
WARNING 2025-04-13 16:02:17,380 log 2112 21060 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:02:17,382 basehttp 2112 21060 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:02:17,396 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:02:17,408 basehttp 2112 17220 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:02:17,451 basehttp 2112 21264 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:02:17,752 basehttp 2112 19700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:02:18,017 basehttp 2112 12092 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
WARNING 2025-04-13 16:02:18,133 log 2112 21060 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:02:18,135 basehttp 2112 21060 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:02:18,149 basehttp 2112 17220 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:02:18,153 basehttp 2112 15468 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:02:18,269 basehttp 2112 21264 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:02:18,819 basehttp 2112 19700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:02:19,183 basehttp 2112 12092 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5931
INFO 2025-04-13 16:02:20,441 basehttp 2112 19700 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 16:02:21,549 basehttp 2112 12092 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6051
INFO 2025-04-13 16:03:18,636 basehttp 2112 12092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:04:18,827 basehttp 2112 12092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:04:33,295 basehttp 2112 15468 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 16:04:33,300 basehttp 2112 21264 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 16:04:33,300 basehttp 2112 17220 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 16:04:33,301 basehttp 2112 19700 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 16:04:33,302 basehttp 2112 15468 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
WARNING 2025-04-13 16:04:34,706 log 2112 17220 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:04:34,710 basehttp 2112 17220 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:04:34,714 basehttp 2112 12092 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:04:34,727 basehttp 2112 19700 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:04:34,958 basehttp 2112 21264 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:04:35,180 basehttp 2112 21060 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:04:35,291 basehttp 2112 15468 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5931
INFO 2025-04-13 16:04:36,448 basehttp 2112 21060 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5945
INFO 2025-04-13 16:05:35,330 basehttp 2112 21060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:06:35,431 basehttp 2112 21060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:07:35,437 basehttp 2112 21060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:14:14,015 basehttp 2112 13536 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:14:35,088 basehttp 2112 18508 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:14:39,892 basehttp 2112 18508 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 16:14:39,894 log 2112 13200 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:14:39,902 basehttp 2112 13200 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:14:39,932 basehttp 2112 9912 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:14:40,011 basehttp 2112 12608 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:14:40,216 basehttp 2112 21884 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:14:40,302 basehttp 2112 15848 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5945
INFO 2025-04-13 16:14:41,417 basehttp 2112 21884 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5945
INFO 2025-04-13 16:15:20,238 basehttp 2112 18508 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,238 basehttp 2112 15848 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,238 basehttp 2112 13200 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,238 basehttp 2112 12608 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,238 basehttp 2112 9912 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,247 basehttp 2112 18508 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 16:15:20,925 basehttp 2112 21884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:15:21,018 basehttp 2112 18508 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 16:15:21,221 basehttp 2112 12608 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:15:21,622 basehttp 2112 21884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:15:21,691 basehttp 2112 9912 "GET /popularity/ HTTP/1.1" 200 9711
INFO 2025-04-13 16:15:21,789 basehttp 2112 13200 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 16:15:22,347 basehttp 2112 12608 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:15:23,670 basehttp 2112 21884 "GET /popularity/ HTTP/1.1" 200 6965
INFO 2025-04-13 16:15:24,862 basehttp 2112 12608 "GET /popularity/ HTTP/1.1" 200 8236
INFO 2025-04-13 16:15:26,201 basehttp 2112 21884 "GET /popularity/ HTTP/1.1" 200 13840
WARNING 2025-04-13 16:16:12,484 log 2112 18508 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:16:12,484 basehttp 2112 18508 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:16:12,491 basehttp 2112 9912 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:16:12,502 basehttp 2112 21884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:16:12,563 basehttp 2112 15848 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:16:12,777 basehttp 2112 12608 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:16:12,903 basehttp 2112 13200 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5931
INFO 2025-04-13 16:16:13,174 basehttp 2112 9912 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
WARNING 2025-04-13 16:16:13,184 log 2112 18508 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:16:13,185 basehttp 2112 18508 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:16:13,195 basehttp 2112 21884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:16:13,326 basehttp 2112 15848 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:16:13,741 basehttp 2112 12608 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:16:14,005 basehttp 2112 13200 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6004
INFO 2025-04-13 16:16:15,117 basehttp 2112 12608 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5945
INFO 2025-04-13 16:16:16,251 basehttp 2112 13200 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 16:17:12,513 basehttp 2112 13200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:18:12,488 basehttp 2112 13200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:19:12,518 basehttp 2112 13200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:20:12,541 basehttp 2112 13200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:21:12,820 basehttp 2112 13200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:48:28,671 basehttp 2112 10732 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:48:41,570 basehttp 2112 18020 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 16:48:41,609 log 2112 2108 Not Found: /recommendations/friends/
WARNING 2025-04-13 16:48:41,610 basehttp 2112 2108 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 16:48:41,648 basehttp 2112 10568 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 16:48:41,712 basehttp 2112 21960 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 16:48:41,899 basehttp 2112 20140 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:48:41,973 basehttp 2112 18516 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 16:48:43,028 basehttp 2112 20140 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5945
INFO 2025-04-13 16:48:45,519 basehttp 2112 20140 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:48:45,593 basehttp 2112 10568 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 16:48:45,821 basehttp 2112 21960 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:48:46,215 basehttp 2112 20140 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:48:46,346 basehttp 2112 2108 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 16:48:46,551 basehttp 2112 18516 "GET /popularity/ HTTP/1.1" 200 12875
INFO 2025-04-13 16:48:46,796 basehttp 2112 21960 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 16:48:47,835 basehttp 2112 2108 "GET /popularity/ HTTP/1.1" 200 13984
INFO 2025-04-13 16:48:49,318 basehttp 2112 21960 "GET /popularity/ HTTP/1.1" 200 13736
INFO 2025-04-13 16:48:50,886 basehttp 2112 2108 "GET /popularity/ HTTP/1.1" 200 13824
INFO 2025-04-13 16:49:45,772 basehttp 2112 23356 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:50:45,660 basehttp 2112 10676 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:51:45,804 basehttp 2112 15744 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:52:45,713 basehttp 2112 10864 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:53:49,766 basehttp 2112 10864 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:54:49,694 basehttp 2112 8136 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:55:49,759 basehttp 2112 18860 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:56:50,877 basehttp 2112 18860 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:57:49,658 basehttp 2112 18860 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:58:49,653 basehttp 2112 18860 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 16:59:49,654 basehttp 2112 18860 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:04:21,287 basehttp 2112 23316 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:04:49,765 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:05:49,634 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:06:49,664 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:07:49,654 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:08:49,661 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:09:49,674 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:10:49,662 basehttp 2112 20592 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:18:58,564 basehttp 2112 14204 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:19:49,696 basehttp 2112 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:20:49,641 basehttp 2112 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:21:49,696 basehttp 2112 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:22:49,691 basehttp 2112 16308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:23:49,742 basehttp 2112 16308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:24:51,528 basehttp 2112 16308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:27:48,747 basehttp 2112 17600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:28:49,664 basehttp 2112 17600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:29:04,721 autoreload 2112 15668 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 17:29:07,243 autoreload 15532 7632 Watching for file changes with StatReloader
INFO 2025-04-13 17:29:39,243 autoreload 15532 7632 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 17:29:40,311 autoreload 22284 10956 Watching for file changes with StatReloader
INFO 2025-04-13 17:29:49,640 basehttp 22284 13940 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:30:49,649 basehttp 22284 2744 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:31:49,661 basehttp 22284 21224 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:32:49,660 basehttp 22284 20420 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:33:49,651 basehttp 22284 20420 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:34:45,679 basehttp 22284 17812 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:35:49,810 basehttp 22284 18104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:36:00,453 autoreload 22284 10956 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 17:36:02,259 autoreload 23372 11496 Watching for file changes with StatReloader
INFO 2025-04-13 17:36:23,008 autoreload 23372 11496 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 17:36:24,054 autoreload 15576 16492 Watching for file changes with StatReloader
INFO 2025-04-13 17:36:49,664 basehttp 15576 16236 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 17:37:40,748 basehttp 15576 16220 "GET /api/artists/4dpARuHxo51G3z768sgnrY/tracks/ HTTP/1.1" 200 2926
INFO 2025-04-13 17:37:49,635 basehttp 15576 14000 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:14:57,889 autoreload 14928 13532 Watching for file changes with StatReloader
INFO 2025-04-13 18:15:04,613 basehttp 14928 20608 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:05,669 basehttp 14928 18888 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 18:15:05,799 basehttp 14928 20608 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:05,808 basehttp 14928 20608 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:05,815 basehttp 14928 21316 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:05,834 basehttp 14928 18656 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:06,562 basehttp 14928 19036 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:06,649 basehttp 14928 17164 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:15:06,934 basehttp 14928 21316 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:07,247 basehttp 14928 19036 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:07,297 basehttp 14928 22756 "GET /popularity/ HTTP/1.1" 200 13460
INFO 2025-04-13 18:15:07,408 basehttp 14928 18656 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:15:07,923 basehttp 14928 21316 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:08,752 basehttp 14928 19036 "GET /popularity/ HTTP/1.1" 200 13865
INFO 2025-04-13 18:15:10,049 basehttp 14928 21316 "GET /popularity/ HTTP/1.1" 200 6944
INFO 2025-04-13 18:15:11,455 basehttp 14928 19036 "GET /popularity/ HTTP/1.1" 200 14175
INFO 2025-04-13 18:15:21,588 basehttp 14928 20824 "OPTIONS /api/recommendations/similar/?spotify_id=2ffwBvpsQhgXyU7zBUOhwP HTTP/1.1" 200 0
WARNING 2025-04-13 18:15:21,595 log 14928 3340 Not Found: /songs/2ffwBvpsQhgXyU7zBUOhwP/comments
INFO 2025-04-13 18:15:21,596 basehttp 14928 13872 "GET /song/2ffwBvpsQhgXyU7zBUOhwP HTTP/1.1" 301 0
WARNING 2025-04-13 18:15:21,596 basehttp 14928 3340 "GET /songs/2ffwBvpsQhgXyU7zBUOhwP/comments HTTP/1.1" 404 179
WARNING 2025-04-13 18:15:21,602 log 14928 3340 Not Found: /songs/2ffwBvpsQhgXyU7zBUOhwP/comments
ERROR 2025-04-13 18:15:21,603 log 14928 20824 Internal Server Error: /song/2ffwBvpsQhgXyU7zBUOhwP/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1130, in get
    song_response = requests.get(song_url, headers=headers)
                    ^^^^^^^^^^^^
AttributeError: 'WSGIRequest' object has no attribute 'get'
INFO 2025-04-13 18:15:21,603 basehttp 14928 20324 "OPTIONS /api/recommendations/similar/?spotify_id=2ffwBvpsQhgXyU7zBUOhwP HTTP/1.1" 200 0
WARNING 2025-04-13 18:15:21,604 basehttp 14928 3340 "GET /songs/2ffwBvpsQhgXyU7zBUOhwP/comments HTTP/1.1" 404 179
ERROR 2025-04-13 18:15:21,618 basehttp 14928 20824 "GET /song/2ffwBvpsQhgXyU7zBUOhwP/ HTTP/1.1" 500 145
ERROR 2025-04-13 18:15:21,620 log 14928 20824 Internal Server Error: /song/2ffwBvpsQhgXyU7zBUOhwP/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1130, in get
    song_response = requests.get(song_url, headers=headers)
                    ^^^^^^^^^^^^
AttributeError: 'WSGIRequest' object has no attribute 'get'
ERROR 2025-04-13 18:15:21,622 basehttp 14928 20824 "GET /song/2ffwBvpsQhgXyU7zBUOhwP/ HTTP/1.1" 500 145
INFO 2025-04-13 18:15:22,262 basehttp 14928 23400 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:22,278 spotify_utils 14928 18392 Getting track for ID: 2ffwBvpsQhgXyU7zBUOhwP
INFO 2025-04-13 18:15:22,556 basehttp 14928 20544 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:22,848 spotify_utils 14928 18392 Successfully retrieved track: Written on the Sky by Max Richter
INFO 2025-04-13 18:15:22,967 basehttp 14928 23400 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:23,638 basehttp 14928 20544 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:25,870 basehttp 14928 18392 "GET /api/recommendations/similar/?spotify_id=2ffwBvpsQhgXyU7zBUOhwP HTTP/1.1" 200 3413
INFO 2025-04-13 18:15:27,947 basehttp 14928 18392 "GET /api/recommendations/similar/?spotify_id=2ffwBvpsQhgXyU7zBUOhwP HTTP/1.1" 200 3413
INFO 2025-04-13 18:15:28,612 basehttp 14928 22164 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:29,350 basehttp 14928 22164 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:30,063 basehttp 14928 22164 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:44,893 basehttp 14928 20212 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:44,894 basehttp 14928 1380 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:44,899 basehttp 14928 20212 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:44,899 basehttp 14928 8244 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:44,909 basehttp 14928 23076 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:44,909 basehttp 14928 22896 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:45,568 basehttp 14928 22844 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:45,672 basehttp 14928 20212 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:15:45,883 basehttp 14928 1380 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:46,277 basehttp 14928 22844 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:46,302 basehttp 14928 8244 "GET /popularity/ HTTP/1.1" 200 6817
INFO 2025-04-13 18:15:46,441 basehttp 14928 20212 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:15:46,871 basehttp 14928 1380 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:47,615 basehttp 14928 8244 "GET /popularity/ HTTP/1.1" 200 13402
INFO 2025-04-13 18:15:48,836 basehttp 14928 8244 "GET /popularity/ HTTP/1.1" 200 13846
INFO 2025-04-13 18:15:50,265 basehttp 14928 18832 "GET /popularity/ HTTP/1.1" 200 9641
INFO 2025-04-13 18:15:56,228 basehttp 14928 8244 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,236 basehttp 14928 8244 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,236 basehttp 14928 20560 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,240 basehttp 14928 8244 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,241 basehttp 14928 20560 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,247 basehttp 14928 8244 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,247 basehttp 14928 14068 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,248 basehttp 14928 20560 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,263 basehttp 14928 22404 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 18:15:56,906 basehttp 14928 18832 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:15:56,937 basehttp 14928 8244 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
WARNING 2025-04-13 18:15:56,948 log 14928 22404 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:15:56,949 basehttp 14928 22404 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:15:57,004 basehttp 14928 20560 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 18:15:57,242 basehttp 14928 3856 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:57,450 basehttp 14928 14068 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6051
INFO 2025-04-13 18:15:57,627 basehttp 14928 18832 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:15:57,681 log 14928 22404 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:15:57,681 basehttp 14928 22404 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:15:57,687 basehttp 14928 8244 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 18:15:57,770 basehttp 14928 20560 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 18:15:58,286 basehttp 14928 3856 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:15:58,625 basehttp 14928 14068 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6004
INFO 2025-04-13 18:15:59,738 basehttp 14928 3856 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5965
INFO 2025-04-13 18:16:00,830 basehttp 14928 14068 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6051
WARNING 2025-04-13 18:16:01,955 log 14928 22404 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
INFO 2025-04-13 18:16:01,956 basehttp 14928 3856 "OPTIONS /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 0
INFO 2025-04-13 18:16:01,956 basehttp 14928 20560 "GET /song/7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 301 0
INFO 2025-04-13 18:16:01,956 basehttp 14928 8244 "OPTIONS /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 0
WARNING 2025-04-13 18:16:01,961 basehttp 14928 22404 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
ERROR 2025-04-13 18:16:01,965 log 14928 8244 Internal Server Error: /song/7qshYIOUFQAGgYfWXg1m9N/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1130, in get
    song_response = requests.get(song_url, headers=headers)
                    ^^^^^^^^^^^^
AttributeError: 'WSGIRequest' object has no attribute 'get'
WARNING 2025-04-13 18:16:01,968 log 14928 22404 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
ERROR 2025-04-13 18:16:01,971 basehttp 14928 8244 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 500 145
WARNING 2025-04-13 18:16:01,972 basehttp 14928 22404 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
ERROR 2025-04-13 18:16:01,974 log 14928 8244 Internal Server Error: /song/7qshYIOUFQAGgYfWXg1m9N/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1130, in get
    song_response = requests.get(song_url, headers=headers)
                    ^^^^^^^^^^^^
AttributeError: 'WSGIRequest' object has no attribute 'get'
ERROR 2025-04-13 18:16:01,978 basehttp 14928 8244 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 500 145
INFO 2025-04-13 18:16:02,626 basehttp 14928 14068 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:16:02,918 basehttp 14928 18832 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:16:03,334 basehttp 14928 14068 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:16:03,918 basehttp 14928 18832 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:16:04,134 basehttp 14928 13068 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
INFO 2025-04-13 18:16:06,207 basehttp 14928 13068 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
INFO 2025-04-13 18:17:03,652 basehttp 14928 8316 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:18:03,685 basehttp 14928 15952 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:18:35,469 autoreload 14928 13532 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 18:18:36,838 autoreload 6884 17420 Watching for file changes with StatReloader
INFO 2025-04-13 18:19:03,693 basehttp 6884 15996 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:19:32,798 basehttp 6884 20512 "GET /song/4cOdK2wGLETKBW3PvgPWqT/ HTTP/1.1" 200 380
INFO 2025-04-13 18:20:06,381 basehttp 6884 100 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-13 18:20:07,183 basehttp 6884 21688 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:20:07,328 basehttp 6884 13732 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:20:07,591 basehttp 6884 2828 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:07,888 basehttp 6884 21688 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:20:07,980 basehttp 6884 8080 "GET /popularity/ HTTP/1.1" 200 14337
INFO 2025-04-13 18:20:08,094 basehttp 6884 13732 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:20:08,568 basehttp 6884 2828 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:09,144 basehttp 6884 21688 "GET /popularity/ HTTP/1.1" 200 6909
INFO 2025-04-13 18:20:10,349 basehttp 6884 2828 "GET /popularity/ HTTP/1.1" 200 6912
INFO 2025-04-13 18:20:11,825 basehttp 6884 21688 "GET /popularity/ HTTP/1.1" 200 6870
INFO 2025-04-13 18:20:30,841 basehttp 6884 20100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:20:30,855 basehttp 6884 20140 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
WARNING 2025-04-13 18:20:30,856 log 6884 21220 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:20:30,862 basehttp 6884 21220 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:20:30,939 basehttp 6884 17200 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 18:20:31,154 basehttp 6884 19708 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:31,309 basehttp 6884 15264 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6013
INFO 2025-04-13 18:20:31,539 basehttp 6884 20100 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:20:31,561 log 6884 21220 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:20:31,562 basehttp 6884 21220 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:20:31,566 basehttp 6884 20140 "GET /history/recent/?limit=4 HTTP/1.1" 200 1519
INFO 2025-04-13 18:20:31,706 basehttp 6884 17200 "GET /history/most-played/ HTTP/1.1" 200 2364
INFO 2025-04-13 18:20:32,175 basehttp 6884 19708 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:32,452 basehttp 6884 15264 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6013
INFO 2025-04-13 18:20:33,530 basehttp 6884 15264 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5932
INFO 2025-04-13 18:20:34,654 basehttp 6884 20892 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6013
WARNING 2025-04-13 18:20:34,983 log 6884 12276 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
WARNING 2025-04-13 18:20:34,984 basehttp 6884 12276 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
WARNING 2025-04-13 18:20:34,987 log 6884 12276 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
WARNING 2025-04-13 18:20:34,988 basehttp 6884 12276 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
INFO 2025-04-13 18:20:35,244 basehttp 6884 13348 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 200 352
INFO 2025-04-13 18:20:35,247 basehttp 6884 12276 "OPTIONS /songs/7qshYIOUFQAGgYfWXg1m9N/view/ HTTP/1.1" 200 0
INFO 2025-04-13 18:20:35,511 basehttp 6884 13348 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 200 352
INFO 2025-04-13 18:20:35,630 basehttp 6884 20892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:20:35,942 basehttp 6884 15264 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:36,046 basehttp 6884 13320 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/view/ HTTP/1.1" 200 54
INFO 2025-04-13 18:20:36,052 basehttp 6884 13348 "OPTIONS /songs/7qshYIOUFQAGgYfWXg1m9N/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 18:20:36,056 log 6884 13320 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/status/
WARNING 2025-04-13 18:20:36,057 basehttp 6884 13320 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/status/ HTTP/1.1" 404 179
ERROR 2025-04-13 18:20:36,252 log 6884 18768 Internal Server Error: /songs/7qshYIOUFQAGgYfWXg1m9N/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.
INFO 2025-04-13 18:20:36,330 basehttp 6884 20892 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 18:20:36,355 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/view/ HTTP/1.1" 500 145
INFO 2025-04-13 18:20:36,940 basehttp 6884 15264 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:20:37,007 basehttp 6884 22052 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
INFO 2025-04-13 18:20:37,325 basehttp 6884 15264 "OPTIONS /songs/7qshYIOUFQAGgYfWXg1m9N/play/ HTTP/1.1" 200 0
INFO 2025-04-13 18:20:38,065 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/play/ HTTP/1.1" 200 60
INFO 2025-04-13 18:20:38,970 basehttp 6884 22052 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
INFO 2025-04-13 18:20:40,143 basehttp 6884 15264 "OPTIONS /songs/7qshYIOUFQAGgYfWXg1m9N/like/ HTTP/1.1" 200 0
INFO 2025-04-13 18:20:40,984 basehttp 6884 22052 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/like/ HTTP/1.1" 200 74
INFO 2025-04-13 18:20:42,913 basehttp 6884 15264 "OPTIONS /songs/7qshYIOUFQAGgYfWXg1m9N/save/ HTTP/1.1" 200 0
INFO 2025-04-13 18:20:43,746 basehttp 6884 22052 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/save/ HTTP/1.1" 200 74
WARNING 2025-04-13 18:20:48,484 log 6884 13348 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
WARNING 2025-04-13 18:20:48,494 basehttp 6884 13348 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
INFO 2025-04-13 18:20:48,766 basehttp 6884 12276 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 200 352
INFO 2025-04-13 18:20:49,139 basehttp 6884 15264 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:20:49,458 basehttp 6884 20892 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 18:20:49,557 log 6884 18768 Internal Server Error: /songs/7qshYIOUFQAGgYfWXg1m9N/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.
ERROR 2025-04-13 18:20:49,569 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/view/ HTTP/1.1" 500 145
INFO 2025-04-13 18:20:50,487 basehttp 6884 22052 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
ERROR 2025-04-13 18:20:50,882 log 6884 18768 Internal Server Error: /songs/7qshYIOUFQAGgYfWXg1m9N/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, play) already exists.
ERROR 2025-04-13 18:20:50,897 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/play/ HTTP/1.1" 500 145
INFO 2025-04-13 18:21:26,896 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/like/ HTTP/1.1" 200 77
INFO 2025-04-13 18:21:28,533 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/save/ HTTP/1.1" 200 77
INFO 2025-04-13 18:21:33,743 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/save/ HTTP/1.1" 200 74
INFO 2025-04-13 18:21:37,452 basehttp 6884 18768 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/like/ HTTP/1.1" 200 74
WARNING 2025-04-13 18:21:42,156 log 6884 15264 Not Found: /songs/7qshYIOUFQAGgYfWXg1m9N/comments
WARNING 2025-04-13 18:21:42,163 basehttp 6884 15264 "GET /songs/7qshYIOUFQAGgYfWXg1m9N/comments HTTP/1.1" 404 179
INFO 2025-04-13 18:21:42,425 basehttp 6884 13348 "GET /song/7qshYIOUFQAGgYfWXg1m9N/ HTTP/1.1" 200 352
INFO 2025-04-13 18:21:42,827 basehttp 6884 20892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:21:43,121 basehttp 6884 12276 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 18:21:43,175 log 6884 22052 Internal Server Error: /songs/7qshYIOUFQAGgYfWXg1m9N/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, view) already exists.
ERROR 2025-04-13 18:21:43,180 basehttp 6884 22052 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/view/ HTTP/1.1" 500 145
INFO 2025-04-13 18:21:44,162 basehttp 6884 18768 "GET /api/recommendations/similar/?spotify_id=7qshYIOUFQAGgYfWXg1m9N HTTP/1.1" 200 3071
ERROR 2025-04-13 18:21:44,575 log 6884 22052 Internal Server Error: /songs/7qshYIOUFQAGgYfWXg1m9N/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 21, play) already exists.
ERROR 2025-04-13 18:21:44,581 basehttp 6884 22052 "POST /songs/7qshYIOUFQAGgYfWXg1m9N/play/ HTTP/1.1" 500 145
INFO 2025-04-13 18:22:42,845 basehttp 6884 12276 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:23:42,825 basehttp 6884 12276 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:23:46,155 log 6884 15264 Not Found: /recommendations/friends/
INFO 2025-04-13 18:23:46,157 basehttp 6884 12276 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:23:46,157 basehttp 6884 15264 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:23:46,176 basehttp 6884 13348 "GET /history/recent/?limit=4 HTTP/1.1" 200 1494
INFO 2025-04-13 18:23:46,249 basehttp 6884 17856 "GET /history/most-played/ HTTP/1.1" 200 2709
INFO 2025-04-13 18:23:46,423 basehttp 6884 20892 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:23:46,596 basehttp 6884 20896 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5964
WARNING 2025-04-13 18:23:46,826 log 6884 15264 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:23:46,827 basehttp 6884 15264 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:23:46,829 basehttp 6884 12276 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:23:46,838 basehttp 6884 13348 "GET /history/recent/?limit=4 HTTP/1.1" 200 1494
INFO 2025-04-13 18:23:47,005 basehttp 6884 17856 "GET /history/most-played/ HTTP/1.1" 200 2709
INFO 2025-04-13 18:23:47,438 basehttp 6884 20892 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:23:47,638 basehttp 6884 20896 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5977
INFO 2025-04-13 18:23:48,732 basehttp 6884 20892 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5974
INFO 2025-04-13 18:23:49,819 basehttp 6884 20896 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5974
INFO 2025-04-13 18:23:52,143 basehttp 6884 20896 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:23:52,159 log 6884 12276 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:23:52,160 basehttp 6884 12276 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:23:52,164 basehttp 6884 13348 "GET /history/recent/?limit=4 HTTP/1.1" 200 1494
INFO 2025-04-13 18:23:52,223 basehttp 6884 15264 "GET /history/most-played/ HTTP/1.1" 200 2709
INFO 2025-04-13 18:23:52,428 basehttp 6884 20892 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:23:52,535 basehttp 6884 17856 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5977
INFO 2025-04-13 18:23:53,592 basehttp 6884 20892 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5977
INFO 2025-04-13 18:23:56,722 basehttp 6884 20892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:23:56,800 basehttp 6884 13348 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:23:57,029 basehttp 6884 15264 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:23:57,180 basehttp 6884 17856 "GET /popularity/ HTTP/1.1" 200 6912
INFO 2025-04-13 18:23:57,401 basehttp 6884 20892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:23:57,566 basehttp 6884 12276 "GET /api/recommendations/trending/ HTTP/1.1" 200 4569
INFO 2025-04-13 18:23:58,006 basehttp 6884 15264 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:23:58,514 basehttp 6884 17856 "GET /popularity/ HTTP/1.1" 200 14162
INFO 2025-04-13 18:23:59,930 basehttp 6884 15264 "GET /popularity/ HTTP/1.1" 200 13773
INFO 2025-04-13 18:24:01,416 basehttp 6884 17856 "GET /popularity/ HTTP/1.1" 200 6804
INFO 2025-04-13 18:24:56,685 basehttp 6884 17856 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:25:56,696 basehttp 6884 17856 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:26:57,658 basehttp 6884 17348 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:27:57,651 basehttp 6884 21876 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:29:49,672 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:30:02,748 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:30:56,729 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:31:56,743 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:32:56,841 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:33:56,720 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:34:56,713 basehttp 6884 10384 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:35:25,554 basehttp 6884 17196 "GET /song/6NOrpcicPUh2eaj8bAD44u HTTP/1.1" 301 0
INFO 2025-04-13 18:35:25,558 basehttp 6884 23384 "OPTIONS /api/recommendations/similar/?spotify_id=6NOrpcicPUh2eaj8bAD44u HTTP/1.1" 200 0
WARNING 2025-04-13 18:35:25,561 log 6884 6460 Not Found: /songs/6NOrpcicPUh2eaj8bAD44u/comments
WARNING 2025-04-13 18:35:25,562 basehttp 6884 6460 "GET /songs/6NOrpcicPUh2eaj8bAD44u/comments HTTP/1.1" 404 179
WARNING 2025-04-13 18:35:25,567 log 6884 6460 Not Found: /songs/6NOrpcicPUh2eaj8bAD44u/comments
WARNING 2025-04-13 18:35:25,580 basehttp 6884 6460 "GET /songs/6NOrpcicPUh2eaj8bAD44u/comments HTTP/1.1" 404 179
INFO 2025-04-13 18:35:25,580 basehttp 6884 16424 "OPTIONS /api/recommendations/similar/?spotify_id=6NOrpcicPUh2eaj8bAD44u HTTP/1.1" 200 0
INFO 2025-04-13 18:35:25,879 basehttp 6884 12000 "GET /song/6NOrpcicPUh2eaj8bAD44u/ HTTP/1.1" 200 365
INFO 2025-04-13 18:35:25,883 basehttp 6884 6460 "OPTIONS /songs/6NOrpcicPUh2eaj8bAD44u/view/ HTTP/1.1" 200 0
INFO 2025-04-13 18:35:26,143 basehttp 6884 12000 "GET /song/6NOrpcicPUh2eaj8bAD44u/ HTTP/1.1" 200 365
INFO 2025-04-13 18:35:26,286 spotify_utils 6884 7936 Getting track for ID: 6NOrpcicPUh2eaj8bAD44u
INFO 2025-04-13 18:35:26,300 basehttp 6884 12252 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:35:26,620 basehttp 6884 22996 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:35:26,639 spotify_utils 6884 19452 Getting track for ID: 6NOrpcicPUh2eaj8bAD44u
INFO 2025-04-13 18:35:26,867 spotify_utils 6884 7936 Successfully retrieved track: Baby (Is it a Crime) by Rema
INFO 2025-04-13 18:35:26,872 spotify_utils 6884 596 Getting track for ID: 6NOrpcicPUh2eaj8bAD44u
INFO 2025-04-13 18:35:27,014 basehttp 6884 12000 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:35:27,244 spotify_utils 6884 19452 Successfully retrieved track: Baby (Is it a Crime) by Rema
INFO 2025-04-13 18:35:27,481 spotify_utils 6884 596 Successfully retrieved track: Baby (Is it a Crime) by Rema
ERROR 2025-04-13 18:35:27,569 log 6884 596 Internal Server Error: /songs/6NOrpcicPUh2eaj8bAD44u/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
INFO 2025-04-13 18:35:27,573 basehttp 6884 19452 "POST /songs/6NOrpcicPUh2eaj8bAD44u/view/ HTTP/1.1" 200 54
INFO 2025-04-13 18:35:27,585 basehttp 6884 12000 "OPTIONS /songs/6NOrpcicPUh2eaj8bAD44u/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 18:35:27,590 log 6884 19452 Not Found: /songs/6NOrpcicPUh2eaj8bAD44u/status/
ERROR 2025-04-13 18:35:27,590 basehttp 6884 596 "POST /songs/6NOrpcicPUh2eaj8bAD44u/view/ HTTP/1.1" 500 145
WARNING 2025-04-13 18:35:27,590 basehttp 6884 19452 "GET /songs/6NOrpcicPUh2eaj8bAD44u/status/ HTTP/1.1" 404 179
INFO 2025-04-13 18:35:27,820 basehttp 6884 22996 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:35:28,254 basehttp 6884 22996 "OPTIONS /songs/6NOrpcicPUh2eaj8bAD44u/play/ HTTP/1.1" 200 0
INFO 2025-04-13 18:35:29,039 basehttp 6884 19452 "POST /songs/6NOrpcicPUh2eaj8bAD44u/play/ HTTP/1.1" 200 60
INFO 2025-04-13 18:35:29,893 basehttp 6884 7936 "GET /api/recommendations/similar/?spotify_id=6NOrpcicPUh2eaj8bAD44u HTTP/1.1" 200 3079
INFO 2025-04-13 18:35:32,181 basehttp 6884 7936 "GET /api/recommendations/similar/?spotify_id=6NOrpcicPUh2eaj8bAD44u HTTP/1.1" 200 3079
INFO 2025-04-13 18:35:33,932 basehttp 6884 22996 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:35:34,024 basehttp 6884 6460 "GET /api/recommendations/trending/ HTTP/1.1" 200 4903
INFO 2025-04-13 18:35:34,228 basehttp 6884 12000 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:35:34,618 basehttp 6884 12252 "GET /popularity/ HTTP/1.1" 200 13836
INFO 2025-04-13 18:35:34,631 basehttp 6884 22996 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:35:34,782 basehttp 6884 6460 "GET /api/recommendations/trending/ HTTP/1.1" 200 4903
INFO 2025-04-13 18:35:35,244 basehttp 6884 12000 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:35:35,905 basehttp 6884 16424 "GET /popularity/ HTTP/1.1" 200 12381
INFO 2025-04-13 18:35:37,291 basehttp 6884 12000 "GET /popularity/ HTTP/1.1" 200 13717
INFO 2025-04-13 18:35:38,665 basehttp 6884 16424 "GET /popularity/ HTTP/1.1" 200 6554
INFO 2025-04-13 18:36:34,013 basehttp 6884 16424 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:37:33,915 basehttp 6884 16424 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:38:34,106 basehttp 6884 16424 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:39:34,365 basehttp 6884 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:40:33,900 basehttp 6884 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:41:28,234 basehttp 6884 19544 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 18:41:28,246 log 6884 19508 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:41:28,248 basehttp 6884 19508 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:41:28,253 basehttp 6884 8580 "GET /history/recent/?limit=4 HTTP/1.1" 200 1515
INFO 2025-04-13 18:41:28,318 basehttp 6884 21780 "GET /history/most-played/ HTTP/1.1" 200 3107
INFO 2025-04-13 18:41:28,567 basehttp 6884 15700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:41:28,648 basehttp 6884 22416 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 18:41:29,035 basehttp 6884 8580 "GET /history/recent/?limit=4 HTTP/1.1" 200 1515
WARNING 2025-04-13 18:41:29,039 log 6884 19508 Not Found: /recommendations/friends/
WARNING 2025-04-13 18:41:29,042 basehttp 6884 19508 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 18:41:29,044 basehttp 6884 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:41:29,122 basehttp 6884 21780 "GET /history/most-played/ HTTP/1.1" 200 3107
INFO 2025-04-13 18:41:29,625 basehttp 6884 15700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:41:29,786 basehttp 6884 22416 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5964
INFO 2025-04-13 18:41:30,240 basehttp 6884 21780 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:41:30,321 basehttp 6884 19508 "GET /api/recommendations/trending/ HTTP/1.1" 200 4903
INFO 2025-04-13 18:41:30,630 basehttp 6884 15700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:41:30,858 basehttp 6884 8580 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6017
INFO 2025-04-13 18:41:30,881 basehttp 6884 19544 "GET /popularity/ HTTP/1.1" 200 13757
INFO 2025-04-13 18:41:30,955 basehttp 6884 21780 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:41:31,082 basehttp 6884 22416 "GET /api/recommendations/trending/ HTTP/1.1" 200 4903
INFO 2025-04-13 18:41:31,594 basehttp 6884 15700 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:41:31,958 basehttp 6884 19508 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5944
INFO 2025-04-13 18:41:32,276 basehttp 6884 19544 "GET /popularity/ HTTP/1.1" 200 13880
INFO 2025-04-13 18:41:33,448 basehttp 6884 19544 "GET /popularity/ HTTP/1.1" 200 7297
INFO 2025-04-13 18:41:34,796 basehttp 6884 19508 "GET /popularity/ HTTP/1.1" 200 13758
INFO 2025-04-13 18:42:30,870 basehttp 6884 19508 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:43:30,276 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:44:30,236 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:45:30,297 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:46:30,268 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:47:30,267 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:48:31,049 basehttp 6884 13368 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:49:49,849 basehttp 6884 19600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:50:49,733 basehttp 6884 11700 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:51:49,719 basehttp 6884 16572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:52:50,401 basehttp 6884 16572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:53:50,298 basehttp 6884 16572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:54:49,826 basehttp 6884 16304 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:55:49,656 basehttp 6884 18960 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:56:49,691 basehttp 6884 18960 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:57:49,734 basehttp 6884 18960 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:58:30,812 basehttp 6884 2116 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:58:51,038 basehttp 6884 21672 "OPTIONS /search-songs/?q=t HTTP/1.1" 200 0
INFO 2025-04-13 18:58:51,190 basehttp 6884 15756 "OPTIONS /search-songs/?q=to HTTP/1.1" 200 0
INFO 2025-04-13 18:58:51,374 basehttp 6884 16492 "OPTIONS /search-songs/?q=tol HTTP/1.1" 200 0
INFO 2025-04-13 18:58:51,597 basehttp 6884 18272 "OPTIONS /search-songs/?q=tola HTTP/1.1" 200 0
INFO 2025-04-13 18:58:51,704 basehttp 6884 2760 "OPTIONS /search-songs/?q=tolai HTTP/1.1" 200 0
INFO 2025-04-13 18:58:51,988 basehttp 6884 23540 "OPTIONS /search-songs/?q=tolai%20 HTTP/1.1" 200 0
INFO 2025-04-13 18:58:52,100 basehttp 6884 21672 "GET /search-songs/?q=t HTTP/1.1" 200 1777
INFO 2025-04-13 18:58:52,258 basehttp 6884 21672 "OPTIONS /search-songs/?q=tolai%20b HTTP/1.1" 200 0
INFO 2025-04-13 18:58:52,304 basehttp 6884 15756 "GET /search-songs/?q=to HTTP/1.1" 200 2054
INFO 2025-04-13 18:58:52,357 basehttp 6884 15756 "OPTIONS /search-songs/?q=tolai%20ba HTTP/1.1" 200 0
INFO 2025-04-13 18:58:52,495 basehttp 6884 16492 "GET /search-songs/?q=tol HTTP/1.1" 200 1962
INFO 2025-04-13 18:58:52,549 basehttp 6884 16492 "OPTIONS /search-songs/?q=tolai%20bas HTTP/1.1" 200 0
INFO 2025-04-13 18:58:52,783 basehttp 6884 18272 "GET /search-songs/?q=tola HTTP/1.1" 200 2479
INFO 2025-04-13 18:58:52,788 basehttp 6884 18272 "OPTIONS /search-songs/?q=tolai%20basc HTTP/1.1" 200 0
INFO 2025-04-13 18:58:52,880 basehttp 6884 2760 "GET /search-songs/?q=tolai HTTP/1.1" 200 2480
INFO 2025-04-13 18:58:53,002 basehttp 6884 2760 "OPTIONS /search-songs/?q=tolai%20basch HTTP/1.1" 200 0
INFO 2025-04-13 18:58:53,242 basehttp 6884 23540 "GET /search-songs/?q=tolai%20 HTTP/1.1" 200 2480
INFO 2025-04-13 18:58:53,245 basehttp 6884 23540 "OPTIONS /search-songs/?q=tolai%20baschu HTTP/1.1" 200 0
INFO 2025-04-13 18:58:53,521 basehttp 6884 21672 "GET /search-songs/?q=tolai%20b HTTP/1.1" 200 2537
INFO 2025-04-13 18:58:53,645 basehttp 6884 15756 "GET /search-songs/?q=tolai%20ba HTTP/1.1" 200 2518
INFO 2025-04-13 18:58:53,655 basehttp 6884 16492 "GET /search-songs/?q=tolai%20bas HTTP/1.1" 200 2495
INFO 2025-04-13 18:58:53,903 basehttp 6884 18272 "GET /search-songs/?q=tolai%20basc HTTP/1.1" 200 2492
INFO 2025-04-13 18:58:54,219 basehttp 6884 2760 "GET /search-songs/?q=tolai%20basch HTTP/1.1" 200 2536
INFO 2025-04-13 18:58:54,336 basehttp 6884 23540 "GET /search-songs/?q=tolai%20baschu HTTP/1.1" 200 2507
INFO 2025-04-13 18:58:57,098 basehttp 6884 23540 "OPTIONS /log-interaction/ HTTP/1.1" 200 0
WARNING 2025-04-13 18:58:57,116 log 6884 23540 Not Found: /log-interaction/
WARNING 2025-04-13 18:58:57,118 basehttp 6884 23540 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-13 18:58:57,731 log 6884 15756 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
INFO 2025-04-13 18:58:57,732 basehttp 6884 2760 "OPTIONS /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 0
INFO 2025-04-13 18:58:57,733 basehttp 6884 18272 "GET /song/1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 301 0
INFO 2025-04-13 18:58:57,733 basehttp 6884 16492 "OPTIONS /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 0
WARNING 2025-04-13 18:58:57,734 basehttp 6884 15756 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-13 18:58:57,742 log 6884 15756 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-13 18:58:57,744 basehttp 6884 15756 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-13 18:58:58,025 basehttp 6884 16492 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-13 18:58:58,029 basehttp 6884 15756 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 0
INFO 2025-04-13 18:58:58,338 basehttp 6884 16492 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-13 18:58:58,389 basehttp 6884 23540 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:58:58,405 spotify_utils 6884 18000 Getting track for ID: 1hKFMb7L1GCGQgOApDIUAp
INFO 2025-04-13 18:58:58,725 basehttp 6884 21672 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:58:58,729 spotify_utils 6884 11544 Getting track for ID: 1hKFMb7L1GCGQgOApDIUAp
INFO 2025-04-13 18:58:58,937 spotify_utils 6884 18000 Successfully retrieved track: Tolai Baschu by Ethos Band
INFO 2025-04-13 18:58:59,099 spotify_utils 6884 5908 Getting track for ID: 1hKFMb7L1GCGQgOApDIUAp
INFO 2025-04-13 18:58:59,131 basehttp 6884 23540 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 18:58:59,330 spotify_utils 6884 11544 Successfully retrieved track: Tolai Baschu by Ethos Band
INFO 2025-04-13 18:58:59,630 basehttp 6884 11544 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
INFO 2025-04-13 18:58:59,636 basehttp 6884 23540 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 18:58:59,643 log 6884 11544 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-13 18:58:59,644 basehttp 6884 11544 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-13 18:58:59,686 spotify_utils 6884 5908 Successfully retrieved track: Tolai Baschu by Ethos Band
ERROR 2025-04-13 18:58:59,771 log 6884 5908 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 18:58:59,788 basehttp 6884 5908 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 18:58:59,865 basehttp 6884 21672 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 18:59:00,488 basehttp 6884 6964 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 0
INFO 2025-04-13 18:59:01,284 basehttp 6884 21596 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-13 18:59:01,824 basehttp 6884 18000 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-13 18:59:04,249 basehttp 6884 18000 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-13 18:59:58,436 basehttp 6884 16308 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:00:58,434 basehttp 6884 23012 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:01:58,446 basehttp 6884 20992 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:02:58,413 basehttp 6884 13108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:04:22,624 basehttp 6884 10900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:04:27,520 basehttp 6884 15936 "OPTIONS /api/recommendations/similar/?spotify_id=1srnQGDZocVzKwURAiK97J HTTP/1.1" 200 0
INFO 2025-04-13 19:04:27,526 basehttp 6884 22700 "GET /song/1srnQGDZocVzKwURAiK97J HTTP/1.1" 301 0
WARNING 2025-04-13 19:04:27,530 log 6884 7912 Not Found: /songs/1srnQGDZocVzKwURAiK97J/comments
WARNING 2025-04-13 19:04:27,548 basehttp 6884 7912 "GET /songs/1srnQGDZocVzKwURAiK97J/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:04:27,863 basehttp 6884 15936 "GET /song/1srnQGDZocVzKwURAiK97J/ HTTP/1.1" 200 342
INFO 2025-04-13 19:04:27,867 basehttp 6884 15936 "OPTIONS /songs/1srnQGDZocVzKwURAiK97J/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:04:28,197 basehttp 6884 10900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:04:28,547 basehttp 6884 21652 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:04:28,631 basehttp 6884 16696 "POST /songs/1srnQGDZocVzKwURAiK97J/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:04:28,634 basehttp 6884 21652 "OPTIONS /songs/1srnQGDZocVzKwURAiK97J/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:04:28,637 log 6884 16696 Not Found: /songs/1srnQGDZocVzKwURAiK97J/status/
WARNING 2025-04-13 19:04:28,637 basehttp 6884 16696 "GET /songs/1srnQGDZocVzKwURAiK97J/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:04:29,430 basehttp 6884 21652 "OPTIONS /songs/1srnQGDZocVzKwURAiK97J/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:04:29,560 basehttp 6884 19020 "GET /api/recommendations/similar/?spotify_id=1srnQGDZocVzKwURAiK97J HTTP/1.1" 200 2878
INFO 2025-04-13 19:04:30,244 basehttp 6884 16696 "POST /songs/1srnQGDZocVzKwURAiK97J/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:05:28,212 basehttp 6884 10644 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:05:29,128 autoreload 6884 17420 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:05:31,342 autoreload 3340 13740 Watching for file changes with StatReloader
INFO 2025-04-13 19:06:28,563 basehttp 3340 21256 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:07:00,882 autoreload 3340 13740 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 19:07:01,878 autoreload 2140 5320 Watching for file changes with StatReloader
INFO 2025-04-13 19:07:27,872 basehttp 2140 21932 "GET /api/recommendations/artists/ HTTP/1.1" 200 78
INFO 2025-04-13 19:07:28,742 basehttp 2140 8440 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:08:28,249 basehttp 2140 15036 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:09:28,215 basehttp 2140 13280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:09:39,194 basehttp 2140 19108 "OPTIONS /api/recommendations/similar/?spotify_id=6oA7e0fohYvsukh8ytkMr0 HTTP/1.1" 200 0
WARNING 2025-04-13 19:09:39,205 log 2140 13760 Not Found: /songs/6oA7e0fohYvsukh8ytkMr0/comments
INFO 2025-04-13 19:09:39,205 basehttp 2140 21752 "GET /song/6oA7e0fohYvsukh8ytkMr0 HTTP/1.1" 301 0
WARNING 2025-04-13 19:09:39,206 basehttp 2140 13760 "GET /songs/6oA7e0fohYvsukh8ytkMr0/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:09:39,790 basehttp 2140 13760 "GET /song/6oA7e0fohYvsukh8ytkMr0/ HTTP/1.1" 200 341
INFO 2025-04-13 19:09:39,795 basehttp 2140 13760 "OPTIONS /songs/6oA7e0fohYvsukh8ytkMr0/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:09:39,936 basehttp 2140 13280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:09:40,266 basehttp 2140 12080 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:09:40,585 basehttp 2140 17052 "POST /songs/6oA7e0fohYvsukh8ytkMr0/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:09:40,588 basehttp 2140 12080 "OPTIONS /songs/6oA7e0fohYvsukh8ytkMr0/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:09:40,589 log 2140 17052 Not Found: /songs/6oA7e0fohYvsukh8ytkMr0/status/
WARNING 2025-04-13 19:09:40,590 basehttp 2140 17052 "GET /songs/6oA7e0fohYvsukh8ytkMr0/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:09:41,327 basehttp 2140 20728 "GET /api/recommendations/similar/?spotify_id=6oA7e0fohYvsukh8ytkMr0 HTTP/1.1" 200 2878
INFO 2025-04-13 19:09:41,880 basehttp 2140 12080 "OPTIONS /songs/6oA7e0fohYvsukh8ytkMr0/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:09:42,682 basehttp 2140 20728 "POST /songs/6oA7e0fohYvsukh8ytkMr0/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:10:13,198 autoreload 2140 5320 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:10:14,688 autoreload 8588 700 Watching for file changes with StatReloader
INFO 2025-04-13 19:10:22,925 basehttp 8588 22784 "GET /api/recommendations/artists/ HTTP/1.1" 200 77
INFO 2025-04-13 19:10:39,880 basehttp 8588 18728 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:11:40,670 basehttp 8588 21200 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:12:40,687 basehttp 8588 500 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:13:40,647 basehttp 8588 500 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:14:49,645 basehttp 8588 500 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 19:15:04,854 log 8588 22568 Not Found: /songs/1srnQGDZocVzKwURAiK97J/comments
WARNING 2025-04-13 19:15:04,856 basehttp 8588 22568 "GET /songs/1srnQGDZocVzKwURAiK97J/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:15:05,433 basehttp 8588 12896 "GET /song/1srnQGDZocVzKwURAiK97J/ HTTP/1.1" 200 342
INFO 2025-04-13 19:15:05,539 basehttp 8588 500 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:15:05,872 basehttp 8588 14128 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 19:15:06,214 log 8588 21884 Internal Server Error: /songs/1srnQGDZocVzKwURAiK97J/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.
ERROR 2025-04-13 19:15:06,236 basehttp 8588 21884 "POST /songs/1srnQGDZocVzKwURAiK97J/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:15:06,951 basehttp 8588 4236 "GET /api/recommendations/similar/?spotify_id=1srnQGDZocVzKwURAiK97J HTTP/1.1" 200 2878
ERROR 2025-04-13 19:15:08,216 log 8588 4236 Internal Server Error: /songs/1srnQGDZocVzKwURAiK97J/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, play) already exists.
ERROR 2025-04-13 19:15:08,220 basehttp 8588 4236 "POST /songs/1srnQGDZocVzKwURAiK97J/play/ HTTP/1.1" 500 145
INFO 2025-04-13 19:16:05,520 basehttp 8588 3572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:17:03,479 autoreload 8588 700 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:17:04,586 autoreload 10864 11440 Watching for file changes with StatReloader
INFO 2025-04-13 19:17:47,189 autoreload 10864 11440 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:17:48,271 autoreload 23412 12740 Watching for file changes with StatReloader
INFO 2025-04-13 19:18:05,584 basehttp 23412 3572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:18:06,733 basehttp 23412 13264 "GET /api/recommendations/artists/ HTTP/1.1" 200 246
INFO 2025-04-13 19:19:05,565 basehttp 23412 11872 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:20:05,577 basehttp 23412 6472 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:20:44,761 autoreload 23412 12740 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:20:45,779 autoreload 16776 23488 Watching for file changes with StatReloader
INFO 2025-04-13 19:21:01,924 basehttp 16776 9236 "GET /api/recommendations/artists/ HTTP/1.1" 200 241
INFO 2025-04-13 19:21:08,145 basehttp 16776 9236 "GET /api/recommendations/artists/ HTTP/1.1" 200 241
INFO 2025-04-13 19:21:49,731 basehttp 16776 1812 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:22:50,872 basehttp 16776 21176 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:23:49,693 basehttp 16776 23492 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:24:31,772 basehttp 16776 7348 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:24:41,097 basehttp 16776 23144 "OPTIONS /api/recommendations/similar/?spotify_id=2imhsF5WUWS9upG7yyOWuu HTTP/1.1" 200 0
WARNING 2025-04-13 19:24:41,105 log 16776 3100 Not Found: /songs/2imhsF5WUWS9upG7yyOWuu/comments
INFO 2025-04-13 19:24:41,106 basehttp 16776 16556 "GET /song/2imhsF5WUWS9upG7yyOWuu HTTP/1.1" 301 0
WARNING 2025-04-13 19:24:41,116 basehttp 16776 3100 "GET /songs/2imhsF5WUWS9upG7yyOWuu/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:24:41,670 basehttp 16776 23144 "GET /song/2imhsF5WUWS9upG7yyOWuu/ HTTP/1.1" 200 341
INFO 2025-04-13 19:24:41,673 basehttp 16776 23144 "OPTIONS /songs/2imhsF5WUWS9upG7yyOWuu/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:24:41,769 basehttp 16776 7348 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:24:42,087 basehttp 16776 18976 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:24:42,461 basehttp 16776 14532 "POST /songs/2imhsF5WUWS9upG7yyOWuu/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:24:42,468 basehttp 16776 18976 "OPTIONS /songs/2imhsF5WUWS9upG7yyOWuu/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:24:42,472 log 16776 14532 Not Found: /songs/2imhsF5WUWS9upG7yyOWuu/status/
WARNING 2025-04-13 19:24:42,473 basehttp 16776 14532 "GET /songs/2imhsF5WUWS9upG7yyOWuu/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:24:43,208 basehttp 16776 22008 "GET /api/recommendations/similar/?spotify_id=2imhsF5WUWS9upG7yyOWuu HTTP/1.1" 200 2878
INFO 2025-04-13 19:24:43,390 basehttp 16776 18976 "OPTIONS /songs/2imhsF5WUWS9upG7yyOWuu/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:24:44,165 basehttp 16776 22008 "POST /songs/2imhsF5WUWS9upG7yyOWuu/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:25:25,977 basehttp 16776 22548 "OPTIONS /search-songs/?q=s HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,243 basehttp 16776 22380 "OPTIONS /search-songs/?q=sa HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,405 basehttp 16776 23296 "OPTIONS /search-songs/?q=sat HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,552 basehttp 16776 21832 "OPTIONS /search-songs/?q=sata HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,736 basehttp 16776 23320 "OPTIONS /search-songs/?q=satay HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,902 basehttp 16776 18436 "OPTIONS /search-songs/?q=sataye HTTP/1.1" 200 0
INFO 2025-04-13 19:25:26,996 basehttp 16776 22548 "GET /search-songs/?q=s HTTP/1.1" 200 2010
INFO 2025-04-13 19:25:27,089 basehttp 16776 22548 "OPTIONS /search-songs/?q=satayer HTTP/1.1" 200 0
INFO 2025-04-13 19:25:27,236 basehttp 16776 22380 "GET /search-songs/?q=sa HTTP/1.1" 200 2004
INFO 2025-04-13 19:25:27,245 basehttp 16776 22380 "OPTIONS /search-songs/?q=satayera HTTP/1.1" 200 0
INFO 2025-04-13 19:25:27,456 basehttp 16776 23296 "GET /search-songs/?q=sat HTTP/1.1" 200 1944
INFO 2025-04-13 19:25:27,458 basehttp 16776 23296 "OPTIONS /search-songs/?q=satayera%20 HTTP/1.1" 200 0
INFO 2025-04-13 19:25:27,585 basehttp 16776 21832 "GET /search-songs/?q=sata HTTP/1.1" 200 1970
INFO 2025-04-13 19:25:27,771 basehttp 16776 23320 "GET /search-songs/?q=satay HTTP/1.1" 200 2499
INFO 2025-04-13 19:25:27,966 basehttp 16776 18436 "GET /search-songs/?q=sataye HTTP/1.1" 200 2503
INFO 2025-04-13 19:25:28,276 basehttp 16776 22548 "GET /search-songs/?q=satayer HTTP/1.1" 200 2431
INFO 2025-04-13 19:25:28,353 basehttp 16776 22380 "GET /search-songs/?q=satayera HTTP/1.1" 200 2464
INFO 2025-04-13 19:25:28,681 basehttp 16776 23296 "GET /search-songs/?q=satayera%20 HTTP/1.1" 200 2464
INFO 2025-04-13 19:25:30,996 basehttp 16776 23296 "OPTIONS /search-songs/?q=satayera%20f HTTP/1.1" 200 0
INFO 2025-04-13 19:25:31,064 basehttp 16776 22380 "OPTIONS /search-songs/?q=satayera%20fa HTTP/1.1" 200 0
INFO 2025-04-13 19:25:31,494 basehttp 16776 22548 "OPTIONS /search-songs/?q=satayera%20fak HTTP/1.1" 200 0
INFO 2025-04-13 19:25:31,573 basehttp 16776 18436 "OPTIONS /search-songs/?q=satayera%20faka HTTP/1.1" 200 0
INFO 2025-04-13 19:25:31,744 basehttp 16776 23320 "OPTIONS /search-songs/?q=satayera%20fakau HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,017 basehttp 16776 21832 "OPTIONS /search-songs/?q=satayera%20fakaun HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,072 basehttp 16776 23296 "GET /search-songs/?q=satayera%20f HTTP/1.1" 200 2460
INFO 2025-04-13 19:25:32,083 basehttp 16776 23296 "OPTIONS /search-songs/?q=satayera%20fakaune HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,128 basehttp 16776 22380 "GET /search-songs/?q=satayera%20fa HTTP/1.1" 200 2469
INFO 2025-04-13 19:25:32,287 basehttp 16776 22380 "OPTIONS /search-songs/?q=satayera%20fakaune%20 HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,566 basehttp 16776 22548 "GET /search-songs/?q=satayera%20fak HTTP/1.1" 200 2475
INFO 2025-04-13 19:25:32,569 basehttp 16776 22548 "OPTIONS /search-songs/?q=satayera%20fakaune%20b HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,673 basehttp 16776 18436 "GET /search-songs/?q=satayera%20faka HTTP/1.1" 200 2440
INFO 2025-04-13 19:25:32,677 basehttp 16776 18436 "OPTIONS /search-songs/?q=satayera%20fakaune%20ba HTTP/1.1" 200 0
INFO 2025-04-13 19:25:32,818 basehttp 16776 23320 "GET /search-songs/?q=satayera%20fakau HTTP/1.1" 200 2479
INFO 2025-04-13 19:25:32,854 basehttp 16776 23320 "OPTIONS /search-songs/?q=satayera%20fakaune%20ban HTTP/1.1" 200 0
INFO 2025-04-13 19:25:33,068 basehttp 16776 21832 "GET /search-songs/?q=satayera%20fakaun HTTP/1.1" 200 2475
INFO 2025-04-13 19:25:33,073 basehttp 16776 21832 "OPTIONS /search-songs/?q=satayera%20fakaune%20bani HTTP/1.1" 200 0
INFO 2025-04-13 19:25:33,214 basehttp 16776 23296 "GET /search-songs/?q=satayera%20fakaune HTTP/1.1" 200 2480
INFO 2025-04-13 19:25:33,243 basehttp 16776 22380 "GET /search-songs/?q=satayera%20fakaune%20 HTTP/1.1" 200 2480
INFO 2025-04-13 19:25:33,759 basehttp 16776 18436 "GET /search-songs/?q=satayera%20fakaune%20ba HTTP/1.1" 200 2439
INFO 2025-04-13 19:25:33,887 basehttp 16776 18436 "OPTIONS /search-songs/?q=satayera%20fakaune%20bani%20 HTTP/1.1" 200 0
INFO 2025-04-13 19:25:33,891 basehttp 16776 22548 "GET /search-songs/?q=satayera%20fakaune%20b HTTP/1.1" 200 2475
INFO 2025-04-13 19:25:33,990 basehttp 16776 23320 "GET /search-songs/?q=satayera%20fakaune%20ban HTTP/1.1" 200 2466
INFO 2025-04-13 19:25:34,236 basehttp 16776 21832 "GET /search-songs/?q=satayera%20fakaune%20bani HTTP/1.1" 200 2482
INFO 2025-04-13 19:25:34,866 basehttp 16776 18436 "GET /search-songs/?q=satayera%20fakaune%20bani%20 HTTP/1.1" 200 2482
WARNING 2025-04-13 19:25:37,104 log 16776 18436 Not Found: /log-interaction/
WARNING 2025-04-13 19:25:37,105 basehttp 16776 18436 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-13 19:25:37,274 log 16776 22548 Not Found: /songs/5GN1D207XKDFHlOxL9n4f5/comments
INFO 2025-04-13 19:25:37,277 basehttp 16776 21832 "OPTIONS /api/recommendations/similar/?spotify_id=5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 200 0
INFO 2025-04-13 19:25:37,277 basehttp 16776 22380 "OPTIONS /api/recommendations/similar/?spotify_id=5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 200 0
INFO 2025-04-13 19:25:37,277 basehttp 16776 23320 "GET /song/5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 301 0
WARNING 2025-04-13 19:25:37,278 basehttp 16776 22548 "GET /songs/5GN1D207XKDFHlOxL9n4f5/comments HTTP/1.1" 404 179
WARNING 2025-04-13 19:25:37,285 log 16776 22548 Not Found: /songs/5GN1D207XKDFHlOxL9n4f5/comments
WARNING 2025-04-13 19:25:37,288 basehttp 16776 22548 "GET /songs/5GN1D207XKDFHlOxL9n4f5/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:25:37,541 basehttp 16776 22380 "GET /song/5GN1D207XKDFHlOxL9n4f5/ HTTP/1.1" 200 351
INFO 2025-04-13 19:25:37,545 basehttp 16776 22548 "OPTIONS /songs/5GN1D207XKDFHlOxL9n4f5/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:25:37,806 basehttp 16776 22380 "GET /song/5GN1D207XKDFHlOxL9n4f5/ HTTP/1.1" 200 351
INFO 2025-04-13 19:25:37,946 basehttp 16776 18436 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:25:37,981 spotify_utils 16776 23340 Getting track for ID: 5GN1D207XKDFHlOxL9n4f5
INFO 2025-04-13 19:25:38,254 spotify_utils 16776 19528 Getting track for ID: 5GN1D207XKDFHlOxL9n4f5
INFO 2025-04-13 19:25:38,259 basehttp 16776 23296 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:25:38,487 spotify_utils 16776 21680 Getting track for ID: 5GN1D207XKDFHlOxL9n4f5
INFO 2025-04-13 19:25:38,491 spotify_utils 16776 23340 Successfully retrieved track: Satayera by GXSOUL, Priti, Binayak
INFO 2025-04-13 19:25:38,638 basehttp 16776 18436 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:25:38,757 spotify_utils 16776 19528 Successfully retrieved track: Satayera by GXSOUL, Priti, Binayak
INFO 2025-04-13 19:25:39,057 basehttp 16776 19528 "POST /songs/5GN1D207XKDFHlOxL9n4f5/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:25:39,060 spotify_utils 16776 21680 Successfully retrieved track: Satayera by GXSOUL, Priti, Binayak
INFO 2025-04-13 19:25:39,065 basehttp 16776 18436 "OPTIONS /songs/5GN1D207XKDFHlOxL9n4f5/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:25:39,069 log 16776 19528 Not Found: /songs/5GN1D207XKDFHlOxL9n4f5/status/
WARNING 2025-04-13 19:25:39,070 basehttp 16776 19528 "GET /songs/5GN1D207XKDFHlOxL9n4f5/status/ HTTP/1.1" 404 179
ERROR 2025-04-13 19:25:39,137 log 16776 21680 Internal Server Error: /songs/5GN1D207XKDFHlOxL9n4f5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 19:25:39,166 basehttp 16776 21680 "POST /songs/5GN1D207XKDFHlOxL9n4f5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:25:39,276 basehttp 16776 23296 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:25:39,772 basehttp 16776 23296 "OPTIONS /songs/5GN1D207XKDFHlOxL9n4f5/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:25:40,531 basehttp 16776 21680 "POST /songs/5GN1D207XKDFHlOxL9n4f5/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:25:41,273 basehttp 16776 23340 "GET /api/recommendations/similar/?spotify_id=5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 200 3039
INFO 2025-04-13 19:25:43,356 basehttp 16776 23340 "GET /api/recommendations/similar/?spotify_id=5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 200 3039
INFO 2025-04-13 19:26:37,954 basehttp 16776 18804 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:26:39,221 autoreload 16776 23488 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:26:40,743 autoreload 16636 7936 Watching for file changes with StatReloader
INFO 2025-04-13 19:27:22,880 basehttp 16636 12740 "GET /api/recommendations/artists/ HTTP/1.1" 200 1657
INFO 2025-04-13 19:27:37,941 basehttp 16636 16460 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:27:57,425 basehttp 16636 12740 "GET /api/recommendations/artists/ HTTP/1.1" 200 1657
INFO 2025-04-13 19:28:37,946 basehttp 16636 4408 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:29:37,944 basehttp 16636 4408 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:30:48,376 basehttp 16636 4408 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:30:53,984 basehttp 16636 23112 "OPTIONS /api/recommendations/similar/?spotify_id=1qA9qskyfKjjxS5YBM4A0w HTTP/1.1" 200 0
WARNING 2025-04-13 19:30:53,998 log 16636 18412 Not Found: /songs/1qA9qskyfKjjxS5YBM4A0w/comments
INFO 2025-04-13 19:30:53,999 basehttp 16636 11656 "GET /song/1qA9qskyfKjjxS5YBM4A0w HTTP/1.1" 301 0
WARNING 2025-04-13 19:30:53,999 basehttp 16636 18412 "GET /songs/1qA9qskyfKjjxS5YBM4A0w/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:30:54,290 basehttp 16636 18412 "GET /song/1qA9qskyfKjjxS5YBM4A0w/ HTTP/1.1" 200 377
INFO 2025-04-13 19:30:54,294 basehttp 16636 18412 "OPTIONS /songs/1qA9qskyfKjjxS5YBM4A0w/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:30:54,634 basehttp 16636 4408 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:30:54,991 basehttp 16636 23532 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:30:55,019 basehttp 16636 22372 "POST /songs/1qA9qskyfKjjxS5YBM4A0w/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:30:55,022 basehttp 16636 23532 "OPTIONS /songs/1qA9qskyfKjjxS5YBM4A0w/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:30:55,024 log 16636 22372 Not Found: /songs/1qA9qskyfKjjxS5YBM4A0w/status/
WARNING 2025-04-13 19:30:55,025 basehttp 16636 22372 "GET /songs/1qA9qskyfKjjxS5YBM4A0w/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:30:56,178 basehttp 16636 16904 "GET /api/recommendations/similar/?spotify_id=1qA9qskyfKjjxS5YBM4A0w HTTP/1.1" 200 3039
INFO 2025-04-13 19:30:56,238 basehttp 16636 23532 "OPTIONS /songs/1qA9qskyfKjjxS5YBM4A0w/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:30:57,008 basehttp 16636 16904 "POST /songs/1qA9qskyfKjjxS5YBM4A0w/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:31:52,324 autoreload 16636 7936 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:31:53,645 autoreload 22396 2116 Watching for file changes with StatReloader
INFO 2025-04-13 19:32:54,670 basehttp 22396 6484 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:33:35,628 basehttp 22396 18844 "GET /api/artists/3WrFJ7ztbogyGnTHbHJFl2/tracks/ HTTP/1.1" 200 152891
INFO 2025-04-13 19:33:54,663 basehttp 22396 9344 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:34:23,689 basehttp 22396 5060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:34:24,400 basehttp 22396 5060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:34:54,723 basehttp 22396 5060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:35:30,303 basehttp 22396 10104 "OPTIONS /api/recommendations/similar/?spotify_id=44ZRdPlGh8ZIyDNgBpP9w5 HTTP/1.1" 200 0
WARNING 2025-04-13 19:35:30,313 log 22396 12080 Not Found: /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments
INFO 2025-04-13 19:35:30,313 basehttp 22396 7452 "GET /song/44ZRdPlGh8ZIyDNgBpP9w5 HTTP/1.1" 301 0
WARNING 2025-04-13 19:35:30,316 basehttp 22396 12080 "GET /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:35:30,610 basehttp 22396 10104 "GET /song/44ZRdPlGh8ZIyDNgBpP9w5/ HTTP/1.1" 200 352
INFO 2025-04-13 19:35:30,613 basehttp 22396 10104 "OPTIONS /songs/44ZRdPlGh8ZIyDNgBpP9w5/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:35:30,973 basehttp 22396 5060 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:35:31,341 basehttp 22396 19968 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:35:31,416 basehttp 22396 21016 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:35:31,420 basehttp 22396 19968 "OPTIONS /songs/44ZRdPlGh8ZIyDNgBpP9w5/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:35:31,423 log 22396 21016 Not Found: /songs/44ZRdPlGh8ZIyDNgBpP9w5/status/
WARNING 2025-04-13 19:35:31,424 basehttp 22396 21016 "GET /songs/44ZRdPlGh8ZIyDNgBpP9w5/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:35:32,188 basehttp 22396 19968 "OPTIONS /songs/44ZRdPlGh8ZIyDNgBpP9w5/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:35:32,486 basehttp 22396 18968 "GET /api/recommendations/similar/?spotify_id=44ZRdPlGh8ZIyDNgBpP9w5 HTTP/1.1" 200 3039
INFO 2025-04-13 19:35:32,929 basehttp 22396 21016 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:37:09,156 autoreload 18452 21008 Watching for file changes with StatReloader
INFO 2025-04-13 19:37:32,326 basehttp 18452 16604 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:37:53,212 basehttp 18452 13168 "OPTIONS /songs/44ZRdPlGh8ZIyDNgBpP9w5/like/ HTTP/1.1" 200 0
INFO 2025-04-13 19:37:56,010 basehttp 18452 7112 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/like/ HTTP/1.1" 200 74
INFO 2025-04-13 19:37:58,021 basehttp 18452 13168 "OPTIONS /songs/44ZRdPlGh8ZIyDNgBpP9w5/save/ HTTP/1.1" 200 0
INFO 2025-04-13 19:38:00,758 basehttp 18452 7112 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/like/ HTTP/1.1" 200 77
INFO 2025-04-13 19:38:03,467 basehttp 18452 16932 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/save/ HTTP/1.1" 200 74
INFO 2025-04-13 19:38:31,147 basehttp 18452 21212 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:39:31,000 basehttp 18452 22456 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 19:40:27,053 log 18452 20808 Not Found: /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments
WARNING 2025-04-13 19:40:27,060 basehttp 18452 20808 "GET /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:40:27,596 basehttp 18452 22828 "GET /song/44ZRdPlGh8ZIyDNgBpP9w5/ HTTP/1.1" 200 352
INFO 2025-04-13 19:40:27,719 basehttp 18452 22456 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:40:28,032 basehttp 18452 204 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 19:40:28,384 log 18452 21064 Internal Server Error: /songs/44ZRdPlGh8ZIyDNgBpP9w5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, view) already exists.
ERROR 2025-04-13 19:40:28,433 basehttp 18452 21064 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:40:29,147 basehttp 18452 14100 "GET /api/recommendations/similar/?spotify_id=44ZRdPlGh8ZIyDNgBpP9w5 HTTP/1.1" 200 3039
ERROR 2025-04-13 19:40:29,907 log 18452 21064 Internal Server Error: /songs/44ZRdPlGh8ZIyDNgBpP9w5/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, play) already exists.
ERROR 2025-04-13 19:40:29,912 basehttp 18452 21064 "POST /songs/44ZRdPlGh8ZIyDNgBpP9w5/play/ HTTP/1.1" 500 145
INFO 2025-04-13 19:40:36,712 basehttp 18452 22456 "OPTIONS /api/recommendations/similar/?spotify_id=4Px5yA9U4XPcq1y0mvDfB6 HTTP/1.1" 200 0
INFO 2025-04-13 19:40:36,712 basehttp 18452 22828 "GET /song/4Px5yA9U4XPcq1y0mvDfB6 HTTP/1.1" 301 0
WARNING 2025-04-13 19:40:36,715 log 18452 20808 Not Found: /songs/4Px5yA9U4XPcq1y0mvDfB6/comments
WARNING 2025-04-13 19:40:36,725 basehttp 18452 20808 "GET /songs/4Px5yA9U4XPcq1y0mvDfB6/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:40:37,004 basehttp 18452 22456 "GET /song/4Px5yA9U4XPcq1y0mvDfB6/ HTTP/1.1" 200 355
INFO 2025-04-13 19:40:37,006 basehttp 18452 22456 "OPTIONS /songs/4Px5yA9U4XPcq1y0mvDfB6/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:40:37,437 basehttp 18452 204 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:40:37,743 basehttp 18452 17076 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:40:37,815 basehttp 18452 14100 "POST /songs/4Px5yA9U4XPcq1y0mvDfB6/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:40:37,821 basehttp 18452 17076 "OPTIONS /songs/4Px5yA9U4XPcq1y0mvDfB6/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:40:37,825 log 18452 14100 Not Found: /songs/4Px5yA9U4XPcq1y0mvDfB6/status/
WARNING 2025-04-13 19:40:37,826 basehttp 18452 14100 "GET /songs/4Px5yA9U4XPcq1y0mvDfB6/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:40:38,246 basehttp 18452 17076 "OPTIONS /songs/4Px5yA9U4XPcq1y0mvDfB6/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:40:38,788 basehttp 18452 21064 "GET /api/recommendations/similar/?spotify_id=4Px5yA9U4XPcq1y0mvDfB6 HTTP/1.1" 200 3039
INFO 2025-04-13 19:40:38,990 basehttp 18452 14100 "POST /songs/4Px5yA9U4XPcq1y0mvDfB6/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:41:21,257 basehttp 18452 14124 "OPTIONS /search-songs/?q=b HTTP/1.1" 200 0
INFO 2025-04-13 19:41:21,477 basehttp 18452 23396 "OPTIONS /search-songs/?q=bh HTTP/1.1" 200 0
INFO 2025-04-13 19:41:21,652 basehttp 18452 22764 "OPTIONS /search-songs/?q=bha HTTP/1.1" 200 0
INFO 2025-04-13 19:41:21,824 basehttp 18452 19280 "OPTIONS /search-songs/?q=bhan HTTP/1.1" 200 0
INFO 2025-04-13 19:41:21,984 basehttp 18452 15572 "OPTIONS /search-songs/?q=bhana HTTP/1.1" 200 0
INFO 2025-04-13 19:41:22,209 basehttp 18452 10332 "OPTIONS /search-songs/?q=bhanai HTTP/1.1" 200 0
INFO 2025-04-13 19:41:22,343 basehttp 18452 14124 "GET /search-songs/?q=b HTTP/1.1" 200 1716
INFO 2025-04-13 19:41:22,633 basehttp 18452 23396 "GET /search-songs/?q=bh HTTP/1.1" 200 2016
INFO 2025-04-13 19:41:22,766 basehttp 18452 22764 "GET /search-songs/?q=bha HTTP/1.1" 200 1976
INFO 2025-04-13 19:41:22,844 basehttp 18452 19280 "GET /search-songs/?q=bhan HTTP/1.1" 200 2008
INFO 2025-04-13 19:41:23,012 basehttp 18452 15572 "GET /search-songs/?q=bhana HTTP/1.1" 200 2445
INFO 2025-04-13 19:41:23,269 basehttp 18452 10332 "GET /search-songs/?q=bhanai HTTP/1.1" 200 2652
WARNING 2025-04-13 19:41:25,312 log 18452 10332 Not Found: /log-interaction/
WARNING 2025-04-13 19:41:25,313 basehttp 18452 10332 "POST /log-interaction/ HTTP/1.1" 404 179
INFO 2025-04-13 19:41:25,519 basehttp 18452 15572 "OPTIONS /api/recommendations/similar/?spotify_id=0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 200 0
WARNING 2025-04-13 19:41:25,524 log 18452 22764 Not Found: /songs/0KqEwy3JfnY6ePwdXtCAfz/comments
INFO 2025-04-13 19:41:25,527 basehttp 18452 23396 "OPTIONS /api/recommendations/similar/?spotify_id=0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 200 0
INFO 2025-04-13 19:41:25,527 basehttp 18452 19280 "GET /song/0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 301 0
WARNING 2025-04-13 19:41:25,531 basehttp 18452 22764 "GET /songs/0KqEwy3JfnY6ePwdXtCAfz/comments HTTP/1.1" 404 179
WARNING 2025-04-13 19:41:25,535 log 18452 22764 Not Found: /songs/0KqEwy3JfnY6ePwdXtCAfz/comments
WARNING 2025-04-13 19:41:25,537 basehttp 18452 22764 "GET /songs/0KqEwy3JfnY6ePwdXtCAfz/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:41:25,808 basehttp 18452 23396 "GET /song/0KqEwy3JfnY6ePwdXtCAfz/ HTTP/1.1" 200 351
INFO 2025-04-13 19:41:25,812 basehttp 18452 22764 "OPTIONS /songs/0KqEwy3JfnY6ePwdXtCAfz/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:41:26,077 basehttp 18452 23396 "GET /song/0KqEwy3JfnY6ePwdXtCAfz/ HTTP/1.1" 200 351
INFO 2025-04-13 19:41:26,182 basehttp 18452 10332 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:41:26,228 spotify_utils 18452 9116 Getting track for ID: 0KqEwy3JfnY6ePwdXtCAfz
INFO 2025-04-13 19:41:26,488 spotify_utils 18452 19292 Getting track for ID: 0KqEwy3JfnY6ePwdXtCAfz
INFO 2025-04-13 19:41:26,517 basehttp 18452 15572 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:41:26,758 spotify_utils 18452 20240 Getting track for ID: 0KqEwy3JfnY6ePwdXtCAfz
INFO 2025-04-13 19:41:26,800 spotify_utils 18452 9116 Successfully retrieved track: Bhanai by Tribal Rain
INFO 2025-04-13 19:41:26,882 basehttp 18452 10332 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:41:27,014 spotify_utils 18452 19292 Successfully retrieved track: Bhanai by Tribal Rain
INFO 2025-04-13 19:41:27,326 basehttp 18452 19292 "POST /songs/0KqEwy3JfnY6ePwdXtCAfz/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:41:27,329 basehttp 18452 10332 "OPTIONS /songs/0KqEwy3JfnY6ePwdXtCAfz/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:41:27,331 log 18452 19292 Not Found: /songs/0KqEwy3JfnY6ePwdXtCAfz/status/
WARNING 2025-04-13 19:41:27,332 basehttp 18452 19292 "GET /songs/0KqEwy3JfnY6ePwdXtCAfz/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:41:27,363 spotify_utils 18452 20240 Successfully retrieved track: Bhanai by Tribal Rain
ERROR 2025-04-13 19:41:27,438 log 18452 20240 Internal Server Error: /songs/0KqEwy3JfnY6ePwdXtCAfz/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 19:41:27,442 basehttp 18452 20240 "POST /songs/0KqEwy3JfnY6ePwdXtCAfz/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:41:27,603 basehttp 18452 15572 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:41:27,972 basehttp 18452 15572 "OPTIONS /songs/0KqEwy3JfnY6ePwdXtCAfz/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:41:28,705 basehttp 18452 20240 "POST /songs/0KqEwy3JfnY6ePwdXtCAfz/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:41:29,428 basehttp 18452 9116 "GET /api/recommendations/similar/?spotify_id=0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 200 2908
INFO 2025-04-13 19:41:31,482 basehttp 18452 9116 "GET /api/recommendations/similar/?spotify_id=0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 200 2908
INFO 2025-04-13 19:42:26,484 basehttp 18452 18656 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:43:26,171 basehttp 18452 22204 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:44:29,518 basehttp 18452 23412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:45:26,209 basehttp 18452 23412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:45:33,808 basehttp 18452 2960 "OPTIONS /api/recommendations/similar/?spotify_id=59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 200 0
INFO 2025-04-13 19:45:33,811 basehttp 18452 16060 "GET /song/59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 301 0
WARNING 2025-04-13 19:45:33,813 log 18452 21896 Not Found: /songs/59P5MoE5SawsaMpBVHhj6o/comments
WARNING 2025-04-13 19:45:33,821 basehttp 18452 21896 "GET /songs/59P5MoE5SawsaMpBVHhj6o/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:45:34,091 basehttp 18452 2960 "GET /song/59P5MoE5SawsaMpBVHhj6o/ HTTP/1.1" 200 359
INFO 2025-04-13 19:45:34,094 basehttp 18452 2960 "OPTIONS /songs/59P5MoE5SawsaMpBVHhj6o/view/ HTTP/1.1" 200 0
INFO 2025-04-13 19:45:34,498 basehttp 18452 23412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:45:34,834 basehttp 18452 5016 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 19:45:34,879 basehttp 18452 21252 "POST /songs/59P5MoE5SawsaMpBVHhj6o/view/ HTTP/1.1" 200 54
INFO 2025-04-13 19:45:34,883 basehttp 18452 5016 "OPTIONS /songs/59P5MoE5SawsaMpBVHhj6o/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 19:45:34,885 log 18452 21252 Not Found: /songs/59P5MoE5SawsaMpBVHhj6o/status/
WARNING 2025-04-13 19:45:34,886 basehttp 18452 21252 "GET /songs/59P5MoE5SawsaMpBVHhj6o/status/ HTTP/1.1" 404 179
INFO 2025-04-13 19:45:35,505 basehttp 18452 5016 "OPTIONS /songs/59P5MoE5SawsaMpBVHhj6o/play/ HTTP/1.1" 200 0
INFO 2025-04-13 19:45:35,879 basehttp 18452 22980 "GET /api/recommendations/similar/?spotify_id=59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 200 2908
INFO 2025-04-13 19:45:36,315 basehttp 18452 21252 "POST /songs/59P5MoE5SawsaMpBVHhj6o/play/ HTTP/1.1" 200 60
INFO 2025-04-13 19:46:34,520 basehttp 18452 5016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:47:34,487 basehttp 18452 5016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:48:34,473 basehttp 18452 5016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:49:34,591 basehttp 18452 17804 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:50:48,046 autoreload 18452 21008 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:50:50,388 autoreload 19588 9804 Watching for file changes with StatReloader
INFO 2025-04-13 19:51:34,785 autoreload 19588 9804 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 19:51:35,667 autoreload 10652 19352 Watching for file changes with StatReloader
INFO 2025-04-13 19:51:49,683 basehttp 10652 19572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:52:49,770 basehttp 10652 9572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:53:49,640 basehttp 10652 11212 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:54:41,849 autoreload 10652 19352 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 19:54:42,934 autoreload 13216 18084 Watching for file changes with StatReloader
INFO 2025-04-13 19:54:46,946 basehttp 13216 22324 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:54:48,082 basehttp 13216 22324 "OPTIONS /songs/59P5MoE5SawsaMpBVHhj6o/like/ HTTP/1.1" 200 0
INFO 2025-04-13 19:54:49,226 basehttp 13216 9992 "POST /songs/59P5MoE5SawsaMpBVHhj6o/like/ HTTP/1.1" 200 74
WARNING 2025-04-13 19:54:52,739 log 13216 14112 Not Found: /songs/59P5MoE5SawsaMpBVHhj6o/comments
WARNING 2025-04-13 19:54:52,740 basehttp 13216 14112 "GET /songs/59P5MoE5SawsaMpBVHhj6o/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:54:53,791 basehttp 13216 21208 "GET /song/59P5MoE5SawsaMpBVHhj6o/ HTTP/1.1" 200 359
INFO 2025-04-13 19:54:54,046 basehttp 13216 22324 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:54:54,713 basehttp 13216 15088 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 19:54:55,676 log 13216 19360 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.
ERROR 2025-04-13 19:54:55,716 basehttp 13216 19360 "POST /songs/59P5MoE5SawsaMpBVHhj6o/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:54:56,410 basehttp 13216 9992 "GET /api/recommendations/similar/?spotify_id=59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 200 2908
ERROR 2025-04-13 19:55:00,239 log 13216 9992 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.
ERROR 2025-04-13 19:55:00,252 basehttp 13216 9992 "POST /songs/59P5MoE5SawsaMpBVHhj6o/play/ HTTP/1.1" 500 145
INFO 2025-04-13 19:55:01,777 basehttp 13216 19360 "POST /songs/59P5MoE5SawsaMpBVHhj6o/like/ HTTP/1.1" 200 77
INFO 2025-04-13 19:55:04,719 basehttp 13216 15088 "OPTIONS /songs/59P5MoE5SawsaMpBVHhj6o/save/ HTTP/1.1" 200 0
INFO 2025-04-13 19:55:05,812 basehttp 13216 19360 "POST /songs/59P5MoE5SawsaMpBVHhj6o/save/ HTTP/1.1" 200 74
WARNING 2025-04-13 19:55:08,008 log 13216 22324 Not Found: /songs/59P5MoE5SawsaMpBVHhj6o/comments
WARNING 2025-04-13 19:55:08,013 basehttp 13216 22324 "GET /songs/59P5MoE5SawsaMpBVHhj6o/comments HTTP/1.1" 404 179
INFO 2025-04-13 19:55:08,964 basehttp 13216 14112 "GET /song/59P5MoE5SawsaMpBVHhj6o/ HTTP/1.1" 200 359
INFO 2025-04-13 19:55:11,405 basehttp 13216 15088 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:55:12,816 basehttp 13216 21208 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 19:55:15,259 log 13216 9992 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.
ERROR 2025-04-13 19:55:15,272 basehttp 13216 9992 "POST /songs/59P5MoE5SawsaMpBVHhj6o/view/ HTTP/1.1" 500 145
INFO 2025-04-13 19:55:15,550 basehttp 13216 19360 "GET /api/recommendations/similar/?spotify_id=59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 200 2908
ERROR 2025-04-13 19:55:17,641 log 13216 19360 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.
ERROR 2025-04-13 19:55:17,647 basehttp 13216 19360 "POST /songs/59P5MoE5SawsaMpBVHhj6o/play/ HTTP/1.1" 500 145
INFO 2025-04-13 19:55:19,571 basehttp 13216 19360 "POST /songs/59P5MoE5SawsaMpBVHhj6o/like/ HTTP/1.1" 200 74
INFO 2025-04-13 19:56:10,549 basehttp 13216 21208 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:57:08,701 basehttp 13216 16836 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:58:09,782 basehttp 13216 9616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 19:59:08,703 basehttp 13216 20100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:00:08,674 basehttp 13216 20100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:01:09,206 basehttp 13216 20100 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:01:43,196 log 13216 11540 Method Not Allowed: /songs/3QiwPPktTczwleIy9jUMpS/view/
WARNING 2025-04-13 20:01:43,197 basehttp 13216 11540 "GET /songs/3QiwPPktTczwleIy9jUMpS/view/ HTTP/1.1" 405 40
INFO 2025-04-13 20:01:50,087 spotify_utils 13216 11540 Getting track for ID: 3QiwPPktTczwleIy9jUMpS
INFO 2025-04-13 20:01:50,717 spotify_utils 13216 11540 Successfully retrieved track: Roll Over Beethoven - Live / Remastered by The Beatles
INFO 2025-04-13 20:01:50,972 basehttp 13216 11540 "POST /songs/3QiwPPktTczwleIy9jUMpS/view/ HTTP/1.1" 200 54
INFO 2025-04-13 20:02:09,688 basehttp 13216 20100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:02:36,959 basehttp 13216 11540 "POST /songs/3QiwPPktTczwleIy9jUMpS/like/ HTTP/1.1" 200 74
INFO 2025-04-13 20:02:45,935 basehttp 13216 11540 "POST /songs/3QiwPPktTczwleIy9jUMpS/play/ HTTP/1.1" 200 60
WARNING 2025-04-13 20:02:55,224 log 13216 11540 Not Found: /songs/3QiwPPktTczwleIy9jUMpS/saved/
WARNING 2025-04-13 20:02:55,225 basehttp 13216 11540 "POST /songs/3QiwPPktTczwleIy9jUMpS/saved/ HTTP/1.1" 404 179
INFO 2025-04-13 20:03:15,912 basehttp 13216 20100 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:03:29,844 log 13216 11540 Not Found: /songs/3QiwPPktTczwleIy9jUMpS/saved/
WARNING 2025-04-13 20:03:29,845 basehttp 13216 11540 "POST /songs/3QiwPPktTczwleIy9jUMpS/saved/ HTTP/1.1" 404 179
INFO 2025-04-13 20:04:09,680 basehttp 13216 23104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:04:57,864 autoreload 13216 18084 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 20:04:59,897 autoreload 2764 20436 Watching for file changes with StatReloader
INFO 2025-04-13 20:05:07,885 autoreload 2764 20436 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-13 20:05:08,905 autoreload 15888 22680 Watching for file changes with StatReloader
INFO 2025-04-13 20:05:21,613 autoreload 15888 22680 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-13 20:05:22,778 autoreload 22248 1160 Watching for file changes with StatReloader
INFO 2025-04-13 20:05:49,754 basehttp 22248 1584 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:06:07,675 basehttp 22248 18180 "POST /songs/3QiwPPktTczwleIy9jUMpS/like/ HTTP/1.1" 200 77
INFO 2025-04-13 20:06:49,747 basehttp 22248 21988 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:07,140 basehttp 22248 18180 "POST /songs/3QiwPPktTczwleIy9jUMpS/save/ HTTP/1.1" 200 74
INFO 2025-04-13 20:07:34,003 basehttp 22248 16056 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:07:37,835 log 22248 23456 Not Found: /songs/59P5MoE5SawsaMpBVHhj6o/comments
WARNING 2025-04-13 20:07:37,842 basehttp 22248 23456 "GET /songs/59P5MoE5SawsaMpBVHhj6o/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:38,351 basehttp 22248 18224 "GET /song/59P5MoE5SawsaMpBVHhj6o/ HTTP/1.1" 200 359
INFO 2025-04-13 20:07:38,542 basehttp 22248 6884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:38,843 basehttp 22248 16380 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:39,168 log 22248 7388 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, view) already exists.
ERROR 2025-04-13 20:07:39,191 basehttp 22248 7388 "POST /songs/59P5MoE5SawsaMpBVHhj6o/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:39,859 basehttp 22248 6364 "GET /api/recommendations/similar/?spotify_id=59P5MoE5SawsaMpBVHhj6o HTTP/1.1" 200 2908
ERROR 2025-04-13 20:07:40,864 log 22248 6364 Internal Server Error: /songs/59P5MoE5SawsaMpBVHhj6o/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 184, play) already exists.
ERROR 2025-04-13 20:07:40,878 basehttp 22248 6364 "POST /songs/59P5MoE5SawsaMpBVHhj6o/play/ HTTP/1.1" 500 145
WARNING 2025-04-13 20:07:48,331 log 22248 23024 Not Found: /songs/0KqEwy3JfnY6ePwdXtCAfz/comments
WARNING 2025-04-13 20:07:48,332 basehttp 22248 23024 "GET /songs/0KqEwy3JfnY6ePwdXtCAfz/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:48,596 basehttp 22248 18284 "GET /song/0KqEwy3JfnY6ePwdXtCAfz/ HTTP/1.1" 200 351
INFO 2025-04-13 20:07:48,998 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:49,315 basehttp 22248 17052 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:49,359 log 22248 17304 Internal Server Error: /songs/0KqEwy3JfnY6ePwdXtCAfz/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 183, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 183, view) already exists.
ERROR 2025-04-13 20:07:49,371 basehttp 22248 17304 "POST /songs/0KqEwy3JfnY6ePwdXtCAfz/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:50,428 basehttp 22248 10412 "GET /api/recommendations/similar/?spotify_id=0KqEwy3JfnY6ePwdXtCAfz HTTP/1.1" 200 2908
ERROR 2025-04-13 20:07:50,802 log 22248 17304 Internal Server Error: /songs/0KqEwy3JfnY6ePwdXtCAfz/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 183, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 183, play) already exists.
ERROR 2025-04-13 20:07:50,815 basehttp 22248 17304 "POST /songs/0KqEwy3JfnY6ePwdXtCAfz/play/ HTTP/1.1" 500 145
WARNING 2025-04-13 20:07:51,003 log 22248 23232 Not Found: /songs/4Px5yA9U4XPcq1y0mvDfB6/comments
WARNING 2025-04-13 20:07:51,011 basehttp 22248 23232 "GET /songs/4Px5yA9U4XPcq1y0mvDfB6/comments HTTP/1.1" 404 179
WARNING 2025-04-13 20:07:51,022 log 22248 22328 Not Found: /songs/4Px5yA9U4XPcq1y0mvDfB6/comments
WARNING 2025-04-13 20:07:51,023 basehttp 22248 22328 "GET /songs/4Px5yA9U4XPcq1y0mvDfB6/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:51,272 basehttp 22248 23024 "GET /song/4Px5yA9U4XPcq1y0mvDfB6/ HTTP/1.1" 200 355
INFO 2025-04-13 20:07:51,542 basehttp 22248 23024 "GET /song/4Px5yA9U4XPcq1y0mvDfB6/ HTTP/1.1" 200 355
INFO 2025-04-13 20:07:51,674 basehttp 22248 17052 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:51,982 basehttp 22248 18284 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:52,025 log 22248 10412 Internal Server Error: /songs/4Px5yA9U4XPcq1y0mvDfB6/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, view) already exists.
ERROR 2025-04-13 20:07:52,037 basehttp 22248 10412 "POST /songs/4Px5yA9U4XPcq1y0mvDfB6/view/ HTTP/1.1" 500 145
ERROR 2025-04-13 20:07:52,321 log 22248 21356 Internal Server Error: /songs/4Px5yA9U4XPcq1y0mvDfB6/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, view) already exists.
ERROR 2025-04-13 20:07:52,332 basehttp 22248 21356 "POST /songs/4Px5yA9U4XPcq1y0mvDfB6/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:52,376 basehttp 22248 17052 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:53,018 basehttp 22248 17304 - Broken pipe from ('127.0.0.1', 56340)
INFO 2025-04-13 20:07:53,039 basehttp 22248 18284 - Broken pipe from ('127.0.0.1', 56335)
WARNING 2025-04-13 20:07:53,069 log 22248 22328 Not Found: /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments
WARNING 2025-04-13 20:07:53,075 basehttp 22248 22328 "GET /songs/44ZRdPlGh8ZIyDNgBpP9w5/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:53,298 basehttp 22248 23232 "GET /song/44ZRdPlGh8ZIyDNgBpP9w5/ HTTP/1.1" 200 352
ERROR 2025-04-13 20:07:53,612 log 22248 21356 Internal Server Error: /songs/4Px5yA9U4XPcq1y0mvDfB6/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 176, play) already exists.
INFO 2025-04-13 20:07:53,617 basehttp 22248 21356 - Broken pipe from ('127.0.0.1', 56359)
INFO 2025-04-13 20:07:53,745 basehttp 22248 17052 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:07:53,927 log 22248 22328 Not Found: /songs/1qA9qskyfKjjxS5YBM4A0w/comments
WARNING 2025-04-13 20:07:53,930 basehttp 22248 22328 "GET /songs/1qA9qskyfKjjxS5YBM4A0w/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:54,013 basehttp 22248 23024 - Broken pipe from ('127.0.0.1', 56333)
ERROR 2025-04-13 20:07:54,033 log 22248 23500 Internal Server Error: /songs/44ZRdPlGh8ZIyDNgBpP9w5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 175, view) already exists.
INFO 2025-04-13 20:07:54,041 basehttp 22248 23500 - Broken pipe from ('127.0.0.1', 56376)
INFO 2025-04-13 20:07:54,204 basehttp 22248 20800 "GET /song/1qA9qskyfKjjxS5YBM4A0w/ HTTP/1.1" 200 377
INFO 2025-04-13 20:07:54,596 basehttp 22248 17052 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:54,938 basehttp 22248 23232 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:54,978 log 22248 21244 Internal Server Error: /songs/1qA9qskyfKjjxS5YBM4A0w/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 174, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 174, view) already exists.
ERROR 2025-04-13 20:07:54,988 basehttp 22248 21244 "POST /songs/1qA9qskyfKjjxS5YBM4A0w/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:55,063 basehttp 22248 10412 - Broken pipe from ('127.0.0.1', 56332)
WARNING 2025-04-13 20:07:55,275 log 22248 17052 Not Found: /songs/5GN1D207XKDFHlOxL9n4f5/comments
WARNING 2025-04-13 20:07:55,280 basehttp 22248 17052 "GET /songs/5GN1D207XKDFHlOxL9n4f5/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:55,521 basehttp 22248 22328 "GET /song/5GN1D207XKDFHlOxL9n4f5/ HTTP/1.1" 200 351
INFO 2025-04-13 20:07:55,961 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:55,974 basehttp 22248 16748 - Broken pipe from ('127.0.0.1', 56380)
WARNING 2025-04-13 20:07:56,083 log 22248 22328 Not Found: /songs/2imhsF5WUWS9upG7yyOWuu/comments
WARNING 2025-04-13 20:07:56,092 basehttp 22248 22328 "GET /songs/2imhsF5WUWS9upG7yyOWuu/comments HTTP/1.1" 404 179
WARNING 2025-04-13 20:07:56,095 log 22248 22328 Not Found: /songs/2imhsF5WUWS9upG7yyOWuu/comments
WARNING 2025-04-13 20:07:56,095 basehttp 22248 22328 "GET /songs/2imhsF5WUWS9upG7yyOWuu/comments HTTP/1.1" 404 179
ERROR 2025-04-13 20:07:56,272 log 22248 8776 Internal Server Error: /songs/5GN1D207XKDFHlOxL9n4f5/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 173, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 173, view) already exists.
INFO 2025-04-13 20:07:56,273 basehttp 22248 20800 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:56,277 basehttp 22248 8776 "POST /songs/5GN1D207XKDFHlOxL9n4f5/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:56,321 basehttp 22248 17052 "GET /song/2imhsF5WUWS9upG7yyOWuu/ HTTP/1.1" 200 341
INFO 2025-04-13 20:07:56,577 basehttp 22248 17052 "GET /song/2imhsF5WUWS9upG7yyOWuu/ HTTP/1.1" 200 341
INFO 2025-04-13 20:07:56,766 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 20:07:57,110 log 22248 8776 Internal Server Error: /songs/2imhsF5WUWS9upG7yyOWuu/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 168, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 168, view) already exists.
ERROR 2025-04-13 20:07:57,115 basehttp 22248 8776 "POST /songs/2imhsF5WUWS9upG7yyOWuu/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:57,314 basehttp 22248 20800 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:07:57,418 log 22248 7544 Internal Server Error: /songs/2imhsF5WUWS9upG7yyOWuu/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 168, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 168, view) already exists.
INFO 2025-04-13 20:07:57,420 basehttp 22248 21244 "GET /api/recommendations/similar/?spotify_id=5GN1D207XKDFHlOxL9n4f5 HTTP/1.1" 200 3039
ERROR 2025-04-13 20:07:57,425 basehttp 22248 7544 "POST /songs/2imhsF5WUWS9upG7yyOWuu/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:07:57,515 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:07:57,988 log 22248 20484 Not Found: /songs/1srnQGDZocVzKwURAiK97J/comments
WARNING 2025-04-13 20:07:57,990 basehttp 22248 20484 "GET /songs/1srnQGDZocVzKwURAiK97J/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:58,195 basehttp 22248 19504 - Broken pipe from ('127.0.0.1', 56402)
INFO 2025-04-13 20:07:58,248 basehttp 22248 18004 "GET /song/1srnQGDZocVzKwURAiK97J/ HTTP/1.1" 200 342
INFO 2025-04-13 20:07:58,395 basehttp 22248 20800 - Broken pipe from ('127.0.0.1', 56381)
INFO 2025-04-13 20:07:58,708 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:07:58,980 log 22248 20484 Not Found: /songs/6oA7e0fohYvsukh8ytkMr0/comments
WARNING 2025-04-13 20:07:58,983 basehttp 22248 20484 "GET /songs/6oA7e0fohYvsukh8ytkMr0/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:07:59,039 basehttp 22248 17052 - Broken pipe from ('127.0.0.1', 56334)
ERROR 2025-04-13 20:07:59,117 log 22248 21244 Internal Server Error: /songs/1srnQGDZocVzKwURAiK97J/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.
INFO 2025-04-13 20:07:59,122 basehttp 22248 21244 - Broken pipe from ('127.0.0.1', 56387)
INFO 2025-04-13 20:07:59,207 basehttp 22248 15756 "GET /song/6oA7e0fohYvsukh8ytkMr0/ HTTP/1.1" 200 341
INFO 2025-04-13 20:07:59,645 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:07:59,983 basehttp 22248 18004 - Broken pipe from ('127.0.0.1', 56433)
ERROR 2025-04-13 20:07:59,985 log 22248 14516 Internal Server Error: /songs/6oA7e0fohYvsukh8ytkMr0/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 166, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 166, view) already exists.
INFO 2025-04-13 20:07:59,994 basehttp 22248 14516 - Broken pipe from ('127.0.0.1', 56447)
WARNING 2025-04-13 20:08:00,035 log 22248 20484 Not Found: /songs/1srnQGDZocVzKwURAiK97J/comments
INFO 2025-04-13 20:08:00,039 basehttp 22248 7544 - Broken pipe from ('127.0.0.1', 56410)
WARNING 2025-04-13 20:08:00,043 basehttp 22248 20484 "GET /songs/1srnQGDZocVzKwURAiK97J/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:08:00,274 basehttp 22248 20968 "GET /song/1srnQGDZocVzKwURAiK97J/ HTTP/1.1" 200 342
INFO 2025-04-13 20:08:00,723 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-13 20:08:01,054 log 22248 16160 Internal Server Error: /songs/1srnQGDZocVzKwURAiK97J/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 164, view) already exists.
INFO 2025-04-13 20:08:01,067 basehttp 22248 15756 - Broken pipe from ('127.0.0.1', 56442)
INFO 2025-04-13 20:08:01,070 basehttp 22248 16160 - Broken pipe from ('127.0.0.1', 56458)
INFO 2025-04-13 20:08:01,081 basehttp 22248 8776 - Broken pipe from ('127.0.0.1', 56399)
WARNING 2025-04-13 20:08:01,178 log 22248 20484 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-13 20:08:01,184 basehttp 22248 20484 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:08:01,448 basehttp 22248 14088 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-13 20:08:01,841 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:08:02,112 basehttp 22248 21516 - Broken pipe from ('127.0.0.1', 56452)
INFO 2025-04-13 20:08:02,128 basehttp 22248 20968 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:08:02,218 log 22248 4376 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-13 20:08:02,228 basehttp 22248 4376 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:08:02,718 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:08:02,789 basehttp 22248 20484 "GET /api/recommendations/trending/ HTTP/1.1" 200 6065
INFO 2025-04-13 20:08:03,111 basehttp 22248 20968 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:08:03,151 basehttp 22248 17664 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-13 20:08:03,360 basehttp 22248 14088 "GET /popularity/ HTTP/1.1" 200 13953
INFO 2025-04-13 20:08:03,399 basehttp 22248 23232 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:08:03,532 basehttp 22248 20484 "GET /api/recommendations/trending/ HTTP/1.1" 200 6065
INFO 2025-04-13 20:08:04,126 basehttp 22248 20968 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:08:04,720 basehttp 22248 14088 "GET /popularity/ HTTP/1.1" 200 13812
INFO 2025-04-13 20:08:06,324 basehttp 22248 20968 "GET /popularity/ HTTP/1.1" 200 6871
INFO 2025-04-13 20:08:07,642 basehttp 22248 14088 "GET /popularity/ HTTP/1.1" 200 6890
INFO 2025-04-13 20:08:27,641 basehttp 22248 3624 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:08:27,664 log 22248 4260 Not Found: /recommendations/friends/
WARNING 2025-04-13 20:08:27,665 basehttp 22248 4260 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 20:08:27,677 basehttp 22248 14116 "GET /history/recent/?limit=4 HTTP/1.1" 200 1486
INFO 2025-04-13 20:08:27,757 basehttp 22248 18884 "GET /history/most-played/ HTTP/1.1" 200 3799
INFO 2025-04-13 20:08:27,994 basehttp 22248 22648 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:08:28,240 basehttp 22248 12080 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
INFO 2025-04-13 20:08:28,366 basehttp 22248 3624 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:08:28,382 basehttp 22248 14116 "GET /history/recent/?limit=4 HTTP/1.1" 200 1486
WARNING 2025-04-13 20:08:28,422 log 22248 4260 Not Found: /recommendations/friends/
WARNING 2025-04-13 20:08:28,422 basehttp 22248 4260 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 20:08:28,640 basehttp 22248 18884 "GET /history/most-played/ HTTP/1.1" 200 3799
INFO 2025-04-13 20:08:29,043 basehttp 22248 22648 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:08:29,481 basehttp 22248 12080 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5944
INFO 2025-04-13 20:08:30,642 basehttp 22248 22648 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5964
INFO 2025-04-13 20:08:31,829 basehttp 22248 12080 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5964
INFO 2025-04-13 20:09:06,054 basehttp 22248 18760 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:09:06,146 basehttp 22248 17420 "GET /api/recommendations/trending/ HTTP/1.1" 200 6065
INFO 2025-04-13 20:09:06,438 basehttp 22248 3812 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:09:06,939 basehttp 22248 21628 "GET /popularity/ HTTP/1.1" 200 13794
INFO 2025-04-13 20:09:06,979 basehttp 22248 18760 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:09:07,173 basehttp 22248 17420 "GET /api/recommendations/trending/ HTTP/1.1" 200 6065
INFO 2025-04-13 20:09:07,744 basehttp 22248 3812 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:09:08,369 basehttp 22248 21628 "GET /popularity/ HTTP/1.1" 200 6345
INFO 2025-04-13 20:09:10,562 basehttp 22248 21628 "GET /popularity/ HTTP/1.1" 200 13888
INFO 2025-04-13 20:09:12,780 basehttp 22248 3812 "GET /popularity/ HTTP/1.1" 200 13981
INFO 2025-04-13 20:10:05,198 basehttp 22248 16572 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:10:11,507 basehttp 22248 19544 "OPTIONS /search-songs/?q=so HTTP/1.1" 200 0
INFO 2025-04-13 20:10:11,883 basehttp 22248 16572 "GET /search-songs/?q=s HTTP/1.1" 200 2010
INFO 2025-04-13 20:10:12,318 basehttp 22248 16572 "OPTIONS /search-songs/?q=son HTTP/1.1" 200 0
INFO 2025-04-13 20:10:12,487 basehttp 22248 19544 "GET /search-songs/?q=so HTTP/1.1" 200 2019
INFO 2025-04-13 20:10:13,221 basehttp 22248 19544 "OPTIONS /search-songs/?q=sona HTTP/1.1" 200 0
INFO 2025-04-13 20:10:13,354 basehttp 22248 16572 "GET /search-songs/?q=son HTTP/1.1" 200 2012
INFO 2025-04-13 20:10:14,292 basehttp 22248 19544 "GET /search-songs/?q=sona HTTP/1.1" 200 2087
INFO 2025-04-13 20:10:16,005 basehttp 22248 19544 "OPTIONS /search-songs/?q=sonam HTTP/1.1" 200 0
INFO 2025-04-13 20:10:16,249 basehttp 22248 16572 "OPTIONS /search-songs/?q=sonam%20 HTTP/1.1" 200 0
INFO 2025-04-13 20:10:16,473 basehttp 22248 13108 "OPTIONS /search-songs/?q=sonam%20k HTTP/1.1" 200 0
INFO 2025-04-13 20:10:16,954 basehttp 22248 19688 "OPTIONS /search-songs/?q=sonam%20ka HTTP/1.1" 200 0
INFO 2025-04-13 20:10:16,989 basehttp 22248 19544 "GET /search-songs/?q=sonam HTTP/1.1" 200 2508
INFO 2025-04-13 20:10:17,217 basehttp 22248 16572 "GET /search-songs/?q=sonam%20 HTTP/1.1" 200 2508
INFO 2025-04-13 20:10:17,692 basehttp 22248 13108 "GET /search-songs/?q=sonam%20k HTTP/1.1" 200 2532
INFO 2025-04-13 20:10:18,094 basehttp 22248 19688 "GET /search-songs/?q=sonam%20ka HTTP/1.1" 200 2511
WARNING 2025-04-13 20:10:23,184 log 22248 19688 Not Found: /log-interaction/
WARNING 2025-04-13 20:10:23,185 basehttp 22248 19688 "POST /log-interaction/ HTTP/1.1" 404 179
INFO 2025-04-13 20:10:23,366 basehttp 22248 13108 "OPTIONS /api/recommendations/similar/?spotify_id=3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 200 0
WARNING 2025-04-13 20:10:23,371 log 22248 19544 Not Found: /songs/3bZPdEskcnMdepwCaDSJRl/comments
INFO 2025-04-13 20:10:23,372 basehttp 22248 13108 "OPTIONS /api/recommendations/similar/?spotify_id=3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 200 0
WARNING 2025-04-13 20:10:23,375 basehttp 22248 19544 "GET /songs/3bZPdEskcnMdepwCaDSJRl/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:10:23,376 basehttp 22248 16572 "GET /song/3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 301 0
WARNING 2025-04-13 20:10:23,381 log 22248 19544 Not Found: /songs/3bZPdEskcnMdepwCaDSJRl/comments
WARNING 2025-04-13 20:10:23,385 basehttp 22248 19544 "GET /songs/3bZPdEskcnMdepwCaDSJRl/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:10:23,724 basehttp 22248 13108 "GET /song/3bZPdEskcnMdepwCaDSJRl/ HTTP/1.1" 200 397
INFO 2025-04-13 20:10:23,728 basehttp 22248 19544 "OPTIONS /songs/3bZPdEskcnMdepwCaDSJRl/view/ HTTP/1.1" 200 0
INFO 2025-04-13 20:10:24,114 basehttp 22248 13108 "GET /song/3bZPdEskcnMdepwCaDSJRl/ HTTP/1.1" 200 397
INFO 2025-04-13 20:10:24,245 basehttp 22248 19688 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:10:24,274 spotify_utils 22248 22736 Getting track for ID: 3bZPdEskcnMdepwCaDSJRl
INFO 2025-04-13 20:10:24,615 basehttp 22248 20276 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:10:24,632 spotify_utils 22248 3784 Getting track for ID: 3bZPdEskcnMdepwCaDSJRl
INFO 2025-04-13 20:10:24,883 spotify_utils 22248 22736 Successfully retrieved track: Bin Tere by Vishal-Shekhar, Shafqat Amanat Ali, Sunidhi Chauhan
INFO 2025-04-13 20:10:25,055 spotify_utils 22248 1336 Getting track for ID: 3bZPdEskcnMdepwCaDSJRl
INFO 2025-04-13 20:10:25,074 basehttp 22248 19688 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:10:25,216 spotify_utils 22248 3784 Successfully retrieved track: Bin Tere by Vishal-Shekhar, Shafqat Amanat Ali, Sunidhi Chauhan
INFO 2025-04-13 20:10:25,559 basehttp 22248 3784 "POST /songs/3bZPdEskcnMdepwCaDSJRl/view/ HTTP/1.1" 200 54
INFO 2025-04-13 20:10:25,565 basehttp 22248 19688 "OPTIONS /songs/3bZPdEskcnMdepwCaDSJRl/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 20:10:25,568 log 22248 3784 Not Found: /songs/3bZPdEskcnMdepwCaDSJRl/status/
WARNING 2025-04-13 20:10:25,570 basehttp 22248 3784 "GET /songs/3bZPdEskcnMdepwCaDSJRl/status/ HTTP/1.1" 404 179
INFO 2025-04-13 20:10:25,571 spotify_utils 22248 1336 Successfully retrieved track: Bin Tere by Vishal-Shekhar, Shafqat Amanat Ali, Sunidhi Chauhan
ERROR 2025-04-13 20:10:25,646 log 22248 1336 Internal Server Error: /songs/3bZPdEskcnMdepwCaDSJRl/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1020, in view_song
    song = Song.objects.create(
        spotify_id=spotify_track_id,
    ...<6 lines>...
        url=song_details['url']
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\projects\music\server\songs\app\models.py", line 64, in save
    self.full_clean()  # Run validation before saving
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1651, in full_clean
    raise ValidationError(errors)
django.core.exceptions.ValidationError: {'spotify_id': ['Song with this Spotify id already exists.']}
ERROR 2025-04-13 20:10:25,657 basehttp 22248 1336 "POST /songs/3bZPdEskcnMdepwCaDSJRl/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:10:25,784 basehttp 22248 20276 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:10:25,990 basehttp 22248 20276 "OPTIONS /songs/3bZPdEskcnMdepwCaDSJRl/play/ HTTP/1.1" 200 0
INFO 2025-04-13 20:10:26,806 basehttp 22248 1336 "POST /songs/3bZPdEskcnMdepwCaDSJRl/play/ HTTP/1.1" 200 60
INFO 2025-04-13 20:10:27,764 basehttp 22248 22736 "GET /api/recommendations/similar/?spotify_id=3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 200 3387
INFO 2025-04-13 20:10:30,039 basehttp 22248 22736 "GET /api/recommendations/similar/?spotify_id=3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 200 3387
INFO 2025-04-13 20:11:24,054 basehttp 22248 20276 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:12:24,044 basehttp 22248 20276 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:13:24,034 basehttp 22248 20276 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:14:09,582 log 22248 19544 Not Found: /songs/0gPgdRfB4jdGrlyXS0Vx78/comments
INFO 2025-04-13 20:14:09,583 basehttp 22248 13108 "OPTIONS /api/recommendations/similar/?spotify_id=0gPgdRfB4jdGrlyXS0Vx78 HTTP/1.1" 200 0
INFO 2025-04-13 20:14:09,583 basehttp 22248 19688 "GET /song/0gPgdRfB4jdGrlyXS0Vx78 HTTP/1.1" 301 0
WARNING 2025-04-13 20:14:09,583 basehttp 22248 19544 "GET /songs/0gPgdRfB4jdGrlyXS0Vx78/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:14:09,882 basehttp 22248 19544 "GET /song/0gPgdRfB4jdGrlyXS0Vx78/ HTTP/1.1" 200 363
INFO 2025-04-13 20:14:09,885 basehttp 22248 19544 "OPTIONS /songs/0gPgdRfB4jdGrlyXS0Vx78/view/ HTTP/1.1" 200 0
INFO 2025-04-13 20:14:10,275 basehttp 22248 20276 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:14:10,564 basehttp 22248 15124 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:14:10,625 basehttp 22248 1336 "POST /songs/0gPgdRfB4jdGrlyXS0Vx78/view/ HTTP/1.1" 200 54
INFO 2025-04-13 20:14:10,631 basehttp 22248 15124 "OPTIONS /songs/0gPgdRfB4jdGrlyXS0Vx78/status/ HTTP/1.1" 200 0
WARNING 2025-04-13 20:14:10,636 log 22248 1336 Not Found: /songs/0gPgdRfB4jdGrlyXS0Vx78/status/
WARNING 2025-04-13 20:14:10,637 basehttp 22248 1336 "GET /songs/0gPgdRfB4jdGrlyXS0Vx78/status/ HTTP/1.1" 404 179
INFO 2025-04-13 20:14:11,153 basehttp 22248 22736 "GET /api/recommendations/similar/?spotify_id=0gPgdRfB4jdGrlyXS0Vx78 HTTP/1.1" 200 484
INFO 2025-04-13 20:14:11,278 basehttp 22248 15124 "OPTIONS /songs/0gPgdRfB4jdGrlyXS0Vx78/play/ HTTP/1.1" 200 0
INFO 2025-04-13 20:14:12,027 basehttp 22248 22736 "POST /songs/0gPgdRfB4jdGrlyXS0Vx78/play/ HTTP/1.1" 200 60
INFO 2025-04-13 20:15:09,561 basehttp 22248 15124 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 20:15:10,354 basehttp 22248 15124 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:16:10,258 basehttp 22248 15124 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:17:10,292 basehttp 22248 15124 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:18:04,417 log 22248 19544 Not Found: /songs/3bZPdEskcnMdepwCaDSJRl/comments
INFO 2025-04-13 20:18:04,421 basehttp 22248 20276 "OPTIONS /playlists/ HTTP/1.1" 200 0
WARNING 2025-04-13 20:18:04,421 basehttp 22248 19544 "GET /songs/3bZPdEskcnMdepwCaDSJRl/comments HTTP/1.1" 404 179
INFO 2025-04-13 20:18:04,744 basehttp 22248 13108 "GET /song/3bZPdEskcnMdepwCaDSJRl/ HTTP/1.1" 200 397
INFO 2025-04-13 20:18:05,148 basehttp 22248 15124 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:18:05,488 basehttp 22248 20276 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-13 20:18:05,533 log 22248 1336 Internal Server Error: /songs/3bZPdEskcnMdepwCaDSJRl/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 194, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 194, view) already exists.
ERROR 2025-04-13 20:18:05,549 basehttp 22248 1336 "POST /songs/3bZPdEskcnMdepwCaDSJRl/view/ HTTP/1.1" 500 145
INFO 2025-04-13 20:18:06,539 basehttp 22248 22736 "GET /api/recommendations/similar/?spotify_id=3bZPdEskcnMdepwCaDSJRl HTTP/1.1" 200 3387
ERROR 2025-04-13 20:18:06,791 log 22248 1336 Internal Server Error: /songs/3bZPdEskcnMdepwCaDSJRl/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 194, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 194, play) already exists.
ERROR 2025-04-13 20:18:06,798 basehttp 22248 1336 "POST /songs/3bZPdEskcnMdepwCaDSJRl/play/ HTTP/1.1" 500 145
INFO 2025-04-13 20:18:07,536 basehttp 22248 20276 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:07,544 basehttp 22248 15124 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:07,544 basehttp 22248 19544 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:07,545 basehttp 22248 20276 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:07,553 basehttp 22248 13776 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:07,566 basehttp 22248 9060 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:08,239 basehttp 22248 13108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:18:08,328 basehttp 22248 20276 "GET /api/recommendations/trending/ HTTP/1.1" 200 6022
INFO 2025-04-13 20:18:08,543 basehttp 22248 15124 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:18:08,937 basehttp 22248 13108 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:18:09,004 basehttp 22248 19544 "GET /popularity/ HTTP/1.1" 200 13909
INFO 2025-04-13 20:18:09,085 basehttp 22248 9060 "GET /api/recommendations/trending/ HTTP/1.1" 200 6022
INFO 2025-04-13 20:18:09,543 basehttp 22248 15124 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:18:10,222 basehttp 22248 13108 "GET /popularity/ HTTP/1.1" 200 13785
INFO 2025-04-13 20:18:12,335 basehttp 22248 15124 "GET /popularity/ HTTP/1.1" 200 14570
INFO 2025-04-13 20:18:13,794 basehttp 22248 13108 "GET /popularity/ HTTP/1.1" 200 6937
INFO 2025-04-13 20:18:16,058 basehttp 22248 13776 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,062 basehttp 22248 19544 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,062 basehttp 22248 20276 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,063 basehttp 22248 15124 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,064 basehttp 22248 9060 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,068 basehttp 22248 19544 "OPTIONS /recommendations/friends/?limit=16 HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,069 basehttp 22248 20276 "OPTIONS /history/recent/?limit=4 HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,070 basehttp 22248 15124 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,070 basehttp 22248 9060 "OPTIONS /history/most-played/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,079 basehttp 22248 20276 "OPTIONS /api/recommendations/matrix/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:16,722 basehttp 22248 13108 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:18:16,782 log 22248 15124 Not Found: /recommendations/friends/
WARNING 2025-04-13 20:18:16,783 basehttp 22248 15124 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 20:18:16,806 basehttp 22248 20276 "GET /history/recent/?limit=4 HTTP/1.1" 200 1634
INFO 2025-04-13 20:18:16,866 basehttp 22248 9060 "GET /history/most-played/ HTTP/1.1" 200 3799
INFO 2025-04-13 20:18:17,035 basehttp 22248 13776 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:18:17,210 basehttp 22248 19544 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6051
INFO 2025-04-13 20:18:17,409 basehttp 22248 13108 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 20:18:17,499 log 22248 15124 Not Found: /recommendations/friends/
WARNING 2025-04-13 20:18:17,500 basehttp 22248 15124 "GET /recommendations/friends/?limit=16 HTTP/1.1" 404 53
INFO 2025-04-13 20:18:17,530 basehttp 22248 20276 "GET /history/recent/?limit=4 HTTP/1.1" 200 1634
INFO 2025-04-13 20:18:17,629 basehttp 22248 9060 "GET /history/most-played/ HTTP/1.1" 200 3799
INFO 2025-04-13 20:18:18,053 basehttp 22248 13776 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:18:18,404 basehttp 22248 19544 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5964
INFO 2025-04-13 20:18:19,578 basehttp 22248 19544 "GET /api/recommendations/matrix/ HTTP/1.1" 200 5974
INFO 2025-04-13 20:18:20,746 basehttp 22248 13776 "GET /api/recommendations/matrix/ HTTP/1.1" 200 6026
INFO 2025-04-13 20:18:33,588 basehttp 22248 13776 "OPTIONS /playlists/1/songs/ HTTP/1.1" 200 0
INFO 2025-04-13 20:18:34,309 spotify_utils 22248 13776 Getting track for ID: 59P5MoE5SawsaMpBVHhj6o
INFO 2025-04-13 20:18:34,845 spotify_utils 22248 13776 Successfully retrieved track: Jiunu Nai Hola by Tribal Rain
INFO 2025-04-13 20:18:35,569 basehttp 22248 13776 "POST /playlists/1/songs/ HTTP/1.1" 200 263
INFO 2025-04-13 20:18:44,937 spotify_utils 22248 13776 Getting track for ID: 2ejkRnZWPACfuqr06gFw1w
INFO 2025-04-13 20:18:45,509 spotify_utils 22248 13776 Successfully retrieved track: Stay on These Roads by a-ha
INFO 2025-04-13 20:18:46,510 basehttp 22248 13776 "POST /playlists/1/songs/ HTTP/1.1" 200 266
INFO 2025-04-13 20:18:52,490 spotify_utils 22248 13776 Getting track for ID: 6c9nkeetGbsoXa7d5E1wHa
INFO 2025-04-13 20:18:53,072 spotify_utils 22248 13776 Successfully retrieved track: Crying in the Rain by a-ha
INFO 2025-04-13 20:18:53,732 basehttp 22248 13776 "POST /playlists/1/songs/ HTTP/1.1" 200 279
INFO 2025-04-13 20:18:59,572 spotify_utils 22248 13776 Getting track for ID: 6a9O11ZNVVkl6zMrbdO3p3
INFO 2025-04-13 20:19:00,309 spotify_utils 22248 13776 Successfully retrieved track: You Are the One by a-ha
INFO 2025-04-13 20:19:00,972 basehttp 22248 13776 "POST /playlists/1/songs/ HTTP/1.1" 200 262
INFO 2025-04-13 20:19:14,615 basehttp 22248 13776 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:19:14,921 basehttp 22248 19544 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:19:15,318 basehttp 22248 13776 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:19:15,714 basehttp 22248 9060 "GET /playlists/1/songs/ HTTP/1.1" 200 1116
INFO 2025-04-13 20:19:15,720 basehttp 22248 9060 "OPTIONS /playlists/2/songs/ HTTP/1.1" 200 0
INFO 2025-04-13 20:19:15,941 basehttp 22248 19544 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-13 20:19:16,505 basehttp 22248 9060 "GET /playlists/2/songs/ HTTP/1.1" 200 496
INFO 2025-04-13 20:19:16,706 basehttp 22248 19544 "GET /playlists/1/songs/ HTTP/1.1" 200 1116
INFO 2025-04-13 20:19:17,493 basehttp 22248 19544 "GET /playlists/2/songs/ HTTP/1.1" 200 496
INFO 2025-04-13 20:20:14,637 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:20:24,175 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:20:24,861 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:21:14,638 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:22:15,298 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:23:14,973 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:24:14,682 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:25:49,646 basehttp 22248 19544 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:26:49,685 basehttp 22248 10448 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:27:49,657 basehttp 22248 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:28:50,208 basehttp 22248 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:29:49,861 basehttp 22248 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:30:49,720 basehttp 22248 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 20:31:50,064 basehttp 22248 20764 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:10:28,827 basehttp 22248 22884 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:11:49,863 basehttp 22248 17032 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:12:49,671 basehttp 22248 17032 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:13:49,666 basehttp 22248 17032 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:14:49,647 basehttp 22248 17032 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:15:49,656 basehttp 22248 18804 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:16:49,685 basehttp 22248 22480 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:17:49,664 basehttp 22248 11240 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:18:49,651 basehttp 22248 20240 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:19:49,681 basehttp 22248 22104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:20:49,643 basehttp 22248 22104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:21:49,679 basehttp 22248 22104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:22:49,702 basehttp 22248 22104 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:23:49,700 basehttp 22248 10652 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:24:49,679 basehttp 22248 21752 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:25:49,659 basehttp 22248 22616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:26:49,708 basehttp 22248 22616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:27:49,720 basehttp 22248 22616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:28:49,670 basehttp 22248 22616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:29:49,697 basehttp 22248 22616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:30:49,705 basehttp 22248 21816 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:31:49,682 basehttp 22248 21816 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:32:49,678 basehttp 22248 21816 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:33:49,723 basehttp 22248 9044 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:34:49,675 basehttp 22248 18680 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:35:49,652 basehttp 22248 20772 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:36:49,653 basehttp 22248 17768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:37:49,711 basehttp 22248 12520 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:38:49,705 basehttp 22248 9768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:39:49,706 basehttp 22248 22892 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:40:49,676 basehttp 22248 6048 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:41:49,607 basehttp 22248 6048 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:42:49,688 basehttp 22248 21312 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:43:49,678 basehttp 22248 16424 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:44:49,729 basehttp 22248 20852 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:45:49,678 basehttp 22248 20900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:46:49,663 basehttp 22248 4056 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:48:14,430 basehttp 22248 14896 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:49:51,882 basehttp 22248 3508 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:50:49,899 basehttp 22248 22504 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:50:54,496 autoreload 22248 1160 C:\projects\music\server\songs\app\models.py changed, reloading.
INFO 2025-04-13 21:50:58,624 autoreload 16844 9236 Watching for file changes with StatReloader
INFO 2025-04-13 21:51:49,834 basehttp 16844 1920 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 21:51:52,581 autoreload 16844 9236 C:\projects\music\server\songs\app\spotify_utils.py changed, reloading.
INFO 2025-04-13 21:51:54,266 autoreload 20952 21528 Watching for file changes with StatReloader
INFO 2025-04-13 22:19:10,285 autoreload 16844 19484 Watching for file changes with StatReloader
INFO 2025-04-13 22:19:48,975 basehttp 16844 11344 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-13 22:19:51,232 basehttp 16844 11344 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:19:57,232 basehttp 16844 2836 "GET /api/charts/available HTTP/1.1" 301 0
INFO 2025-04-13 22:20:00,138 basehttp 16844 16760 "GET /api/charts/available/ HTTP/1.1" 200 45
INFO 2025-04-13 22:20:50,959 basehttp 16844 6248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:21:51,320 basehttp 16844 6248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:22:51,245 basehttp 16844 6248 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:23:50,944 basehttp 16844 19808 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:24:51,955 basehttp 16844 22156 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:25:49,857 basehttp 16844 13768 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:26:23,291 autoreload 16844 19484 C:\projects\music\server\songs\app\spotifycharts.py changed, reloading.
INFO 2025-04-13 22:26:25,555 autoreload 21356 17200 Watching for file changes with StatReloader
INFO 2025-04-13 22:26:32,502 basehttp 21356 6208 "GET /api/charts/available HTTP/1.1" 301 0
INFO 2025-04-13 22:26:33,283 basehttp 21356 15964 "GET /api/charts/available/ HTTP/1.1" 200 45
INFO 2025-04-13 22:26:50,721 basehttp 21356 23328 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-13 22:26:57,323 log 21356 15964 Not Found: /api/charts/
WARNING 2025-04-13 22:26:57,324 basehttp 21356 15964 "GET /api/charts/ HTTP/1.1" 404 57
INFO 2025-04-13 22:27:51,623 basehttp 21356 15088 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-13 22:28:51,494 basehttp 21356 23260 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 18:45:47,553 autoreload 21636 15936 Watching for file changes with StatReloader
INFO 2025-04-16 18:57:58,298 basehttp 21636 26248 "OPTIONS /login/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:00,870 basehttp 21636 9524 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-16 18:58:02,146 basehttp 21636 27340 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,157 basehttp 21636 27340 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,158 basehttp 21636 12808 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,162 basehttp 21636 13972 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,163 basehttp 21636 27340 "OPTIONS /playlists/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,168 basehttp 21636 13972 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,177 basehttp 21636 16188 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,179 basehttp 21636 27284 "OPTIONS /api/recommendations/trending/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,179 basehttp 21636 12808 "OPTIONS /popularity/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:02,190 basehttp 21636 25604 "OPTIONS /notifications/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:03,321 basehttp 21636 27340 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 18:58:03,452 basehttp 21636 27284 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 18:58:03,729 basehttp 21636 16188 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 18:58:04,104 basehttp 21636 13972 "GET /popularity/ HTTP/1.1" 200 13984
INFO 2025-04-16 18:58:04,136 basehttp 21636 27340 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 18:58:04,325 basehttp 21636 25604 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 18:58:04,956 basehttp 21636 16188 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 18:58:05,536 basehttp 21636 13972 "GET /popularity/ HTTP/1.1" 200 6817
INFO 2025-04-16 18:58:07,037 basehttp 21636 16188 "GET /popularity/ HTTP/1.1" 200 13834
INFO 2025-04-16 18:58:09,088 basehttp 21636 16188 "GET /popularity/ HTTP/1.1" 200 13993
INFO 2025-04-16 18:58:16,896 basehttp 21636 22116 "OPTIONS /search-songs/?q=t HTTP/1.1" 200 0
INFO 2025-04-16 18:58:17,176 basehttp 21636 21220 "OPTIONS /search-songs/?q=to HTTP/1.1" 200 0
INFO 2025-04-16 18:58:17,526 basehttp 21636 6600 "OPTIONS /search-songs/?q=tol HTTP/1.1" 200 0
INFO 2025-04-16 18:58:19,330 basehttp 21636 22116 "GET /search-songs/?q=t HTTP/1.1" 200 1764
INFO 2025-04-16 18:58:19,491 basehttp 21636 21220 "GET /search-songs/?q=to HTTP/1.1" 200 2056
INFO 2025-04-16 18:58:19,543 basehttp 21636 6600 "GET /search-songs/?q=tol HTTP/1.1" 200 1725
INFO 2025-04-16 18:58:20,218 basehttp 21636 6600 "OPTIONS /search-songs/?q=tola HTTP/1.1" 200 0
INFO 2025-04-16 18:58:21,177 basehttp 21636 21300 "OPTIONS /log-interaction/ HTTP/1.1" 200 0
WARNING 2025-04-16 18:58:21,188 log 21636 21300 Not Found: /log-interaction/
WARNING 2025-04-16 18:58:21,189 basehttp 21636 21300 "POST /log-interaction/ HTTP/1.1" 404 179
INFO 2025-04-16 18:58:21,259 basehttp 21636 6600 "GET /search-songs/?q=tola HTTP/1.1" 200 2483
INFO 2025-04-16 18:58:22,795 basehttp 21636 6600 "OPTIONS /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 0
INFO 2025-04-16 18:58:22,806 basehttp 21636 24372 "OPTIONS /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 0
WARNING 2025-04-16 18:58:22,808 log 21636 15820 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 18:58:22,809 basehttp 21636 15820 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-16 18:58:22,813 log 21636 15820 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 18:58:22,813 basehttp 21636 15820 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 18:58:23,066 basehttp 21636 21336 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 18:58:23,086 basehttp 21636 15820 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 0
INFO 2025-04-16 18:58:23,306 basehttp 21636 21336 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 18:58:23,614 basehttp 21636 21300 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 18:58:23,861 basehttp 21636 6600 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-16 18:58:23,979 log 21636 22012 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-16 18:58:24,376 log 21636 11904 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
INFO 2025-04-16 18:58:24,387 basehttp 21636 21300 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-16 18:58:24,552 basehttp 21636 22012 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
ERROR 2025-04-16 18:58:24,568 basehttp 21636 11904 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-16 18:58:25,045 basehttp 21636 6600 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 18:58:25,112 basehttp 21636 21328 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 18:58:25,542 basehttp 21636 6600 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 0
ERROR 2025-04-16 18:58:26,453 log 21636 11904 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.
ERROR 2025-04-16 18:58:26,459 basehttp 21636 11904 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 500 145
INFO 2025-04-16 18:58:27,240 basehttp 21636 21328 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
WARNING 2025-04-16 18:58:48,843 log 21636 26280 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 18:58:48,846 basehttp 21636 26280 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 18:58:49,070 basehttp 21636 26200 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 18:58:49,714 basehttp 21636 8768 "GET /notifications/ HTTP/1.1" 200 21
ERROR 2025-04-16 18:58:49,951 log 21636 20192 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-16 18:58:49,964 basehttp 21636 20192 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-16 18:58:50,049 basehttp 21636 16316 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 18:58:51,094 basehttp 21636 23056 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
ERROR 2025-04-16 18:58:52,049 log 21636 23056 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.
ERROR 2025-04-16 18:58:52,062 basehttp 21636 23056 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 500 145
INFO 2025-04-16 19:00:56,505 autoreload 27168 27820 Watching for file changes with StatReloader
INFO 2025-04-16 19:03:17,799 autoreload 27444 11368 Watching for file changes with StatReloader
WARNING 2025-04-16 19:03:23,537 log 27444 11480 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:03:23,551 basehttp 27444 11480 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:03:24,381 basehttp 27444 27268 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:03:24,682 basehttp 27444 7512 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:03:25,055 basehttp 27444 19524 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-16 19:03:25,339 log 27444 16952 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-16 19:03:25,375 basehttp 27444 16952 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-16 19:03:26,139 basehttp 27444 7832 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
ERROR 2025-04-16 19:03:27,217 log 27444 7832 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.
ERROR 2025-04-16 19:03:27,228 basehttp 27444 7832 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 500 145
INFO 2025-04-16 19:03:45,551 basehttp 27444 6200 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-16 19:03:46,606 basehttp 27444 6616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:03:46,701 basehttp 27444 10952 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:03:46,882 basehttp 27444 12416 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:03:47,402 basehttp 27444 12352 "GET /popularity/ HTTP/1.1" 200 13830
INFO 2025-04-16 19:03:47,491 basehttp 27444 6616 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:03:47,695 basehttp 27444 10952 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:03:48,062 basehttp 27444 12416 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:03:48,835 basehttp 27444 12352 "GET /popularity/ HTTP/1.1" 200 15220
INFO 2025-04-16 19:03:50,048 basehttp 27444 12416 "GET /popularity/ HTTP/1.1" 200 6689
INFO 2025-04-16 19:03:50,688 basehttp 27444 12352 "GET /search-songs/?q=t HTTP/1.1" 200 1764
INFO 2025-04-16 19:03:50,863 basehttp 27444 10952 "GET /search-songs/?q=to HTTP/1.1" 200 2056
INFO 2025-04-16 19:03:51,156 basehttp 27444 6616 "GET /search-songs/?q=tol HTTP/1.1" 200 1725
INFO 2025-04-16 19:03:51,300 basehttp 27444 12416 "GET /popularity/ HTTP/1.1" 200 9714
WARNING 2025-04-16 19:03:52,541 log 27444 12416 Not Found: /log-interaction/
WARNING 2025-04-16 19:03:52,543 basehttp 27444 12416 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-16 19:03:52,886 log 27444 6616 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:03:52,893 basehttp 27444 6616 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-16 19:03:52,897 log 27444 6616 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:03:52,897 basehttp 27444 6616 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:03:53,119 basehttp 27444 12352 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:03:53,328 basehttp 27444 12352 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:03:53,735 basehttp 27444 12416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:03:54,099 basehttp 27444 10952 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-16 19:03:54,101 log 27444 25364 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-16 19:03:54,122 basehttp 27444 25364 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
ERROR 2025-04-16 19:03:54,316 log 27444 28044 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/view/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 1031, in view_song
    Action.objects.create(user=user, song=song, action_type='view')
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, view) already exists.
ERROR 2025-04-16 19:03:54,327 basehttp 27444 28044 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 500 145
INFO 2025-04-16 19:03:54,541 basehttp 27444 12416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:03:55,133 basehttp 27444 6200 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:03:55,299 basehttp 27444 10952 "GET /playlists/ HTTP/1.1" 200 370
ERROR 2025-04-16 19:03:56,450 log 27444 28044 Internal Server Error: /songs/1hKFMb7L1GCGQgOApDIUAp/play/
Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\utils\decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\rest_framework\decorators.py", line 50, in handler
    return func(*args, **kwargs)
  File "C:\projects\music\server\songs\app\views.py", line 970, in play_song
    Action.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~^
        user=user,
        ^^^^^^^^^^
    ...<3 lines>...
        context=data.get('context')  # e.g., 'playlist', 'search_results', 'recommendation'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\mitak\AppData\Roaming\Python\Python313\site-packages\psycopg\cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: duplicate key value violates unique constraint "unique_non_search_action"
DETAIL:  Key (user_id, song_id, action_type)=(4, 163, play) already exists.
ERROR 2025-04-16 19:03:56,462 basehttp 27444 28044 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 500 145
INFO 2025-04-16 19:03:57,364 basehttp 27444 6200 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:04:54,495 basehttp 27444 15020 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:05:54,485 basehttp 27444 15420 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:06:56,097 basehttp 27444 12984 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:07:55,882 basehttp 27444 12984 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:09:45,852 basehttp 27444 12984 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:10:26,625 autoreload 27444 11368 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-16 19:10:28,020 autoreload 19824 22244 Watching for file changes with StatReloader
INFO 2025-04-16 19:10:45,977 basehttp 19824 10016 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:16,478 autoreload 19824 22244 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-16 19:11:17,585 autoreload 8808 1976 Watching for file changes with StatReloader
WARNING 2025-04-16 19:11:23,550 log 8808 27164 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:11:23,553 basehttp 8808 27164 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:11:23,685 basehttp 8808 8356 - Broken pipe from ('127.0.0.1', 61455)
INFO 2025-04-16 19:11:24,095 basehttp 8808 4424 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:11:24,413 basehttp 8808 8416 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:24,725 basehttp 8808 15496 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:11:25,014 basehttp 8808 22696 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
INFO 2025-04-16 19:11:25,021 basehttp 8808 15496 "OPTIONS /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 200 0
WARNING 2025-04-16 19:11:25,031 log 8808 22696 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:11:25,032 basehttp 8808 22696 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:11:25,758 basehttp 8808 20348 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:11:26,544 basehttp 8808 22696 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-16 19:11:44,241 basehttp 8808 22696 "POST /login/ HTTP/1.1" 200 538
INFO 2025-04-16 19:11:45,323 basehttp 8808 15496 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:45,404 basehttp 8808 27164 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:11:45,701 basehttp 8808 4424 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:11:45,718 basehttp 8808 8416 "GET /popularity/ HTTP/1.1" 200 6797
INFO 2025-04-16 19:11:46,144 basehttp 8808 15496 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:46,272 basehttp 8808 27164 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:11:46,874 basehttp 8808 4424 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:11:46,991 basehttp 8808 1280 "GET /popularity/ HTTP/1.1" 200 13849
INFO 2025-04-16 19:11:48,197 basehttp 8808 1280 "GET /search-songs/?q=t HTTP/1.1" 200 1764
INFO 2025-04-16 19:11:48,559 basehttp 8808 4424 "GET /popularity/ HTTP/1.1" 200 13420
INFO 2025-04-16 19:11:48,662 basehttp 8808 27164 "GET /search-songs/?q=to HTTP/1.1" 200 2056
INFO 2025-04-16 19:11:48,806 basehttp 8808 15496 "GET /search-songs/?q=tol HTTP/1.1" 200 1725
INFO 2025-04-16 19:11:49,886 basehttp 8808 1280 "GET /popularity/ HTTP/1.1" 200 6918
WARNING 2025-04-16 19:11:50,126 log 8808 1280 Not Found: /log-interaction/
WARNING 2025-04-16 19:11:50,128 basehttp 8808 1280 "POST /log-interaction/ HTTP/1.1" 404 179
WARNING 2025-04-16 19:11:50,364 log 8808 15496 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:11:50,369 basehttp 8808 15496 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-16 19:11:50,383 log 8808 15496 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:11:50,386 basehttp 8808 15496 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:11:50,594 basehttp 8808 4424 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:11:50,830 basehttp 8808 4424 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:11:51,186 basehttp 8808 1280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:51,425 basehttp 8808 20348 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:11:51,434 log 8808 20348 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:11:51,435 basehttp 8808 20348 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:11:51,560 basehttp 8808 27164 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:11:51,646 basehttp 8808 21060 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:11:51,652 log 8808 21060 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:11:51,653 basehttp 8808 21060 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:11:51,999 basehttp 8808 1280 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:11:52,513 basehttp 8808 22696 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:11:52,620 basehttp 8808 27164 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:11:53,042 basehttp 8808 21060 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-16 19:11:54,631 basehttp 8808 22696 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:12:52,126 basehttp 8808 27164 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:13:52,131 basehttp 8808 5124 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:14:53,055 basehttp 8808 5124 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:15:51,632 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:16:52,346 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:18:45,711 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:19:45,628 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:20:46,004 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:21:46,058 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:22:46,041 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:22:52,818 basehttp 8808 21600 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:23:52,485 basehttp 8808 18628 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-16 19:23:57,890 log 8808 26384 Method Not Allowed: /songs/1hKFMb7L1GCGQgOApDIUAp/play/
WARNING 2025-04-16 19:23:57,891 basehttp 8808 26384 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 405 40
INFO 2025-04-16 19:24:07,224 basehttp 8808 26384 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-16 19:24:52,672 basehttp 8808 20548 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:26:46,065 basehttp 8808 25716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:27:46,580 basehttp 8808 25716 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:30:26,486 basehttp 8808 11672 "GET /notifications/ HTTP/1.1" 200 21
WARNING 2025-04-16 19:31:17,371 log 8808 24192 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:31:17,372 basehttp 8808 24192 "GET //songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:31:46,881 basehttp 8808 12412 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:32:40,847 basehttp 8808 100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:32:42,693 basehttp 8808 100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:32:42,854 basehttp 8808 12008 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:32:43,108 basehttp 8808 16392 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:32:43,445 basehttp 8808 28600 "GET /popularity/ HTTP/1.1" 200 13916
INFO 2025-04-16 19:32:43,542 basehttp 8808 100 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:32:43,759 basehttp 8808 12008 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:32:44,249 basehttp 8808 16392 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:32:44,782 basehttp 8808 28600 "GET /popularity/ HTTP/1.1" 200 13794
INFO 2025-04-16 19:32:46,218 basehttp 8808 16392 "GET /popularity/ HTTP/1.1" 200 13796
INFO 2025-04-16 19:32:47,768 basehttp 8808 16392 "GET /popularity/ HTTP/1.1" 200 6818
INFO 2025-04-16 19:33:44,059 basehttp 8808 23668 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:34:43,874 basehttp 8808 23668 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:35:07,420 autoreload 8808 1976 C:\projects\music\server\songs\app\views.py changed, reloading.
INFO 2025-04-16 19:35:09,763 autoreload 17360 21788 Watching for file changes with StatReloader
INFO 2025-04-16 19:35:43,411 autoreload 17360 21788 C:\projects\music\server\songs\app\urls.py changed, reloading.
INFO 2025-04-16 19:35:44,645 autoreload 22028 6612 Watching for file changes with StatReloader
INFO 2025-04-16 19:36:12,956 basehttp 22028 22624 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:36:13,085 basehttp 22028 7900 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:36:13,311 basehttp 22028 23364 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:36:13,838 basehttp 22028 15824 "GET /popularity/ HTTP/1.1" 200 8535
INFO 2025-04-16 19:36:15,122 basehttp 22028 23364 "GET /popularity/ HTTP/1.1" 200 13745
INFO 2025-04-16 19:36:17,254 basehttp 22028 23364 "GET /search-songs/?q=t HTTP/1.1" 200 1764
INFO 2025-04-16 19:36:17,556 basehttp 22028 15824 "GET /search-songs/?q=to HTTP/1.1" 200 2056
INFO 2025-04-16 19:36:17,712 basehttp 22028 7900 "GET /search-songs/?q=tol HTTP/1.1" 200 1725
WARNING 2025-04-16 19:36:19,038 log 22028 7900 Unauthorized: /log-interaction/
WARNING 2025-04-16 19:36:19,040 basehttp 22028 7900 "POST /log-interaction/ HTTP/1.1" 401 58
WARNING 2025-04-16 19:36:19,309 log 22028 23364 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:36:19,315 basehttp 22028 23364 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-16 19:36:19,318 log 22028 23364 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:36:19,319 basehttp 22028 23364 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:36:19,547 basehttp 22028 22624 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:36:19,774 basehttp 22028 22624 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:36:20,076 basehttp 22028 7900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:36:20,440 basehttp 22028 1756 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:36:20,448 log 22028 1756 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:36:20,454 basehttp 22028 1756 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:36:20,505 basehttp 22028 15824 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:36:20,703 basehttp 22028 21480 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:36:20,707 log 22028 21480 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:36:20,707 basehttp 22028 21480 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:36:20,875 basehttp 22028 7900 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:36:21,411 basehttp 22028 16040 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:36:21,612 basehttp 22028 15824 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:36:22,379 basehttp 22028 21480 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-16 19:36:23,624 basehttp 22028 16040 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:36:46,027 basehttp 22028 15824 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:36:46,337 basehttp 22028 23364 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:36:46,775 basehttp 22028 22624 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:36:46,823 basehttp 22028 7900 "GET /popularity/ HTTP/1.1" 200 13489
INFO 2025-04-16 19:36:47,262 basehttp 22028 15824 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:36:47,417 basehttp 22028 23364 "GET /api/recommendations/trending/ HTTP/1.1" 200 6252
INFO 2025-04-16 19:36:47,951 basehttp 22028 22624 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:36:48,247 basehttp 22028 5928 "GET /popularity/ HTTP/1.1" 200 9685
INFO 2025-04-16 19:36:49,493 basehttp 22028 5928 "GET /popularity/ HTTP/1.1" 200 6268
INFO 2025-04-16 19:36:50,900 basehttp 22028 5928 "GET /popularity/ HTTP/1.1" 200 8741
INFO 2025-04-16 19:37:11,194 basehttp 22028 7900 "OPTIONS /search-songs/?q=tolai HTTP/1.1" 200 0
INFO 2025-04-16 19:37:12,855 basehttp 22028 5928 "GET /search-songs/?q=t HTTP/1.1" 200 1764
INFO 2025-04-16 19:37:12,923 basehttp 22028 22624 "GET /search-songs/?q=to HTTP/1.1" 200 2056
INFO 2025-04-16 19:37:12,958 basehttp 22028 23364 "GET /search-songs/?q=tol HTTP/1.1" 200 1725
INFO 2025-04-16 19:37:13,039 basehttp 22028 7900 "GET /search-songs/?q=tolai HTTP/1.1" 200 2480
INFO 2025-04-16 19:37:13,089 basehttp 22028 15824 "GET /search-songs/?q=tola HTTP/1.1" 200 2483
WARNING 2025-04-16 19:37:13,944 log 22028 15824 Unauthorized: /log-interaction/
WARNING 2025-04-16 19:37:13,945 basehttp 22028 15824 "POST /log-interaction/ HTTP/1.1" 401 58
WARNING 2025-04-16 19:37:14,168 log 22028 7900 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:37:14,177 basehttp 22028 7900 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
WARNING 2025-04-16 19:37:14,179 log 22028 7900 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/comments
WARNING 2025-04-16 19:37:14,180 basehttp 22028 7900 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/comments HTTP/1.1" 404 179
INFO 2025-04-16 19:37:14,387 basehttp 22028 22624 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:37:14,616 basehttp 22028 22624 "GET /song/1hKFMb7L1GCGQgOApDIUAp/ HTTP/1.1" 200 347
INFO 2025-04-16 19:37:14,941 basehttp 22028 15824 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:37:15,256 basehttp 22028 21480 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:37:15,264 log 22028 21480 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:37:15,265 basehttp 22028 21480 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:37:15,335 basehttp 22028 23364 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:37:15,527 basehttp 22028 1756 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/view/ HTTP/1.1" 200 54
WARNING 2025-04-16 19:37:15,533 log 22028 1756 Not Found: /songs/1hKFMb7L1GCGQgOApDIUAp/status/
WARNING 2025-04-16 19:37:15,534 basehttp 22028 1756 "GET /songs/1hKFMb7L1GCGQgOApDIUAp/status/ HTTP/1.1" 404 179
INFO 2025-04-16 19:37:15,723 basehttp 22028 15824 "GET /notifications/ HTTP/1.1" 200 21
INFO 2025-04-16 19:37:16,349 basehttp 22028 16040 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
INFO 2025-04-16 19:37:16,512 basehttp 22028 23364 "GET /playlists/ HTTP/1.1" 200 370
INFO 2025-04-16 19:37:16,760 basehttp 22028 1756 "POST /songs/1hKFMb7L1GCGQgOApDIUAp/play/ HTTP/1.1" 200 60
INFO 2025-04-16 19:37:18,416 basehttp 22028 16040 "GET /api/recommendations/similar/?spotify_id=1hKFMb7L1GCGQgOApDIUAp HTTP/1.1" 200 2878
